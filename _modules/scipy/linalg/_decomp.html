<!doctype html>
<html class="no-js" lang="en" data-content_root="../../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><link rel="index" title="Index" href="../../../genindex.html" /><link rel="search" title="Search" href="../../../search.html" />
        <link rel="prefetch" href="../../../_static/logo.png" as="image" />

    <!-- Generated with Sphinx 8.1.3 and Furo 2025.07.19 -->
        <title>scipy.linalg._decomp - EGTtools &#34;0.1.14.2&#34; documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?v=25af2a20" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?v=8dab3a3b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/readthedocs-custom.css?v=07c3a6e0" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #2b2b2b;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #2b2b2b;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">EGTtools "0.1.14.2" documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../index.html">
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../../../_static/logo.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">EGTtools "0.1.14.2" documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">Home page</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../tutorials.html">Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorials/create_new_python_game.html">Create a new game in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorials/create_cpp_game.html">Create a new game in C++ and bind it to Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorials/create_new_behaviors.html">Create new strategies/behaviors for existing games</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorials/analytical_methods.html">Use analytical methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorials/numerical_methods.html">Use numerical methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorials/plotting.html">Visualize results</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tutorials/references.html">References</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../examples.html">Examples</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Examples</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/hawk_dove_dynamics.html">Hawk and dove dynamics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/hawk_dove_dynamics_pairwise_comparison.html">Hawk and dove dynamics with new PairwiseComparison class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/normal_form_game_mc_simulations.html">Monte Carlo simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/plot_invasion_diagram.html">Fixation probabilities and Invasion diagram</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/plot_invasion_diagram.html#Instantiate-the-Normal-Form-Game">Instantiate the Normal Form Game</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/plot_simplex.html">2D Simplex plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/plot_simplex_simplified.html">2D Simplex plot simplified</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/examples_of_use.html">General examples</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../_autosummary/egttools.html">API reference</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of API reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../_autosummary/egttools.calculate_nb_states.html">egttools.calculate_nb_states</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../_autosummary/egttools.calculate_state.html">egttools.calculate_state</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../_autosummary/egttools.calculate_strategies_distribution.html">egttools.calculate_strategies_distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../_autosummary/egttools.files.html">egttools.files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../_autosummary/egttools.is_blas_lapack_enabled.html">egttools.is_blas_lapack_enabled</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../_autosummary/egttools.is_openmp_enabled.html">egttools.is_openmp_enabled</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../_autosummary/egttools.sample_simplex.html">egttools.sample_simplex</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../_autosummary/egttools.sample_unit_simplex.html">egttools.sample_unit_simplex</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../_autosummary/egttools.show_build_info.html">egttools.show_build_info</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../_autosummary/egttools.analytical.html">egttools.analytical</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of egttools.analytical</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.analytical.replicator_equation.html">egttools.analytical.replicator_equation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.analytical.replicator_equation_n_player.html">egttools.analytical.replicator_equation_n_player</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.analytical.PairwiseComparison.html">egttools.analytical.PairwiseComparison</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.analytical.StochDynamics.html">egttools.analytical.StochDynamics</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../_autosummary/egttools.analytical.sed_analytical.html">egttools.analytical.sed_analytical</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of egttools.analytical.sed_analytical</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.analytical.sed_analytical.calculate_nb_states.html">egttools.analytical.sed_analytical.calculate_nb_states</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.analytical.sed_analytical.calculate_state.html">egttools.analytical.sed_analytical.calculate_state</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.analytical.sed_analytical.eig.html">egttools.analytical.sed_analytical.eig</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.analytical.sed_analytical.replicator_equation.html">egttools.analytical.sed_analytical.replicator_equation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.analytical.sed_analytical.replicator_equation_n_player.html">egttools.analytical.sed_analytical.replicator_equation_n_player</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.analytical.sed_analytical.sample_simplex.html">egttools.analytical.sed_analytical.sample_simplex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.analytical.sed_analytical.warn.html">egttools.analytical.sed_analytical.warn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.analytical.sed_analytical.StochDynamics.html">egttools.analytical.sed_analytical.StochDynamics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.analytical.sed_analytical.csr_matrix.html">egttools.analytical.sed_analytical.csr_matrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.analytical.sed_analytical.lil_matrix.html">egttools.analytical.sed_analytical.lil_matrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.analytical.sed_analytical.permutations.html">egttools.analytical.sed_analytical.permutations</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../_autosummary/egttools.analytical.utils.html">egttools.analytical.utils</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of egttools.analytical.utils</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.analytical.utils.calculate_gradients.html">egttools.analytical.utils.calculate_gradients</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.analytical.utils.check_if_point_in_unit_simplex.html">egttools.analytical.utils.check_if_point_in_unit_simplex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.analytical.utils.check_if_there_is_random_drift.html">egttools.analytical.utils.check_if_there_is_random_drift</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.analytical.utils.check_replicator_stability_pairwise_games.html">egttools.analytical.utils.check_replicator_stability_pairwise_games</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.analytical.utils.eigvals.html">egttools.analytical.utils.eigvals</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.analytical.utils.find_roots.html">egttools.analytical.utils.find_roots</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.analytical.utils.find_roots_and_stability.html">egttools.analytical.utils.find_roots_and_stability</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.analytical.utils.get_pairwise_gradient_from_replicator.html">egttools.analytical.utils.get_pairwise_gradient_from_replicator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.analytical.utils.get_pairwise_gradient_from_replicator_n_player.html">egttools.analytical.utils.get_pairwise_gradient_from_replicator_n_player</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.analytical.utils.replicator_equation.html">egttools.analytical.utils.replicator_equation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.analytical.utils.replicator_equation_n_player.html">egttools.analytical.utils.replicator_equation_n_player</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.analytical.utils.root.html">egttools.analytical.utils.root</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.analytical.utils.sample_unit_simplex.html">egttools.analytical.utils.sample_unit_simplex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.analytical.utils.StochDynamics.html">egttools.analytical.utils.StochDynamics</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.html">egttools.behaviors</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of egttools.behaviors</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.CPR.html">egttools.behaviors.CPR</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of egttools.behaviors.CPR</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.CPR.abstract_cpr_strategy.html">egttools.behaviors.CPR.abstract_cpr_strategy</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of egttools.behaviors.CPR.abstract_cpr_strategy</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.CPR.abstract_cpr_strategy.abstractmethod.html">egttools.behaviors.CPR.abstract_cpr_strategy.abstractmethod</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.CPR.abstract_cpr_strategy.ABC.html">egttools.behaviors.CPR.abstract_cpr_strategy.ABC</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.CPR.abstract_cpr_strategy.AbstractCPRStrategy.html">egttools.behaviors.CPR.abstract_cpr_strategy.AbstractCPRStrategy</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.CPR.cpr_strategies.html">egttools.behaviors.CPR.cpr_strategies</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of egttools.behaviors.CPR.cpr_strategies</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.CPR.cpr_strategies.fair_extraction.html">egttools.behaviors.CPR.cpr_strategies.fair_extraction</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.CPR.cpr_strategies.high_extraction.html">egttools.behaviors.CPR.cpr_strategies.high_extraction</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.CPR.cpr_strategies.nash_extraction.html">egttools.behaviors.CPR.cpr_strategies.nash_extraction</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.CPR.cpr_strategies.payoff_no_commitment.html">egttools.behaviors.CPR.cpr_strategies.payoff_no_commitment</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.CPR.cpr_strategies.AbstractCPRStrategy.html">egttools.behaviors.CPR.cpr_strategies.AbstractCPRStrategy</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.CPR.cpr_strategies.CommitmentStrategy.html">egttools.behaviors.CPR.cpr_strategies.CommitmentStrategy</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.CPR.cpr_strategies.FairExtraction.html">egttools.behaviors.CPR.cpr_strategies.FairExtraction</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.CPR.cpr_strategies.FakeStrategy.html">egttools.behaviors.CPR.cpr_strategies.FakeStrategy</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.CPR.cpr_strategies.FixedExtraction.html">egttools.behaviors.CPR.cpr_strategies.FixedExtraction</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.CPR.cpr_strategies.FreeStrategy.html">egttools.behaviors.CPR.cpr_strategies.FreeStrategy</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.CPR.cpr_strategies.HighExtraction.html">egttools.behaviors.CPR.cpr_strategies.HighExtraction</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.CPR.cpr_strategies.NashExtraction.html">egttools.behaviors.CPR.cpr_strategies.NashExtraction</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.CRD.html">egttools.behaviors.CRD</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of egttools.behaviors.CRD</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.CRD.AbstractCRDStrategy.html">egttools.behaviors.CRD.AbstractCRDStrategy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.CRD.CRDMemoryOnePlayer.html">egttools.behaviors.CRD.CRDMemoryOnePlayer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.CRD.GoalBasedCRDStrategy.html">egttools.behaviors.CRD.GoalBasedCRDStrategy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.CRD.MovingAverageCRDStrategy.html">egttools.behaviors.CRD.MovingAverageCRDStrategy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.CRD.TimeBasedCRDStrategy.html">egttools.behaviors.CRD.TimeBasedCRDStrategy</a></li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.CRD.goal_based.html">egttools.behaviors.CRD.goal_based</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of egttools.behaviors.CRD.goal_based</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.CRD.goal_based.AbstractCRDStrategy.html">egttools.behaviors.CRD.goal_based.AbstractCRDStrategy</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.CRD.goal_based.GoalBasedCRDStrategy.html">egttools.behaviors.CRD.goal_based.GoalBasedCRDStrategy</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.CRD.moving_average.html">egttools.behaviors.CRD.moving_average</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of egttools.behaviors.CRD.moving_average</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.CRD.moving_average.AbstractCRDStrategy.html">egttools.behaviors.CRD.moving_average.AbstractCRDStrategy</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.CRD.moving_average.MovingAverageCRDStrategy.html">egttools.behaviors.CRD.moving_average.MovingAverageCRDStrategy</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.CRD.time_based.html">egttools.behaviors.CRD.time_based</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of egttools.behaviors.CRD.time_based</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.CRD.time_based.AbstractCRDStrategy.html">egttools.behaviors.CRD.time_based.AbstractCRDStrategy</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.CRD.time_based.TimeBasedCRDStrategy.html">egttools.behaviors.CRD.time_based.TimeBasedCRDStrategy</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.NormalForm.html">egttools.behaviors.NormalForm</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle navigation of egttools.behaviors.NormalForm</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.NormalForm.AbstractNFGStrategy.html">egttools.behaviors.NormalForm.AbstractNFGStrategy</a></li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.NormalForm.TwoActions.html">egttools.behaviors.NormalForm.TwoActions</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle navigation of egttools.behaviors.NormalForm.TwoActions</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.NormalForm.TwoActions.ActionInertia.html">egttools.behaviors.NormalForm.TwoActions.ActionInertia</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.NormalForm.TwoActions.Cooperator.html">egttools.behaviors.NormalForm.TwoActions.Cooperator</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.NormalForm.TwoActions.Defector.html">egttools.behaviors.NormalForm.TwoActions.Defector</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.NormalForm.TwoActions.Detective.html">egttools.behaviors.NormalForm.TwoActions.Detective</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.NormalForm.TwoActions.EpsilonGRIM.html">egttools.behaviors.NormalForm.TwoActions.EpsilonGRIM</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.NormalForm.TwoActions.EpsilonTFT.html">egttools.behaviors.NormalForm.TwoActions.EpsilonTFT</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.NormalForm.TwoActions.GRIM.html">egttools.behaviors.NormalForm.TwoActions.GRIM</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.NormalForm.TwoActions.GenerousTFT.html">egttools.behaviors.NormalForm.TwoActions.GenerousTFT</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.NormalForm.TwoActions.GradualTFT.html">egttools.behaviors.NormalForm.TwoActions.GradualTFT</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.NormalForm.TwoActions.ImperfectTFT.html">egttools.behaviors.NormalForm.TwoActions.ImperfectTFT</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.NormalForm.TwoActions.MemoryOneStrategy.html">egttools.behaviors.NormalForm.TwoActions.MemoryOneStrategy</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.NormalForm.TwoActions.Pavlov.html">egttools.behaviors.NormalForm.TwoActions.Pavlov</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.NormalForm.TwoActions.Random.html">egttools.behaviors.NormalForm.TwoActions.Random</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.NormalForm.TwoActions.SuspiciousTFT.html">egttools.behaviors.NormalForm.TwoActions.SuspiciousTFT</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.NormalForm.TwoActions.TFT.html">egttools.behaviors.NormalForm.TwoActions.TFT</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.NormalForm.TwoActions.TFTT.html">egttools.behaviors.NormalForm.TwoActions.TFTT</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.NormalForm.TwoActions.TTFT.html">egttools.behaviors.NormalForm.TwoActions.TTFT</a></li>
<li class="toctree-l5 has-children"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.NormalForm.TwoActions.nfg_strategies.html">egttools.behaviors.NormalForm.TwoActions.nfg_strategies</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle navigation of egttools.behaviors.NormalForm.TwoActions.nfg_strategies</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.NormalForm.TwoActions.nfg_strategies.AbstractNFGStrategy.html">egttools.behaviors.NormalForm.TwoActions.nfg_strategies.AbstractNFGStrategy</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.NormalForm.TwoActions.nfg_strategies.Detective.html">egttools.behaviors.NormalForm.TwoActions.nfg_strategies.Detective</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.NormalForm.TwoActions.nfg_strategies.EpsilonGRIM.html">egttools.behaviors.NormalForm.TwoActions.nfg_strategies.EpsilonGRIM</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.NormalForm.TwoActions.nfg_strategies.EpsilonTFT.html">egttools.behaviors.NormalForm.TwoActions.nfg_strategies.EpsilonTFT</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.NormalForm.TwoActions.nfg_strategies.MemoryOneStrategy.html">egttools.behaviors.NormalForm.TwoActions.nfg_strategies.MemoryOneStrategy</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.opinion_behaviors.html">egttools.behaviors.opinion_behaviors</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle navigation of egttools.behaviors.opinion_behaviors</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.opinion_behaviors.opinion_factory.html">egttools.behaviors.opinion_behaviors.opinion_factory</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.opinion_behaviors.Opinion.html">egttools.behaviors.opinion_behaviors.Opinion</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.pgg_behaviors.html">egttools.behaviors.pgg_behaviors</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle navigation of egttools.behaviors.pgg_behaviors</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.pgg_behaviors.player_factory.html">egttools.behaviors.pgg_behaviors.player_factory</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.behaviors.pgg_behaviors.PGGOneShotStrategy.html">egttools.behaviors.pgg_behaviors.PGGOneShotStrategy</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../_autosummary/egttools.datastructures.html">egttools.datastructures</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle navigation of egttools.datastructures</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.datastructures.DataTable.html">egttools.datastructures.DataTable</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../_autosummary/egttools.distributions.html">egttools.distributions</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><div class="visually-hidden">Toggle navigation of egttools.distributions</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.distributions.binom.html">egttools.distributions.binom</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.distributions.comb.html">egttools.distributions.comb</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.distributions.multinomial_pmf.html">egttools.distributions.multinomial_pmf</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.distributions.multivariate_hypergeometric_pdf.html">egttools.distributions.multivariate_hypergeometric_pdf</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.distributions.TimingUncertainty.html">egttools.distributions.TimingUncertainty</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../_autosummary/egttools.games.html">egttools.games</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" role="switch" type="checkbox"/><label for="toctree-checkbox-22"><div class="visually-hidden">Toggle navigation of egttools.games</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.games.AbstractGame.html">egttools.games.AbstractGame</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.games.AbstractNPlayerGame.html">egttools.games.AbstractNPlayerGame</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.games.AbstractSpatialGame.html">egttools.games.AbstractSpatialGame</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.games.AbstractTwoPLayerGame.html">egttools.games.AbstractTwoPLayerGame</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.games.CRDGame.html">egttools.games.CRDGame</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.games.CRDGameTU.html">egttools.games.CRDGameTU</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.games.CommonPoolResourceDilemma.html">egttools.games.CommonPoolResourceDilemma</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.games.CommonPoolResourceDilemmaCommitment.html">egttools.games.CommonPoolResourceDilemmaCommitment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.games.InformalRiskGame.html">egttools.games.InformalRiskGame</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.games.Matrix2PlayerGameHolder.html">egttools.games.Matrix2PlayerGameHolder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.games.MatrixNPlayerGameHolder.html">egttools.games.MatrixNPlayerGameHolder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.games.NPlayerStagHunt.html">egttools.games.NPlayerStagHunt</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.games.NormalFormGame.html">egttools.games.NormalFormGame</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.games.NormalFormNetworkGame.html">egttools.games.NormalFormNetworkGame</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.games.OneShotCRD.html">egttools.games.OneShotCRD</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.games.OneShotCRDNetworkGame.html">egttools.games.OneShotCRDNetworkGame</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.games.PGG.html">egttools.games.PGG</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../_autosummary/egttools.games.abstract_games.html">egttools.games.abstract_games</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" role="switch" type="checkbox"/><label for="toctree-checkbox-23"><div class="visually-hidden">Toggle navigation of egttools.games.abstract_games</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.games.abstract_games.abstractmethod.html">egttools.games.abstract_games.abstractmethod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.games.abstract_games.calculate_state.html">egttools.games.abstract_games.calculate_state</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.games.abstract_games.sample_simplex.html">egttools.games.abstract_games.sample_simplex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.games.abstract_games.AbstractGame.html">egttools.games.abstract_games.AbstractGame</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.games.abstract_games.AbstractNPlayerGame.html">egttools.games.abstract_games.AbstractNPlayerGame</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.games.abstract_games.AbstractNPlayerGameExpectedPayoff.html">egttools.games.abstract_games.AbstractNPlayerGameExpectedPayoff</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.games.abstract_games.AbstractTwoPLayerGame.html">egttools.games.abstract_games.AbstractTwoPLayerGame</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../_autosummary/egttools.games.informal_risk.html">egttools.games.informal_risk</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" role="switch" type="checkbox"/><label for="toctree-checkbox-24"><div class="visually-hidden">Toggle navigation of egttools.games.informal_risk</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.games.informal_risk.calculate_nb_states.html">egttools.games.informal_risk.calculate_nb_states</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.games.informal_risk.calculate_state.html">egttools.games.informal_risk.calculate_state</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.games.informal_risk.sample_simplex.html">egttools.games.informal_risk.sample_simplex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.games.informal_risk.AbstractGame.html">egttools.games.informal_risk.AbstractGame</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.games.informal_risk.InformalRiskGame.html">egttools.games.informal_risk.InformalRiskGame</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../_autosummary/egttools.games.nonlinear_games.html">egttools.games.nonlinear_games</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" role="switch" type="checkbox"/><label for="toctree-checkbox-25"><div class="visually-hidden">Toggle navigation of egttools.games.nonlinear_games</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.games.nonlinear_games.calculate_state.html">egttools.games.nonlinear_games.calculate_state</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.games.nonlinear_games.sample_simplex.html">egttools.games.nonlinear_games.sample_simplex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.games.nonlinear_games.AbstractCPRStrategy.html">egttools.games.nonlinear_games.AbstractCPRStrategy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.games.nonlinear_games.AbstractNPlayerGame.html">egttools.games.nonlinear_games.AbstractNPlayerGame</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.games.nonlinear_games.CommonPoolResourceDilemma.html">egttools.games.nonlinear_games.CommonPoolResourceDilemma</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.games.nonlinear_games.CommonPoolResourceDilemmaCommitment.html">egttools.games.nonlinear_games.CommonPoolResourceDilemmaCommitment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.games.nonlinear_games.NPlayerStagHunt.html">egttools.games.nonlinear_games.NPlayerStagHunt</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../_autosummary/egttools.games.opinion_game.html">egttools.games.opinion_game</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" role="switch" type="checkbox"/><label for="toctree-checkbox-26"><div class="visually-hidden">Toggle navigation of egttools.games.opinion_game</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.games.opinion_game.moment.html">egttools.games.opinion_game.moment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.games.opinion_game.sample_simplex.html">egttools.games.opinion_game.sample_simplex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.games.opinion_game.sigmoid.html">egttools.games.opinion_game.sigmoid</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.games.opinion_game.AbstractNPlayerGame.html">egttools.games.opinion_game.AbstractNPlayerGame</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.games.opinion_game.OpinionGame.html">egttools.games.opinion_game.OpinionGame</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../_autosummary/egttools.games.pgg.html">egttools.games.pgg</a><input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" role="switch" type="checkbox"/><label for="toctree-checkbox-27"><div class="visually-hidden">Toggle navigation of egttools.games.pgg</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.games.pgg.sample_simplex.html">egttools.games.pgg.sample_simplex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.games.pgg.AbstractNPlayerGame.html">egttools.games.pgg.AbstractNPlayerGame</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.games.pgg.PGG.html">egttools.games.pgg.PGG</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.games.pgg.PGGOneShotStrategy.html">egttools.games.pgg.PGGOneShotStrategy</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../_autosummary/egttools.helpers.html">egttools.helpers</a><input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" role="switch" type="checkbox"/><label for="toctree-checkbox-28"><div class="visually-hidden">Toggle navigation of egttools.helpers</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../_autosummary/egttools.helpers.vectorized.html">egttools.helpers.vectorized</a><input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" role="switch" type="checkbox"/><label for="toctree-checkbox-29"><div class="visually-hidden">Toggle navigation of egttools.helpers.vectorized</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.helpers.vectorized.barycentric_to_xy_coordinates.html">egttools.helpers.vectorized.barycentric_to_xy_coordinates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.helpers.vectorized.cpp_vectorized_replicator_equation_n_player.html">egttools.helpers.vectorized.cpp_vectorized_replicator_equation_n_player</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.helpers.vectorized.replicator_equation_n_player.html">egttools.helpers.vectorized.replicator_equation_n_player</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.helpers.vectorized.vectorized_barycentric_to_xy_coordinates.html">egttools.helpers.vectorized.vectorized_barycentric_to_xy_coordinates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.helpers.vectorized.vectorized_replicator_equation.html">egttools.helpers.vectorized.vectorized_replicator_equation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.helpers.vectorized.vectorized_replicator_equation_n_player.html">egttools.helpers.vectorized.vectorized_replicator_equation_n_player</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../_autosummary/egttools.numerical.html">egttools.numerical</a><input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" role="switch" type="checkbox"/><label for="toctree-checkbox-30"><div class="visually-hidden">Toggle navigation of egttools.numerical</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.numerical.GeneralPopulationEvolver.html">egttools.numerical.GeneralPopulationEvolver</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.numerical.NetworkEvolver.html">egttools.numerical.NetworkEvolver</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.numerical.PairwiseComparisonNumerical.html">egttools.numerical.PairwiseComparisonNumerical</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../_autosummary/egttools.numerical.numerical_.html">egttools.numerical.numerical_</a><input class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" role="switch" type="checkbox"/><label for="toctree-checkbox-31"><div class="visually-hidden">Toggle navigation of egttools.numerical.numerical_</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.numerical.numerical_.calculate_nb_states.html">egttools.numerical.numerical_.calculate_nb_states</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.numerical.numerical_.calculate_state.html">egttools.numerical.numerical_.calculate_state</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.numerical.numerical_.calculate_strategies_distribution.html">egttools.numerical.numerical_.calculate_strategies_distribution</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.numerical.numerical_.is_blas_lapack_enabled.html">egttools.numerical.numerical_.is_blas_lapack_enabled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.numerical.numerical_.is_openmp_enabled.html">egttools.numerical.numerical_.is_openmp_enabled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.numerical.numerical_.replicator_equation.html">egttools.numerical.numerical_.replicator_equation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.numerical.numerical_.replicator_equation_n_player.html">egttools.numerical.numerical_.replicator_equation_n_player</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.numerical.numerical_.sample_simplex.html">egttools.numerical.numerical_.sample_simplex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.numerical.numerical_.sample_simplex_directly.html">egttools.numerical.numerical_.sample_simplex_directly</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.numerical.numerical_.sample_unit_simplex.html">egttools.numerical.numerical_.sample_unit_simplex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.numerical.numerical_.vectorized_replicator_equation_n_player.html">egttools.numerical.numerical_.vectorized_replicator_equation_n_player</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.numerical.numerical_.GeneralPopulationEvolver.html">egttools.numerical.numerical_.GeneralPopulationEvolver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.numerical.numerical_.NetworkEvolver.html">egttools.numerical.numerical_.NetworkEvolver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.numerical.numerical_.PairwiseComparison.html">egttools.numerical.numerical_.PairwiseComparison</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.numerical.numerical_.PairwiseComparisonNumerical.html">egttools.numerical.numerical_.PairwiseComparisonNumerical</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../_autosummary/egttools.numerical.structure.html">egttools.numerical.structure</a><input class="toctree-checkbox" id="toctree-checkbox-32" name="toctree-checkbox-32" role="switch" type="checkbox"/><label for="toctree-checkbox-32"><div class="visually-hidden">Toggle navigation of egttools.numerical.structure</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.numerical.structure.AbstractStructure.html">egttools.numerical.structure.AbstractStructure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.numerical.structure.Network.html">egttools.numerical.structure.Network</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.numerical.structure.NetworkGroup.html">egttools.numerical.structure.NetworkGroup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.numerical.structure.NetworkGroupSync.html">egttools.numerical.structure.NetworkGroupSync</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.numerical.structure.NetworkSync.html">egttools.numerical.structure.NetworkSync</a></li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../../_autosummary/egttools.numerical.structure.factories.html">egttools.numerical.structure.factories</a><input class="toctree-checkbox" id="toctree-checkbox-33" name="toctree-checkbox-33" role="switch" type="checkbox"/><label for="toctree-checkbox-33"><div class="visually-hidden">Toggle navigation of egttools.numerical.structure.factories</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../_autosummary/egttools.numerical.structure.factories.network_factory.html">egttools.numerical.structure.factories.network_factory</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../_autosummary/egttools.numerical.structure.factories.network_group_factory.html">egttools.numerical.structure.factories.network_group_factory</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../_autosummary/egttools.numerical.structure.factories.network_group_sync_factory.html">egttools.numerical.structure.factories.network_group_sync_factory</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../_autosummary/egttools.numerical.structure.factories.network_sync_factory.html">egttools.numerical.structure.factories.network_sync_factory</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../_autosummary/egttools.numerical.structure.factories.AbstractSpatialGame.html">egttools.numerical.structure.factories.AbstractSpatialGame</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../_autosummary/egttools.numerical.structure.factories.Network.html">egttools.numerical.structure.factories.Network</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../_autosummary/egttools.numerical.structure.factories.NetworkGroup.html">egttools.numerical.structure.factories.NetworkGroup</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../_autosummary/egttools.numerical.structure.factories.NetworkGroupSync.html">egttools.numerical.structure.factories.NetworkGroupSync</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../_autosummary/egttools.numerical.structure.factories.NetworkSync.html">egttools.numerical.structure.factories.NetworkSync</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../_autosummary/egttools.plotting.html">egttools.plotting</a><input class="toctree-checkbox" id="toctree-checkbox-34" name="toctree-checkbox-34" role="switch" type="checkbox"/><label for="toctree-checkbox-34"><div class="visually-hidden">Toggle navigation of egttools.plotting</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.plotting.draw_invasion_diagram.html">egttools.plotting.draw_invasion_diagram</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.plotting.plot_gradient.html">egttools.plotting.plot_gradient</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.plotting.plot_gradients.html">egttools.plotting.plot_gradients</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.plotting.plot_pairwise_comparison_rule_dynamics_in_simplex.html">egttools.plotting.plot_pairwise_comparison_rule_dynamics_in_simplex</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.plotting.plot_pairwise_comparison_rule_dynamics_in_simplex_without_roots.html">egttools.plotting.plot_pairwise_comparison_rule_dynamics_in_simplex_without_roots</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.plotting.plot_replicator_dynamics_in_simplex.html">egttools.plotting.plot_replicator_dynamics_in_simplex</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.plotting.Simplex2D.html">egttools.plotting.Simplex2D</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../_autosummary/egttools.plotting.helpers.html">egttools.plotting.helpers</a><input class="toctree-checkbox" id="toctree-checkbox-35" name="toctree-checkbox-35" role="switch" type="checkbox"/><label for="toctree-checkbox-35"><div class="visually-hidden">Toggle navigation of egttools.plotting.helpers</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.helpers.add_arrow.html">egttools.plotting.helpers.add_arrow</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.helpers.barycentric_to_xy_coordinates.html">egttools.plotting.helpers.barycentric_to_xy_coordinates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.helpers.calculate_nb_states.html">egttools.plotting.helpers.calculate_nb_states</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.helpers.calculate_stability.html">egttools.plotting.helpers.calculate_stability</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.helpers.calculate_stationary_points.html">egttools.plotting.helpers.calculate_stationary_points</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.helpers.check_if_point_in_unit_simplex.html">egttools.plotting.helpers.check_if_point_in_unit_simplex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.helpers.find_roots_in_discrete_barycentric_coordinates.html">egttools.plotting.helpers.find_roots_in_discrete_barycentric_coordinates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.helpers.find_where_point_is_in_simplex.html">egttools.plotting.helpers.find_where_point_is_in_simplex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.helpers.perturb_state.html">egttools.plotting.helpers.perturb_state</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.helpers.perturb_state_discrete.html">egttools.plotting.helpers.perturb_state_discrete</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.helpers.root.html">egttools.plotting.helpers.root</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.helpers.sample_simplex.html">egttools.plotting.helpers.sample_simplex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.helpers.simplex_iterator.html">egttools.plotting.helpers.simplex_iterator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.helpers.xy_to_barycentric_coordinates.html">egttools.plotting.helpers.xy_to_barycentric_coordinates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.helpers.NDArray.html">egttools.plotting.helpers.NDArray</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../_autosummary/egttools.plotting.indicators.html">egttools.plotting.indicators</a><input class="toctree-checkbox" id="toctree-checkbox-36" name="toctree-checkbox-36" role="switch" type="checkbox"/><label for="toctree-checkbox-36"><div class="visually-hidden">Toggle navigation of egttools.plotting.indicators</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.indicators.draw_invasion_diagram.html">egttools.plotting.indicators.draw_invasion_diagram</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.indicators.plot_gradient.html">egttools.plotting.indicators.plot_gradient</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.indicators.plot_gradients.html">egttools.plotting.indicators.plot_gradients</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.indicators.AutoMinorLocator.html">egttools.plotting.indicators.AutoMinorLocator</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../_autosummary/egttools.plotting.simplex2d.html">egttools.plotting.simplex2d</a><input class="toctree-checkbox" id="toctree-checkbox-37" name="toctree-checkbox-37" role="switch" type="checkbox"/><label for="toctree-checkbox-37"><div class="visually-hidden">Toggle navigation of egttools.plotting.simplex2d</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.simplex2d.add_arrow.html">egttools.plotting.simplex2d.add_arrow</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.simplex2d.barycentric_to_xy_coordinates.html">egttools.plotting.simplex2d.barycentric_to_xy_coordinates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.simplex2d.calculate_nb_states.html">egttools.plotting.simplex2d.calculate_nb_states</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.simplex2d.find_where_point_is_in_simplex.html">egttools.plotting.simplex2d.find_where_point_is_in_simplex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.simplex2d.odeint.html">egttools.plotting.simplex2d.odeint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.simplex2d.perturb_state.html">egttools.plotting.simplex2d.perturb_state</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.simplex2d.perturb_state_discrete.html">egttools.plotting.simplex2d.perturb_state_discrete</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.simplex2d.sample_simplex.html">egttools.plotting.simplex2d.sample_simplex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.simplex2d.sample_unit_simplex.html">egttools.plotting.simplex2d.sample_unit_simplex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.simplex2d.xy_to_barycentric_coordinates.html">egttools.plotting.simplex2d.xy_to_barycentric_coordinates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.simplex2d.Circle.html">egttools.plotting.simplex2d.Circle</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.simplex2d.Simplex2D.html">egttools.plotting.simplex2d.Simplex2D</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.simplex2d.TypeVar.html">egttools.plotting.simplex2d.TypeVar</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../_autosummary/egttools.plotting.simplified.html">egttools.plotting.simplified</a><input class="toctree-checkbox" id="toctree-checkbox-38" name="toctree-checkbox-38" role="switch" type="checkbox"/><label for="toctree-checkbox-38"><div class="visually-hidden">Toggle navigation of egttools.plotting.simplified</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.simplified.barycentric_to_xy_coordinates.html">egttools.plotting.simplified.barycentric_to_xy_coordinates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.simplified.calculate_nb_states.html">egttools.plotting.simplified.calculate_nb_states</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.simplified.calculate_stability.html">egttools.plotting.simplified.calculate_stability</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.simplified.check_if_there_is_random_drift.html">egttools.plotting.simplified.check_if_there_is_random_drift</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.simplified.check_replicator_stability_pairwise_games.html">egttools.plotting.simplified.check_replicator_stability_pairwise_games</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.simplified.find_roots.html">egttools.plotting.simplified.find_roots</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.simplified.find_roots_in_discrete_barycentric_coordinates.html">egttools.plotting.simplified.find_roots_in_discrete_barycentric_coordinates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.simplified.plot_pairwise_comparison_rule_dynamics_in_simplex.html">egttools.plotting.simplified.plot_pairwise_comparison_rule_dynamics_in_simplex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.simplified.plot_pairwise_comparison_rule_dynamics_in_simplex_without_roots.html">egttools.plotting.simplified.plot_pairwise_comparison_rule_dynamics_in_simplex_without_roots</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.simplified.plot_replicator_dynamics_in_simplex.html">egttools.plotting.simplified.plot_replicator_dynamics_in_simplex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.simplified.replicator_equation.html">egttools.plotting.simplified.replicator_equation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.simplified.replicator_equation_n_player.html">egttools.plotting.simplified.replicator_equation_n_player</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.simplified.vectorized_barycentric_to_xy_coordinates.html">egttools.plotting.simplified.vectorized_barycentric_to_xy_coordinates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.simplified.vectorized_replicator_equation.html">egttools.plotting.simplified.vectorized_replicator_equation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.simplified.vectorized_replicator_equation_n_player.html">egttools.plotting.simplified.vectorized_replicator_equation_n_player</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.simplified.xy_to_barycentric_coordinates.html">egttools.plotting.simplified.xy_to_barycentric_coordinates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.simplified.AbstractGame.html">egttools.plotting.simplified.AbstractGame</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.simplified.Matrix2PlayerGameHolder.html">egttools.plotting.simplified.Matrix2PlayerGameHolder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.simplified.MatrixNPlayerGameHolder.html">egttools.plotting.simplified.MatrixNPlayerGameHolder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.simplified.NDArray.html">egttools.plotting.simplified.NDArray</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.simplified.PairwiseComparison.html">egttools.plotting.simplified.PairwiseComparison</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../_autosummary/egttools.plotting.simplified.Simplex2D.html">egttools.plotting.simplified.Simplex2D</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../_autosummary/egttools.utils.html">egttools.utils</a><input class="toctree-checkbox" id="toctree-checkbox-39" name="toctree-checkbox-39" role="switch" type="checkbox"/><label for="toctree-checkbox-39"><div class="visually-hidden">Toggle navigation of egttools.utils</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.utils.calculate_nb_unique_combinations.html">egttools.utils.calculate_nb_unique_combinations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.utils.calculate_stationary_distribution.html">egttools.utils.calculate_stationary_distribution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.utils.calculate_stationary_distribution_non_hermitian.html">egttools.utils.calculate_stationary_distribution_non_hermitian</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.utils.combine.html">egttools.utils.combine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.utils.eigvals.html">egttools.utils.eigvals</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.utils.find_saddle_type_and_gradient_direction.html">egttools.utils.find_saddle_type_and_gradient_direction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.utils.get_payoff_function.html">egttools.utils.get_payoff_function</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.utils.schur.html">egttools.utils.schur</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.utils.transform_graph_to_dict_of_lists.html">egttools.utils.transform_graph_to_dict_of_lists</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.utils.transform_payoffs_to_pairwise.html">egttools.utils.transform_payoffs_to_pairwise</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.utils.warn.html">egttools.utils.warn</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.utils.AbstractGame.html">egttools.utils.AbstractGame</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.utils.Graph.html">egttools.utils.Graph</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.utils.csc_matrix.html">egttools.utils.csc_matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../_autosummary/egttools.utils.csr_matrix.html">egttools.utils.csr_matrix</a></li>
</ul>
</li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <h1>Source code for scipy.linalg._decomp</h1><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Author: Pearu Peterson, March 2002</span>
<span class="c1">#</span>
<span class="c1"># additions by Travis Oliphant, March 2002</span>
<span class="c1"># additions by Eric Jones,      June 2002</span>
<span class="c1"># additions by Johannes Loehnert, June 2006</span>
<span class="c1"># additions by Bart Vandereycken, June 2006</span>
<span class="c1"># additions by Andrew D Straw, May 2007</span>
<span class="c1"># additions by Tiziano Zito, November 2008</span>
<span class="c1">#</span>
<span class="c1"># April 2010: Functions for LU, QR, SVD, Schur, and Cholesky decompositions</span>
<span class="c1"># were moved to their own files. Still in this file are functions for</span>
<span class="c1"># eigenstuff and for the Hessenberg form.</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;eig&#39;</span><span class="p">,</span> <span class="s1">&#39;eigvals&#39;</span><span class="p">,</span> <span class="s1">&#39;eigh&#39;</span><span class="p">,</span> <span class="s1">&#39;eigvalsh&#39;</span><span class="p">,</span>
           <span class="s1">&#39;eig_banded&#39;</span><span class="p">,</span> <span class="s1">&#39;eigvals_banded&#39;</span><span class="p">,</span>
           <span class="s1">&#39;eigh_tridiagonal&#39;</span><span class="p">,</span> <span class="s1">&#39;eigvalsh_tridiagonal&#39;</span><span class="p">,</span> <span class="s1">&#39;hessenberg&#39;</span><span class="p">,</span> <span class="s1">&#39;cdf2rdf&#39;</span><span class="p">]</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">isfinite</span><span class="p">,</span> <span class="n">inexact</span><span class="p">,</span> <span class="n">nonzero</span><span class="p">,</span> <span class="n">iscomplexobj</span><span class="p">,</span>
                   <span class="n">flatnonzero</span><span class="p">,</span> <span class="n">conj</span><span class="p">,</span> <span class="n">asarray</span><span class="p">,</span> <span class="n">argsort</span><span class="p">,</span> <span class="n">empty</span><span class="p">,</span>
                   <span class="n">iscomplex</span><span class="p">,</span> <span class="n">zeros</span><span class="p">,</span> <span class="n">einsum</span><span class="p">,</span> <span class="n">eye</span><span class="p">,</span> <span class="n">inf</span><span class="p">)</span>
<span class="c1"># Local imports</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy._lib._util</span><span class="w"> </span><span class="kn">import</span> <span class="n">_asarray_validated</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">._misc</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinAlgError</span><span class="p">,</span> <span class="n">_datacopied</span><span class="p">,</span> <span class="n">norm</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.lapack</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_lapack_funcs</span><span class="p">,</span> <span class="n">_compute_lwork</span>


<span class="n">_I</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;F&#39;</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_make_complex_eigvecs</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">vin</span><span class="p">,</span> <span class="n">dtype</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Produce complex-valued eigenvectors from LAPACK DGGEV real-valued output</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># - see LAPACK man page DGGEV at ALPHAI</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vin</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
    <span class="n">m</span> <span class="o">=</span> <span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">imag</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">m</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">|=</span> <span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">imag</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># workaround for LAPACK bug, cf. ticket #709</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">flatnonzero</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
        <span class="n">v</span><span class="o">.</span><span class="n">imag</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">vin</span><span class="p">[:,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">conj</span><span class="p">(</span><span class="n">v</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">v</span><span class="p">[:,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">v</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_make_eigvals</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">homogeneous_eigvals</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">homogeneous_eigvals</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">beta</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">alpha</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">alpha</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">beta</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">alpha</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
            <span class="n">alpha_zero</span> <span class="o">=</span> <span class="p">(</span><span class="n">alpha</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">beta_zero</span> <span class="o">=</span> <span class="p">(</span><span class="n">beta</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">beta_nonzero</span> <span class="o">=</span> <span class="o">~</span><span class="n">beta_zero</span>
            <span class="n">w</span><span class="p">[</span><span class="n">beta_nonzero</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">[</span><span class="n">beta_nonzero</span><span class="p">]</span><span class="o">/</span><span class="n">beta</span><span class="p">[</span><span class="n">beta_nonzero</span><span class="p">]</span>
            <span class="c1"># Use np.inf for complex values too since</span>
            <span class="c1"># 1/np.inf = 0, i.e., it correctly behaves as projective</span>
            <span class="c1"># infinity.</span>
            <span class="n">w</span><span class="p">[</span><span class="o">~</span><span class="n">alpha_zero</span> <span class="o">&amp;</span> <span class="n">beta_zero</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">alpha</span><span class="o">.</span><span class="n">imag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                <span class="n">w</span><span class="p">[</span><span class="n">alpha_zero</span> <span class="o">&amp;</span> <span class="n">beta_zero</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">w</span><span class="p">[</span><span class="n">alpha_zero</span> <span class="o">&amp;</span> <span class="n">beta_zero</span><span class="p">]</span> <span class="o">=</span> <span class="nb">complex</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">w</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_geneig</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">overwrite_a</span><span class="p">,</span> <span class="n">overwrite_b</span><span class="p">,</span>
            <span class="n">homogeneous_eigvals</span><span class="p">):</span>
    <span class="n">ggev</span><span class="p">,</span> <span class="o">=</span> <span class="n">get_lapack_funcs</span><span class="p">((</span><span class="s1">&#39;ggev&#39;</span><span class="p">,),</span> <span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">b1</span><span class="p">))</span>
    <span class="n">cvl</span><span class="p">,</span> <span class="n">cvr</span> <span class="o">=</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">ggev</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">lwork</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">lwork</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">real</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int_</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ggev</span><span class="o">.</span><span class="n">typecode</span> <span class="ow">in</span> <span class="s1">&#39;cz&#39;</span><span class="p">:</span>
        <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">vl</span><span class="p">,</span> <span class="n">vr</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">ggev</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">cvl</span><span class="p">,</span> <span class="n">cvr</span><span class="p">,</span> <span class="n">lwork</span><span class="p">,</span>
                                               <span class="n">overwrite_a</span><span class="p">,</span> <span class="n">overwrite_b</span><span class="p">)</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">_make_eigvals</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">homogeneous_eigvals</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">alphar</span><span class="p">,</span> <span class="n">alphai</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">vl</span><span class="p">,</span> <span class="n">vr</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">ggev</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">cvl</span><span class="p">,</span> <span class="n">cvr</span><span class="p">,</span>
                                                        <span class="n">lwork</span><span class="p">,</span> <span class="n">overwrite_a</span><span class="p">,</span>
                                                        <span class="n">overwrite_b</span><span class="p">)</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="n">alphar</span> <span class="o">+</span> <span class="n">_I</span> <span class="o">*</span> <span class="n">alphai</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">_make_eigvals</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">homogeneous_eigvals</span><span class="p">)</span>
    <span class="n">_check_info</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="s1">&#39;generalized eig algorithm (ggev)&#39;</span><span class="p">)</span>

    <span class="n">only_real</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">imag</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">ggev</span><span class="o">.</span><span class="n">typecode</span> <span class="ow">in</span> <span class="s1">&#39;cz&#39;</span> <span class="ow">or</span> <span class="n">only_real</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">char</span>
        <span class="k">if</span> <span class="n">left</span><span class="p">:</span>
            <span class="n">vl</span> <span class="o">=</span> <span class="n">_make_complex_eigvecs</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">vl</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">right</span><span class="p">:</span>
            <span class="n">vr</span> <span class="o">=</span> <span class="n">_make_complex_eigvecs</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">vr</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>

    <span class="c1"># the eigenvectors returned by the lapack function are NOT normalized</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">vr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="k">if</span> <span class="n">right</span><span class="p">:</span>
            <span class="n">vr</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">/=</span> <span class="n">norm</span><span class="p">(</span><span class="n">vr</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">left</span><span class="p">:</span>
            <span class="n">vl</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">/=</span> <span class="n">norm</span><span class="p">(</span><span class="n">vl</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">left</span> <span class="ow">or</span> <span class="n">right</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">w</span>
    <span class="k">if</span> <span class="n">left</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">right</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">w</span><span class="p">,</span> <span class="n">vl</span><span class="p">,</span> <span class="n">vr</span>
        <span class="k">return</span> <span class="n">w</span><span class="p">,</span> <span class="n">vl</span>
    <span class="k">return</span> <span class="n">w</span><span class="p">,</span> <span class="n">vr</span>


<div class="viewcode-block" id="eig">
<a class="viewcode-back" href="../../../_autosummary/egttools.analytical.sed_analytical.eig.html#egttools.analytical.sed_analytical.eig">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">eig</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">overwrite_a</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">overwrite_b</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">check_finite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">homogeneous_eigvals</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Solve an ordinary or generalized eigenvalue problem of a square matrix.</span>

<span class="sd">    Find eigenvalues w and right or left eigenvectors of a general matrix::</span>

<span class="sd">        a   vr[:,i] = w[i]        b   vr[:,i]</span>
<span class="sd">        a.H vl[:,i] = w[i].conj() b.H vl[:,i]</span>

<span class="sd">    where ``.H`` is the Hermitian conjugation.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : (M, M) array_like</span>
<span class="sd">        A complex or real matrix whose eigenvalues and eigenvectors</span>
<span class="sd">        will be computed.</span>
<span class="sd">    b : (M, M) array_like, optional</span>
<span class="sd">        Right-hand side matrix in a generalized eigenvalue problem.</span>
<span class="sd">        Default is None, identity matrix is assumed.</span>
<span class="sd">    left : bool, optional</span>
<span class="sd">        Whether to calculate and return left eigenvectors.  Default is False.</span>
<span class="sd">    right : bool, optional</span>
<span class="sd">        Whether to calculate and return right eigenvectors.  Default is True.</span>
<span class="sd">    overwrite_a : bool, optional</span>
<span class="sd">        Whether to overwrite `a`; may improve performance.  Default is False.</span>
<span class="sd">    overwrite_b : bool, optional</span>
<span class="sd">        Whether to overwrite `b`; may improve performance.  Default is False.</span>
<span class="sd">    check_finite : bool, optional</span>
<span class="sd">        Whether to check that the input matrices contain only finite numbers.</span>
<span class="sd">        Disabling may give a performance gain, but may result in problems</span>
<span class="sd">        (crashes, non-termination) if the inputs do contain infinities or NaNs.</span>
<span class="sd">    homogeneous_eigvals : bool, optional</span>
<span class="sd">        If True, return the eigenvalues in homogeneous coordinates.</span>
<span class="sd">        In this case ``w`` is a (2, M) array so that::</span>

<span class="sd">            w[1,i] a vr[:,i] = w[0,i] b vr[:,i]</span>

<span class="sd">        Default is False.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    w : (M,) or (2, M) double or complex ndarray</span>
<span class="sd">        The eigenvalues, each repeated according to its</span>
<span class="sd">        multiplicity. The shape is (M,) unless</span>
<span class="sd">        ``homogeneous_eigvals=True``.</span>
<span class="sd">    vl : (M, M) double or complex ndarray</span>
<span class="sd">        The left eigenvector corresponding to the eigenvalue</span>
<span class="sd">        ``w[i]`` is the column ``vl[:,i]``. Only returned if ``left=True``.</span>
<span class="sd">        The left eigenvector is not normalized.</span>
<span class="sd">    vr : (M, M) double or complex ndarray</span>
<span class="sd">        The normalized right eigenvector corresponding to the eigenvalue</span>
<span class="sd">        ``w[i]`` is the column ``vr[:,i]``.  Only returned if ``right=True``.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    LinAlgError</span>
<span class="sd">        If eigenvalue computation does not converge.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    eigvals : eigenvalues of general arrays</span>
<span class="sd">    eigh : Eigenvalues and right eigenvectors for symmetric/Hermitian arrays.</span>
<span class="sd">    eig_banded : eigenvalues and right eigenvectors for symmetric/Hermitian</span>
<span class="sd">        band matrices</span>
<span class="sd">    eigh_tridiagonal : eigenvalues and right eiegenvectors for</span>
<span class="sd">        symmetric/Hermitian tridiagonal matrices</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import numpy as np</span>
<span class="sd">    &gt;&gt;&gt; from scipy import linalg</span>
<span class="sd">    &gt;&gt;&gt; a = np.array([[0., -1.], [1., 0.]])</span>
<span class="sd">    &gt;&gt;&gt; linalg.eigvals(a)</span>
<span class="sd">    array([0.+1.j, 0.-1.j])</span>

<span class="sd">    &gt;&gt;&gt; b = np.array([[0., 1.], [1., 1.]])</span>
<span class="sd">    &gt;&gt;&gt; linalg.eigvals(a, b)</span>
<span class="sd">    array([ 1.+0.j, -1.+0.j])</span>

<span class="sd">    &gt;&gt;&gt; a = np.array([[3., 0., 0.], [0., 8., 0.], [0., 0., 7.]])</span>
<span class="sd">    &gt;&gt;&gt; linalg.eigvals(a, homogeneous_eigvals=True)</span>
<span class="sd">    array([[3.+0.j, 8.+0.j, 7.+0.j],</span>
<span class="sd">           [1.+0.j, 1.+0.j, 1.+0.j]])</span>

<span class="sd">    &gt;&gt;&gt; a = np.array([[0., -1.], [1., 0.]])</span>
<span class="sd">    &gt;&gt;&gt; linalg.eigvals(a) == linalg.eig(a)[0]</span>
<span class="sd">    array([ True,  True])</span>
<span class="sd">    &gt;&gt;&gt; linalg.eig(a, left=True, right=False)[1] # normalized left eigenvector</span>
<span class="sd">    array([[-0.70710678+0.j        , -0.70710678-0.j        ],</span>
<span class="sd">           [-0.        +0.70710678j, -0.        -0.70710678j]])</span>
<span class="sd">    &gt;&gt;&gt; linalg.eig(a, left=False, right=True)[1] # normalized right eigenvector</span>
<span class="sd">    array([[0.70710678+0.j        , 0.70710678-0.j        ],</span>
<span class="sd">           [0.        -0.70710678j, 0.        +0.70710678j]])</span>



<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a1</span> <span class="o">=</span> <span class="n">_asarray_validated</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">check_finite</span><span class="o">=</span><span class="n">check_finite</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">a1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">a1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">a1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;expected square matrix&#39;</span><span class="p">)</span>

    <span class="c1"># accommodate square empty matrices</span>
    <span class="k">if</span> <span class="n">a1</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">w_n</span><span class="p">,</span> <span class="n">vr_n</span> <span class="o">=</span> <span class="n">eig</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">a1</span><span class="o">.</span><span class="n">dtype</span><span class="p">))</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">w_n</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">_make_eigvals</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">homogeneous_eigvals</span><span class="p">)</span>
        <span class="n">vl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">vr_n</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
        <span class="n">vr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">vr_n</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">left</span> <span class="ow">or</span> <span class="n">right</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">w</span>
        <span class="k">if</span> <span class="n">left</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">right</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">w</span><span class="p">,</span> <span class="n">vl</span><span class="p">,</span> <span class="n">vr</span>
            <span class="k">return</span> <span class="n">w</span><span class="p">,</span> <span class="n">vl</span>
        <span class="k">return</span> <span class="n">w</span><span class="p">,</span> <span class="n">vr</span>

    <span class="n">overwrite_a</span> <span class="o">=</span> <span class="n">overwrite_a</span> <span class="ow">or</span> <span class="p">(</span><span class="n">_datacopied</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">b</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">b1</span> <span class="o">=</span> <span class="n">_asarray_validated</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">check_finite</span><span class="o">=</span><span class="n">check_finite</span><span class="p">)</span>
        <span class="n">overwrite_b</span> <span class="o">=</span> <span class="n">overwrite_b</span> <span class="ow">or</span> <span class="n">_datacopied</span><span class="p">(</span><span class="n">b1</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">b1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">b1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">b1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;expected square matrix&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">b1</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">a1</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;a and b must have the same shape&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_geneig</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">overwrite_a</span><span class="p">,</span> <span class="n">overwrite_b</span><span class="p">,</span>
                       <span class="n">homogeneous_eigvals</span><span class="p">)</span>

    <span class="n">geev</span><span class="p">,</span> <span class="n">geev_lwork</span> <span class="o">=</span> <span class="n">get_lapack_funcs</span><span class="p">((</span><span class="s1">&#39;geev&#39;</span><span class="p">,</span> <span class="s1">&#39;geev_lwork&#39;</span><span class="p">),</span> <span class="p">(</span><span class="n">a1</span><span class="p">,))</span>
    <span class="n">compute_vl</span><span class="p">,</span> <span class="n">compute_vr</span> <span class="o">=</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span>

    <span class="n">lwork</span> <span class="o">=</span> <span class="n">_compute_lwork</span><span class="p">(</span><span class="n">geev_lwork</span><span class="p">,</span> <span class="n">a1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                           <span class="n">compute_vl</span><span class="o">=</span><span class="n">compute_vl</span><span class="p">,</span>
                           <span class="n">compute_vr</span><span class="o">=</span><span class="n">compute_vr</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">geev</span><span class="o">.</span><span class="n">typecode</span> <span class="ow">in</span> <span class="s1">&#39;cz&#39;</span><span class="p">:</span>
        <span class="n">w</span><span class="p">,</span> <span class="n">vl</span><span class="p">,</span> <span class="n">vr</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">geev</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">lwork</span><span class="o">=</span><span class="n">lwork</span><span class="p">,</span>
                               <span class="n">compute_vl</span><span class="o">=</span><span class="n">compute_vl</span><span class="p">,</span>
                               <span class="n">compute_vr</span><span class="o">=</span><span class="n">compute_vr</span><span class="p">,</span>
                               <span class="n">overwrite_a</span><span class="o">=</span><span class="n">overwrite_a</span><span class="p">)</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">_make_eigvals</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">homogeneous_eigvals</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">wr</span><span class="p">,</span> <span class="n">wi</span><span class="p">,</span> <span class="n">vl</span><span class="p">,</span> <span class="n">vr</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">geev</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">lwork</span><span class="o">=</span><span class="n">lwork</span><span class="p">,</span>
                                    <span class="n">compute_vl</span><span class="o">=</span><span class="n">compute_vl</span><span class="p">,</span>
                                    <span class="n">compute_vr</span><span class="o">=</span><span class="n">compute_vr</span><span class="p">,</span>
                                    <span class="n">overwrite_a</span><span class="o">=</span><span class="n">overwrite_a</span><span class="p">)</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">wr</span> <span class="o">+</span> <span class="n">_I</span> <span class="o">*</span> <span class="n">wi</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">_make_eigvals</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">homogeneous_eigvals</span><span class="p">)</span>

    <span class="n">_check_info</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="s1">&#39;eig algorithm (geev)&#39;</span><span class="p">,</span>
                <span class="n">positive</span><span class="o">=</span><span class="s1">&#39;did not converge (only eigenvalues &#39;</span>
                         <span class="s1">&#39;with order &gt;= </span><span class="si">%d</span><span class="s1"> have converged)&#39;</span><span class="p">)</span>

    <span class="n">only_real</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">imag</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">geev</span><span class="o">.</span><span class="n">typecode</span> <span class="ow">in</span> <span class="s1">&#39;cz&#39;</span> <span class="ow">or</span> <span class="n">only_real</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">char</span>
        <span class="k">if</span> <span class="n">left</span><span class="p">:</span>
            <span class="n">vl</span> <span class="o">=</span> <span class="n">_make_complex_eigvecs</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">vl</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">right</span><span class="p">:</span>
            <span class="n">vr</span> <span class="o">=</span> <span class="n">_make_complex_eigvecs</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">vr</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">left</span> <span class="ow">or</span> <span class="n">right</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">w</span>
    <span class="k">if</span> <span class="n">left</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">right</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">w</span><span class="p">,</span> <span class="n">vl</span><span class="p">,</span> <span class="n">vr</span>
        <span class="k">return</span> <span class="n">w</span><span class="p">,</span> <span class="n">vl</span>
    <span class="k">return</span> <span class="n">w</span><span class="p">,</span> <span class="n">vr</span></div>



<span class="k">def</span><span class="w"> </span><span class="nf">eigh</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">eigvals_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">overwrite_a</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
         <span class="n">overwrite_b</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">check_finite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">subset_by_index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
         <span class="n">subset_by_value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Solve a standard or generalized eigenvalue problem for a complex</span>
<span class="sd">    Hermitian or real symmetric matrix.</span>

<span class="sd">    Find eigenvalues array ``w`` and optionally eigenvectors array ``v`` of</span>
<span class="sd">    array ``a``, where ``b`` is positive definite such that for every</span>
<span class="sd">    eigenvalue λ (i-th entry of w) and its eigenvector ``vi`` (i-th column of</span>
<span class="sd">    ``v``) satisfies::</span>

<span class="sd">                      a @ vi = λ * b @ vi</span>
<span class="sd">        vi.conj().T @ a @ vi = λ</span>
<span class="sd">        vi.conj().T @ b @ vi = 1</span>

<span class="sd">    In the standard problem, ``b`` is assumed to be the identity matrix.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : (M, M) array_like</span>
<span class="sd">        A complex Hermitian or real symmetric matrix whose eigenvalues and</span>
<span class="sd">        eigenvectors will be computed.</span>
<span class="sd">    b : (M, M) array_like, optional</span>
<span class="sd">        A complex Hermitian or real symmetric definite positive matrix in.</span>
<span class="sd">        If omitted, identity matrix is assumed.</span>
<span class="sd">    lower : bool, optional</span>
<span class="sd">        Whether the pertinent array data is taken from the lower or upper</span>
<span class="sd">        triangle of ``a`` and, if applicable, ``b``. (Default: lower)</span>
<span class="sd">    eigvals_only : bool, optional</span>
<span class="sd">        Whether to calculate only eigenvalues and no eigenvectors.</span>
<span class="sd">        (Default: both are calculated)</span>
<span class="sd">    subset_by_index : iterable, optional</span>
<span class="sd">        If provided, this two-element iterable defines the start and the end</span>
<span class="sd">        indices of the desired eigenvalues (ascending order and 0-indexed).</span>
<span class="sd">        To return only the second smallest to fifth smallest eigenvalues,</span>
<span class="sd">        ``[1, 4]`` is used. ``[n-3, n-1]`` returns the largest three. Only</span>
<span class="sd">        available with &quot;evr&quot;, &quot;evx&quot;, and &quot;gvx&quot; drivers. The entries are</span>
<span class="sd">        directly converted to integers via ``int()``.</span>
<span class="sd">    subset_by_value : iterable, optional</span>
<span class="sd">        If provided, this two-element iterable defines the half-open interval</span>
<span class="sd">        ``(a, b]`` that, if any, only the eigenvalues between these values</span>
<span class="sd">        are returned. Only available with &quot;evr&quot;, &quot;evx&quot;, and &quot;gvx&quot; drivers. Use</span>
<span class="sd">        ``np.inf`` for the unconstrained ends.</span>
<span class="sd">    driver : str, optional</span>
<span class="sd">        Defines which LAPACK driver should be used. Valid options are &quot;ev&quot;,</span>
<span class="sd">        &quot;evd&quot;, &quot;evr&quot;, &quot;evx&quot; for standard problems and &quot;gv&quot;, &quot;gvd&quot;, &quot;gvx&quot; for</span>
<span class="sd">        generalized (where b is not None) problems. See the Notes section.</span>
<span class="sd">        The default for standard problems is &quot;evr&quot;. For generalized problems,</span>
<span class="sd">        &quot;gvd&quot; is used for full set, and &quot;gvx&quot; for subset requested cases.</span>
<span class="sd">    type : int, optional</span>
<span class="sd">        For the generalized problems, this keyword specifies the problem type</span>
<span class="sd">        to be solved for ``w`` and ``v`` (only takes 1, 2, 3 as possible</span>
<span class="sd">        inputs)::</span>

<span class="sd">            1 =&gt;     a @ v = w @ b @ v</span>
<span class="sd">            2 =&gt; a @ b @ v = w @ v</span>
<span class="sd">            3 =&gt; b @ a @ v = w @ v</span>

<span class="sd">        This keyword is ignored for standard problems.</span>
<span class="sd">    overwrite_a : bool, optional</span>
<span class="sd">        Whether to overwrite data in ``a`` (may improve performance). Default</span>
<span class="sd">        is False.</span>
<span class="sd">    overwrite_b : bool, optional</span>
<span class="sd">        Whether to overwrite data in ``b`` (may improve performance). Default</span>
<span class="sd">        is False.</span>
<span class="sd">    check_finite : bool, optional</span>
<span class="sd">        Whether to check that the input matrices contain only finite numbers.</span>
<span class="sd">        Disabling may give a performance gain, but may result in problems</span>
<span class="sd">        (crashes, non-termination) if the inputs do contain infinities or NaNs.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    w : (N,) ndarray</span>
<span class="sd">        The N (N&lt;=M) selected eigenvalues, in ascending order, each</span>
<span class="sd">        repeated according to its multiplicity.</span>
<span class="sd">    v : (M, N) ndarray</span>
<span class="sd">        The normalized eigenvector corresponding to the eigenvalue ``w[i]`` is</span>
<span class="sd">        the column ``v[:,i]``. Only returned if ``eigvals_only=False``.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    LinAlgError</span>
<span class="sd">        If eigenvalue computation does not converge, an error occurred, or</span>
<span class="sd">        b matrix is not definite positive. Note that if input matrices are</span>
<span class="sd">        not symmetric or Hermitian, no error will be reported but results will</span>
<span class="sd">        be wrong.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    eigvalsh : eigenvalues of symmetric or Hermitian arrays</span>
<span class="sd">    eig : eigenvalues and right eigenvectors for non-symmetric arrays</span>
<span class="sd">    eigh_tridiagonal : eigenvalues and right eiegenvectors for</span>
<span class="sd">        symmetric/Hermitian tridiagonal matrices</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    This function does not check the input array for being Hermitian/symmetric</span>
<span class="sd">    in order to allow for representing arrays with only their upper/lower</span>
<span class="sd">    triangular parts. Also, note that even though not taken into account,</span>
<span class="sd">    finiteness check applies to the whole array and unaffected by &quot;lower&quot;</span>
<span class="sd">    keyword.</span>

<span class="sd">    This function uses LAPACK drivers for computations in all possible keyword</span>
<span class="sd">    combinations, prefixed with ``sy`` if arrays are real and ``he`` if</span>
<span class="sd">    complex, e.g., a float array with &quot;evr&quot; driver is solved via</span>
<span class="sd">    &quot;syevr&quot;, complex arrays with &quot;gvx&quot; driver problem is solved via &quot;hegvx&quot;</span>
<span class="sd">    etc.</span>

<span class="sd">    As a brief summary, the slowest and the most robust driver is the</span>
<span class="sd">    classical ``&lt;sy/he&gt;ev`` which uses symmetric QR. ``&lt;sy/he&gt;evr`` is seen as</span>
<span class="sd">    the optimal choice for the most general cases. However, there are certain</span>
<span class="sd">    occasions that ``&lt;sy/he&gt;evd`` computes faster at the expense of more</span>
<span class="sd">    memory usage. ``&lt;sy/he&gt;evx``, while still being faster than ``&lt;sy/he&gt;ev``,</span>
<span class="sd">    often performs worse than the rest except when very few eigenvalues are</span>
<span class="sd">    requested for large arrays though there is still no performance guarantee.</span>

<span class="sd">    Note that the underlying LAPACK algorithms are different depending on whether</span>
<span class="sd">    `eigvals_only` is True or False --- thus the eigenvalues may differ</span>
<span class="sd">    depending on whether eigenvectors are requested or not. The difference is</span>
<span class="sd">    generally of the order of machine epsilon times the largest eigenvalue,</span>
<span class="sd">    so is likely only visible for zero or nearly zero eigenvalues.</span>

<span class="sd">    For the generalized problem, normalization with respect to the given</span>
<span class="sd">    type argument::</span>

<span class="sd">            type 1 and 3 :      v.conj().T @ a @ v = w</span>
<span class="sd">            type 2       : inv(v).conj().T @ a @ inv(v) = w</span>

<span class="sd">            type 1 or 2  :      v.conj().T @ b @ v  = I</span>
<span class="sd">            type 3       : v.conj().T @ inv(b) @ v  = I</span>


<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import numpy as np</span>
<span class="sd">    &gt;&gt;&gt; from scipy.linalg import eigh</span>
<span class="sd">    &gt;&gt;&gt; A = np.array([[6, 3, 1, 5], [3, 0, 5, 1], [1, 5, 6, 2], [5, 1, 2, 2]])</span>
<span class="sd">    &gt;&gt;&gt; w, v = eigh(A)</span>
<span class="sd">    &gt;&gt;&gt; np.allclose(A @ v - v @ np.diag(w), np.zeros((4, 4)))</span>
<span class="sd">    True</span>

<span class="sd">    Request only the eigenvalues</span>

<span class="sd">    &gt;&gt;&gt; w = eigh(A, eigvals_only=True)</span>

<span class="sd">    Request eigenvalues that are less than 10.</span>

<span class="sd">    &gt;&gt;&gt; A = np.array([[34, -4, -10, -7, 2],</span>
<span class="sd">    ...               [-4, 7, 2, 12, 0],</span>
<span class="sd">    ...               [-10, 2, 44, 2, -19],</span>
<span class="sd">    ...               [-7, 12, 2, 79, -34],</span>
<span class="sd">    ...               [2, 0, -19, -34, 29]])</span>
<span class="sd">    &gt;&gt;&gt; eigh(A, eigvals_only=True, subset_by_value=[-np.inf, 10])</span>
<span class="sd">    array([6.69199443e-07, 9.11938152e+00])</span>

<span class="sd">    Request the second smallest eigenvalue and its eigenvector</span>

<span class="sd">    &gt;&gt;&gt; w, v = eigh(A, subset_by_index=[1, 1])</span>
<span class="sd">    &gt;&gt;&gt; w</span>
<span class="sd">    array([9.11938152])</span>
<span class="sd">    &gt;&gt;&gt; v.shape  # only a single column is returned</span>
<span class="sd">    (5, 1)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># set lower</span>
    <span class="n">uplo</span> <span class="o">=</span> <span class="s1">&#39;L&#39;</span> <span class="k">if</span> <span class="n">lower</span> <span class="k">else</span> <span class="s1">&#39;U&#39;</span>
    <span class="c1"># Set job for Fortran routines</span>
    <span class="n">_job</span> <span class="o">=</span> <span class="s1">&#39;N&#39;</span> <span class="k">if</span> <span class="n">eigvals_only</span> <span class="k">else</span> <span class="s1">&#39;V&#39;</span>

    <span class="n">drv_str</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;ev&quot;</span><span class="p">,</span> <span class="s2">&quot;evd&quot;</span><span class="p">,</span> <span class="s2">&quot;evr&quot;</span><span class="p">,</span> <span class="s2">&quot;evx&quot;</span><span class="p">,</span> <span class="s2">&quot;gv&quot;</span><span class="p">,</span> <span class="s2">&quot;gvd&quot;</span><span class="p">,</span> <span class="s2">&quot;gvx&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">driver</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">drv_str</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;&quot;</span><span class="si">{}</span><span class="s1">&quot; is unknown. Possible values are &quot;None&quot;, &quot;</span><span class="si">{}</span><span class="s1">&quot;.&#39;</span>
                         <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="s1">&#39;&quot;, &quot;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">drv_str</span><span class="p">[</span><span class="mi">1</span><span class="p">:])))</span>

    <span class="n">a1</span> <span class="o">=</span> <span class="n">_asarray_validated</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">check_finite</span><span class="o">=</span><span class="n">check_finite</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">a1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">a1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">a1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;expected square &quot;a&quot; matrix&#39;</span><span class="p">)</span>

    <span class="c1"># accommodate square empty matrices</span>
    <span class="k">if</span> <span class="n">a1</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">w_n</span><span class="p">,</span> <span class="n">v_n</span> <span class="o">=</span> <span class="n">eigh</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">a1</span><span class="o">.</span><span class="n">dtype</span><span class="p">))</span>

        <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">w_n</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">v_n</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">eigvals_only</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">w</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">w</span><span class="p">,</span> <span class="n">v</span>

    <span class="n">overwrite_a</span> <span class="o">=</span> <span class="n">overwrite_a</span> <span class="ow">or</span> <span class="p">(</span><span class="n">_datacopied</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a</span><span class="p">))</span>
    <span class="n">cplx</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">iscomplexobj</span><span class="p">(</span><span class="n">a1</span><span class="p">)</span> <span class="k">else</span> <span class="kc">False</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">a1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">drv_args</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;overwrite_a&#39;</span><span class="p">:</span> <span class="n">overwrite_a</span><span class="p">}</span>

    <span class="k">if</span> <span class="n">b</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">b1</span> <span class="o">=</span> <span class="n">_asarray_validated</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">check_finite</span><span class="o">=</span><span class="n">check_finite</span><span class="p">)</span>
        <span class="n">overwrite_b</span> <span class="o">=</span> <span class="n">overwrite_b</span> <span class="ow">or</span> <span class="n">_datacopied</span><span class="p">(</span><span class="n">b1</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">b1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">b1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">b1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;expected square &quot;b&quot; matrix&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">b1</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">a1</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;wrong b dimensions </span><span class="si">{</span><span class="n">b1</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">, should be </span><span class="si">{</span><span class="n">a1</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;&quot;type&quot; keyword only accepts 1, 2, and 3.&#39;</span><span class="p">)</span>

        <span class="n">cplx</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">iscomplexobj</span><span class="p">(</span><span class="n">b1</span><span class="p">)</span> <span class="k">else</span> <span class="p">(</span><span class="n">cplx</span> <span class="ow">or</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">drv_args</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;overwrite_b&#39;</span><span class="p">:</span> <span class="n">overwrite_b</span><span class="p">,</span> <span class="s1">&#39;itype&#39;</span><span class="p">:</span> <span class="nb">type</span><span class="p">})</span>

    <span class="n">subset</span> <span class="o">=</span> <span class="p">(</span><span class="n">subset_by_index</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">subset_by_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>

    <span class="c1"># Both subsets can&#39;t be given</span>
    <span class="k">if</span> <span class="n">subset_by_index</span> <span class="ow">and</span> <span class="n">subset_by_value</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Either index or value subset can be requested.&#39;</span><span class="p">)</span>

    <span class="c1"># Check indices if given</span>
    <span class="k">if</span> <span class="n">subset_by_index</span><span class="p">:</span>
        <span class="n">lo</span><span class="p">,</span> <span class="n">hi</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">subset_by_index</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">lo</span> <span class="o">&lt;=</span> <span class="n">hi</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Requested eigenvalue indices are not valid. &#39;</span>
                             <span class="sa">f</span><span class="s1">&#39;Valid range is [0, </span><span class="si">{</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="si">}</span><span class="s1">] and start &lt;= end, but &#39;</span>
                             <span class="sa">f</span><span class="s1">&#39;start=</span><span class="si">{</span><span class="n">lo</span><span class="si">}</span><span class="s1">, end=</span><span class="si">{</span><span class="n">hi</span><span class="si">}</span><span class="s1"> is given&#39;</span><span class="p">)</span>
        <span class="c1"># fortran is 1-indexed</span>
        <span class="n">drv_args</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="s1">&#39;il&#39;</span><span class="p">:</span> <span class="n">lo</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;iu&#39;</span><span class="p">:</span> <span class="n">hi</span> <span class="o">+</span> <span class="mi">1</span><span class="p">})</span>

    <span class="k">if</span> <span class="n">subset_by_value</span><span class="p">:</span>
        <span class="n">lo</span><span class="p">,</span> <span class="n">hi</span> <span class="o">=</span> <span class="n">subset_by_value</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="o">-</span><span class="n">inf</span> <span class="o">&lt;=</span> <span class="n">lo</span> <span class="o">&lt;</span> <span class="n">hi</span> <span class="o">&lt;=</span> <span class="n">inf</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Requested eigenvalue bounds are not valid. &#39;</span>
                             <span class="s1">&#39;Valid range is (-inf, inf) and low &lt; high, but &#39;</span>
                             <span class="sa">f</span><span class="s1">&#39;low=</span><span class="si">{</span><span class="n">lo</span><span class="si">}</span><span class="s1">, high=</span><span class="si">{</span><span class="n">hi</span><span class="si">}</span><span class="s1"> is given&#39;</span><span class="p">)</span>

        <span class="n">drv_args</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="s1">&#39;vl&#39;</span><span class="p">:</span> <span class="n">lo</span><span class="p">,</span> <span class="s1">&#39;vu&#39;</span><span class="p">:</span> <span class="n">hi</span><span class="p">})</span>

    <span class="c1"># fix prefix for lapack routines</span>
    <span class="n">pfx</span> <span class="o">=</span> <span class="s1">&#39;he&#39;</span> <span class="k">if</span> <span class="n">cplx</span> <span class="k">else</span> <span class="s1">&#39;sy&#39;</span>

    <span class="c1"># decide on the driver if not given</span>
    <span class="c1"># first early exit on incompatible choice</span>
    <span class="k">if</span> <span class="n">driver</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">b</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="n">driver</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;gv&quot;</span><span class="p">,</span> <span class="s2">&quot;gvd&quot;</span><span class="p">,</span> <span class="s2">&quot;gvx&quot;</span><span class="p">]):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">driver</span><span class="si">}</span><span class="s1"> requires input b array to be supplied &#39;</span>
                             <span class="s1">&#39;for generalized eigenvalue problems.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">b</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">driver</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ev&#39;</span><span class="p">,</span> <span class="s1">&#39;evd&#39;</span><span class="p">,</span> <span class="s1">&#39;evr&#39;</span><span class="p">,</span> <span class="s1">&#39;evx&#39;</span><span class="p">]):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">driver</span><span class="si">}</span><span class="s1">&quot; does not accept input b array &#39;</span>
                             <span class="s1">&#39;for standard eigenvalue problems.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">subset</span> <span class="ow">and</span> <span class="p">(</span><span class="n">driver</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;ev&quot;</span><span class="p">,</span> <span class="s2">&quot;evd&quot;</span><span class="p">,</span> <span class="s2">&quot;gv&quot;</span><span class="p">,</span> <span class="s2">&quot;gvd&quot;</span><span class="p">]):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">driver</span><span class="si">}</span><span class="s1">&quot; cannot compute subsets of eigenvalues&#39;</span><span class="p">)</span>

    <span class="c1"># Default driver is evr and gvd</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">driver</span> <span class="o">=</span> <span class="s2">&quot;evr&quot;</span> <span class="k">if</span> <span class="n">b</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">(</span><span class="s2">&quot;gvx&quot;</span> <span class="k">if</span> <span class="n">subset</span> <span class="k">else</span> <span class="s2">&quot;gvd&quot;</span><span class="p">)</span>

    <span class="n">lwork_spec</span> <span class="o">=</span> <span class="p">{</span>
                  <span class="s1">&#39;syevd&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;lwork&#39;</span><span class="p">,</span> <span class="s1">&#39;liwork&#39;</span><span class="p">],</span>
                  <span class="s1">&#39;syevr&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;lwork&#39;</span><span class="p">,</span> <span class="s1">&#39;liwork&#39;</span><span class="p">],</span>
                  <span class="s1">&#39;heevd&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;lwork&#39;</span><span class="p">,</span> <span class="s1">&#39;liwork&#39;</span><span class="p">,</span> <span class="s1">&#39;lrwork&#39;</span><span class="p">],</span>
                  <span class="s1">&#39;heevr&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;lwork&#39;</span><span class="p">,</span> <span class="s1">&#39;lrwork&#39;</span><span class="p">,</span> <span class="s1">&#39;liwork&#39;</span><span class="p">],</span>
                  <span class="p">}</span>

    <span class="k">if</span> <span class="n">b</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># Standard problem</span>
        <span class="n">drv</span><span class="p">,</span> <span class="n">drvlw</span> <span class="o">=</span> <span class="n">get_lapack_funcs</span><span class="p">((</span><span class="n">pfx</span> <span class="o">+</span> <span class="n">driver</span><span class="p">,</span> <span class="n">pfx</span><span class="o">+</span><span class="n">driver</span><span class="o">+</span><span class="s1">&#39;_lwork&#39;</span><span class="p">),</span>
                                      <span class="p">[</span><span class="n">a1</span><span class="p">])</span>
        <span class="n">clw_args</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;n&#39;</span><span class="p">:</span> <span class="n">n</span><span class="p">,</span> <span class="s1">&#39;lower&#39;</span><span class="p">:</span> <span class="n">lower</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">driver</span> <span class="o">==</span> <span class="s1">&#39;evd&#39;</span><span class="p">:</span>
            <span class="n">clw_args</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;compute_v&#39;</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">_job</span> <span class="o">==</span> <span class="s2">&quot;N&quot;</span> <span class="k">else</span> <span class="mi">1</span><span class="p">})</span>

        <span class="n">lw</span> <span class="o">=</span> <span class="n">_compute_lwork</span><span class="p">(</span><span class="n">drvlw</span><span class="p">,</span> <span class="o">**</span><span class="n">clw_args</span><span class="p">)</span>
        <span class="c1"># Multiple lwork vars</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lw</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">lwork_args</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">lwork_spec</span><span class="p">[</span><span class="n">pfx</span><span class="o">+</span><span class="n">driver</span><span class="p">],</span> <span class="n">lw</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lwork_args</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;lwork&#39;</span><span class="p">:</span> <span class="n">lw</span><span class="p">}</span>

        <span class="n">drv_args</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;lower&#39;</span><span class="p">:</span> <span class="n">lower</span><span class="p">,</span> <span class="s1">&#39;compute_v&#39;</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">_job</span> <span class="o">==</span> <span class="s2">&quot;N&quot;</span> <span class="k">else</span> <span class="mi">1</span><span class="p">})</span>
        <span class="n">w</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="o">*</span><span class="n">other_args</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">drv</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">a1</span><span class="p">,</span> <span class="o">**</span><span class="n">drv_args</span><span class="p">,</span> <span class="o">**</span><span class="n">lwork_args</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>  <span class="c1"># Generalized problem</span>
        <span class="c1"># &#39;gvd&#39; doesn&#39;t have lwork query</span>
        <span class="k">if</span> <span class="n">driver</span> <span class="o">==</span> <span class="s2">&quot;gvd&quot;</span><span class="p">:</span>
            <span class="n">drv</span> <span class="o">=</span> <span class="n">get_lapack_funcs</span><span class="p">(</span><span class="n">pfx</span> <span class="o">+</span> <span class="s2">&quot;gvd&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">a1</span><span class="p">,</span> <span class="n">b1</span><span class="p">])</span>
            <span class="n">lwork_args</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">drv</span><span class="p">,</span> <span class="n">drvlw</span> <span class="o">=</span> <span class="n">get_lapack_funcs</span><span class="p">((</span><span class="n">pfx</span> <span class="o">+</span> <span class="n">driver</span><span class="p">,</span> <span class="n">pfx</span><span class="o">+</span><span class="n">driver</span><span class="o">+</span><span class="s1">&#39;_lwork&#39;</span><span class="p">),</span>
                                          <span class="p">[</span><span class="n">a1</span><span class="p">,</span> <span class="n">b1</span><span class="p">])</span>
            <span class="c1"># generalized drivers use uplo instead of lower</span>
            <span class="n">lw</span> <span class="o">=</span> <span class="n">_compute_lwork</span><span class="p">(</span><span class="n">drvlw</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">uplo</span><span class="o">=</span><span class="n">uplo</span><span class="p">)</span>
            <span class="n">lwork_args</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;lwork&#39;</span><span class="p">:</span> <span class="n">lw</span><span class="p">}</span>

        <span class="n">drv_args</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;uplo&#39;</span><span class="p">:</span> <span class="n">uplo</span><span class="p">,</span> <span class="s1">&#39;jobz&#39;</span><span class="p">:</span> <span class="n">_job</span><span class="p">})</span>

        <span class="n">w</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="o">*</span><span class="n">other_args</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">drv</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">a1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">b1</span><span class="p">,</span> <span class="o">**</span><span class="n">drv_args</span><span class="p">,</span> <span class="o">**</span><span class="n">lwork_args</span><span class="p">)</span>

    <span class="c1"># m is always the first extra argument</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">w</span><span class="p">[:</span><span class="n">other_args</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="k">if</span> <span class="n">subset</span> <span class="k">else</span> <span class="n">w</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">v</span><span class="p">[:,</span> <span class="p">:</span><span class="n">other_args</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="k">if</span> <span class="p">(</span><span class="n">subset</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">eigvals_only</span><span class="p">)</span> <span class="k">else</span> <span class="n">v</span>

    <span class="c1"># Check if we had a  successful exit</span>
    <span class="k">if</span> <span class="n">info</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">eigvals_only</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">w</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">w</span><span class="p">,</span> <span class="n">v</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">info</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">LinAlgError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Illegal value in argument </span><span class="si">{</span><span class="o">-</span><span class="n">info</span><span class="si">}</span><span class="s1"> of internal &#39;</span>
                              <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">drv</span><span class="o">.</span><span class="n">typecode</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">pfx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">driver</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">info</span> <span class="o">&gt;</span> <span class="n">n</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">LinAlgError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The leading minor of order </span><span class="si">{</span><span class="n">info</span><span class="o">-</span><span class="n">n</span><span class="si">}</span><span class="s1"> of B is not &#39;</span>
                              <span class="s1">&#39;positive definite. The factorization of B &#39;</span>
                              <span class="s1">&#39;could not be completed and no eigenvalues &#39;</span>
                              <span class="s1">&#39;or eigenvectors were computed.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">drv_err</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ev&#39;</span><span class="p">:</span> <span class="s1">&#39;The algorithm failed to converge; </span><span class="si">{}</span><span class="s1"> &#39;</span>
                             <span class="s1">&#39;off-diagonal elements of an intermediate &#39;</span>
                             <span class="s1">&#39;tridiagonal form did not converge to zero.&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;evx&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> eigenvectors failed to converge.&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;evd&#39;</span><span class="p">:</span> <span class="s1">&#39;The algorithm failed to compute an eigenvalue &#39;</span>
                              <span class="s1">&#39;while working on the submatrix lying in rows &#39;</span>
                              <span class="s1">&#39;and columns </span><span class="si">{0}</span><span class="s1">/</span><span class="si">{1}</span><span class="s1"> through mod(</span><span class="si">{0}</span><span class="s1">,</span><span class="si">{1}</span><span class="s1">).&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;evr&#39;</span><span class="p">:</span> <span class="s1">&#39;Internal Error.&#39;</span>
                       <span class="p">}</span>
            <span class="k">if</span> <span class="n">driver</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ev&#39;</span><span class="p">,</span> <span class="s1">&#39;gv&#39;</span><span class="p">]:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="n">drv_err</span><span class="p">[</span><span class="s1">&#39;ev&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">info</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">driver</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;evx&#39;</span><span class="p">,</span> <span class="s1">&#39;gvx&#39;</span><span class="p">]:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="n">drv_err</span><span class="p">[</span><span class="s1">&#39;evx&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">info</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">driver</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;evd&#39;</span><span class="p">,</span> <span class="s1">&#39;gvd&#39;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">eigvals_only</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="n">drv_err</span><span class="p">[</span><span class="s1">&#39;ev&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">info</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="n">drv_err</span><span class="p">[</span><span class="s1">&#39;evd&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="n">drv_err</span><span class="p">[</span><span class="s1">&#39;evr&#39;</span><span class="p">]</span>

            <span class="k">raise</span> <span class="n">LinAlgError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>


<span class="n">_conv_dict</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
              <span class="s1">&#39;all&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
              <span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;i&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_check_select</span><span class="p">(</span><span class="n">select</span><span class="p">,</span> <span class="n">select_range</span><span class="p">,</span> <span class="n">max_ev</span><span class="p">,</span> <span class="n">max_len</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check that select is valid, convert to Fortran style.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">select</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">select</span> <span class="o">=</span> <span class="n">select</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">select</span> <span class="o">=</span> <span class="n">_conv_dict</span><span class="p">[</span><span class="n">select</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;invalid argument for select&#39;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>
    <span class="n">vl</span><span class="p">,</span> <span class="n">vu</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span>
    <span class="n">il</span> <span class="o">=</span> <span class="n">iu</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">select</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># (non-all)</span>
        <span class="n">sr</span> <span class="o">=</span> <span class="n">asarray</span><span class="p">(</span><span class="n">select_range</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sr</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">sr</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">sr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">sr</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;select_range must be a 2-element array-like &#39;</span>
                             <span class="s1">&#39;in nondecreasing order&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">select</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># (value)</span>
            <span class="n">vl</span><span class="p">,</span> <span class="n">vu</span> <span class="o">=</span> <span class="n">sr</span>
            <span class="k">if</span> <span class="n">max_ev</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">max_ev</span> <span class="o">=</span> <span class="n">max_len</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># 2 (index)</span>
            <span class="k">if</span> <span class="n">sr</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="s1">&#39;hilqp&#39;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s1">&#39;when using select=&quot;i&quot;, select_range must &#39;</span>
                    <span class="sa">f</span><span class="s1">&#39;contain integers, got dtype </span><span class="si">{</span><span class="n">sr</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><span class="n">sr</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">char</span><span class="si">}</span><span class="s1">)&#39;</span>
                <span class="p">)</span>
            <span class="c1"># translate Python (0 ... N-1) into Fortran (1 ... N) with + 1</span>
            <span class="n">il</span><span class="p">,</span> <span class="n">iu</span> <span class="o">=</span> <span class="n">sr</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="nb">min</span><span class="p">(</span><span class="n">il</span><span class="p">,</span> <span class="n">iu</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">max</span><span class="p">(</span><span class="n">il</span><span class="p">,</span> <span class="n">iu</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_len</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;select_range out of bounds&#39;</span><span class="p">)</span>
            <span class="n">max_ev</span> <span class="o">=</span> <span class="n">iu</span> <span class="o">-</span> <span class="n">il</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">select</span><span class="p">,</span> <span class="n">vl</span><span class="p">,</span> <span class="n">vu</span><span class="p">,</span> <span class="n">il</span><span class="p">,</span> <span class="n">iu</span><span class="p">,</span> <span class="n">max_ev</span>


<span class="k">def</span><span class="w"> </span><span class="nf">eig_banded</span><span class="p">(</span><span class="n">a_band</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">eigvals_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">overwrite_a_band</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
               <span class="n">select</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">select_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_ev</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">check_finite</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Solve real symmetric or complex Hermitian band matrix eigenvalue problem.</span>

<span class="sd">    Find eigenvalues w and optionally right eigenvectors v of a::</span>

<span class="sd">        a v[:,i] = w[i] v[:,i]</span>
<span class="sd">        v.H v    = identity</span>

<span class="sd">    The matrix a is stored in a_band either in lower diagonal or upper</span>
<span class="sd">    diagonal ordered form:</span>

<span class="sd">        a_band[u + i - j, j] == a[i,j]        (if upper form; i &lt;= j)</span>
<span class="sd">        a_band[    i - j, j] == a[i,j]        (if lower form; i &gt;= j)</span>

<span class="sd">    where u is the number of bands above the diagonal.</span>

<span class="sd">    Example of a_band (shape of a is (6,6), u=2)::</span>

<span class="sd">        upper form:</span>
<span class="sd">        *   *   a02 a13 a24 a35</span>
<span class="sd">        *   a01 a12 a23 a34 a45</span>
<span class="sd">        a00 a11 a22 a33 a44 a55</span>

<span class="sd">        lower form:</span>
<span class="sd">        a00 a11 a22 a33 a44 a55</span>
<span class="sd">        a10 a21 a32 a43 a54 *</span>
<span class="sd">        a20 a31 a42 a53 *   *</span>

<span class="sd">    Cells marked with * are not used.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a_band : (u+1, M) array_like</span>
<span class="sd">        The bands of the M by M matrix a.</span>
<span class="sd">    lower : bool, optional</span>
<span class="sd">        Is the matrix in the lower form. (Default is upper form)</span>
<span class="sd">    eigvals_only : bool, optional</span>
<span class="sd">        Compute only the eigenvalues and no eigenvectors.</span>
<span class="sd">        (Default: calculate also eigenvectors)</span>
<span class="sd">    overwrite_a_band : bool, optional</span>
<span class="sd">        Discard data in a_band (may enhance performance)</span>
<span class="sd">    select : {&#39;a&#39;, &#39;v&#39;, &#39;i&#39;}, optional</span>
<span class="sd">        Which eigenvalues to calculate</span>

<span class="sd">        ======  ========================================</span>
<span class="sd">        select  calculated</span>
<span class="sd">        ======  ========================================</span>
<span class="sd">        &#39;a&#39;     All eigenvalues</span>
<span class="sd">        &#39;v&#39;     Eigenvalues in the interval (min, max]</span>
<span class="sd">        &#39;i&#39;     Eigenvalues with indices min &lt;= i &lt;= max</span>
<span class="sd">        ======  ========================================</span>
<span class="sd">    select_range : (min, max), optional</span>
<span class="sd">        Range of selected eigenvalues</span>
<span class="sd">    max_ev : int, optional</span>
<span class="sd">        For select==&#39;v&#39;, maximum number of eigenvalues expected.</span>
<span class="sd">        For other values of select, has no meaning.</span>

<span class="sd">        In doubt, leave this parameter untouched.</span>

<span class="sd">    check_finite : bool, optional</span>
<span class="sd">        Whether to check that the input matrix contains only finite numbers.</span>
<span class="sd">        Disabling may give a performance gain, but may result in problems</span>
<span class="sd">        (crashes, non-termination) if the inputs do contain infinities or NaNs.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    w : (M,) ndarray</span>
<span class="sd">        The eigenvalues, in ascending order, each repeated according to its</span>
<span class="sd">        multiplicity.</span>
<span class="sd">    v : (M, M) float or complex ndarray</span>
<span class="sd">        The normalized eigenvector corresponding to the eigenvalue w[i] is</span>
<span class="sd">        the column v[:,i]. Only returned if ``eigvals_only=False``.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    LinAlgError</span>
<span class="sd">        If eigenvalue computation does not converge.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    eigvals_banded : eigenvalues for symmetric/Hermitian band matrices</span>
<span class="sd">    eig : eigenvalues and right eigenvectors of general arrays.</span>
<span class="sd">    eigh : eigenvalues and right eigenvectors for symmetric/Hermitian arrays</span>
<span class="sd">    eigh_tridiagonal : eigenvalues and right eigenvectors for</span>
<span class="sd">        symmetric/Hermitian tridiagonal matrices</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import numpy as np</span>
<span class="sd">    &gt;&gt;&gt; from scipy.linalg import eig_banded</span>
<span class="sd">    &gt;&gt;&gt; A = np.array([[1, 5, 2, 0], [5, 2, 5, 2], [2, 5, 3, 5], [0, 2, 5, 4]])</span>
<span class="sd">    &gt;&gt;&gt; Ab = np.array([[1, 2, 3, 4], [5, 5, 5, 0], [2, 2, 0, 0]])</span>
<span class="sd">    &gt;&gt;&gt; w, v = eig_banded(Ab, lower=True)</span>
<span class="sd">    &gt;&gt;&gt; np.allclose(A @ v - v @ np.diag(w), np.zeros((4, 4)))</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; w = eig_banded(Ab, lower=True, eigvals_only=True)</span>
<span class="sd">    &gt;&gt;&gt; w</span>
<span class="sd">    array([-4.26200532, -2.22987175,  3.95222349, 12.53965359])</span>

<span class="sd">    Request only the eigenvalues between ``[-3, 4]``</span>

<span class="sd">    &gt;&gt;&gt; w, v = eig_banded(Ab, lower=True, select=&#39;v&#39;, select_range=[-3, 4])</span>
<span class="sd">    &gt;&gt;&gt; w</span>
<span class="sd">    array([-2.22987175,  3.95222349])</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">eigvals_only</span> <span class="ow">or</span> <span class="n">overwrite_a_band</span><span class="p">:</span>
        <span class="n">a1</span> <span class="o">=</span> <span class="n">_asarray_validated</span><span class="p">(</span><span class="n">a_band</span><span class="p">,</span> <span class="n">check_finite</span><span class="o">=</span><span class="n">check_finite</span><span class="p">)</span>
        <span class="n">overwrite_a_band</span> <span class="o">=</span> <span class="n">overwrite_a_band</span> <span class="ow">or</span> <span class="p">(</span><span class="n">_datacopied</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a_band</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">a1</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">a_band</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">a1</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">inexact</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">isfinite</span><span class="p">(</span><span class="n">a1</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;array must not contain infs or NaNs&quot;</span><span class="p">)</span>
        <span class="n">overwrite_a_band</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">a1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;expected a 2-D array&#39;</span><span class="p">)</span>

    <span class="c1"># accommodate square empty matrices</span>
    <span class="k">if</span> <span class="n">a1</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">w_n</span><span class="p">,</span> <span class="n">v_n</span> <span class="o">=</span> <span class="n">eig_banded</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">a1</span><span class="o">.</span><span class="n">dtype</span><span class="p">))</span>

        <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">w_n</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">v_n</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">eigvals_only</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">w</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">w</span><span class="p">,</span> <span class="n">v</span>

    <span class="n">select</span><span class="p">,</span> <span class="n">vl</span><span class="p">,</span> <span class="n">vu</span><span class="p">,</span> <span class="n">il</span><span class="p">,</span> <span class="n">iu</span><span class="p">,</span> <span class="n">max_ev</span> <span class="o">=</span> <span class="n">_check_select</span><span class="p">(</span>
        <span class="n">select</span><span class="p">,</span> <span class="n">select_range</span><span class="p">,</span> <span class="n">max_ev</span><span class="p">,</span> <span class="n">a1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">del</span> <span class="n">select_range</span>
    <span class="k">if</span> <span class="n">select</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">a1</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">char</span> <span class="ow">in</span> <span class="s1">&#39;GFD&#39;</span><span class="p">:</span>
            <span class="c1"># FIXME: implement this somewhen, for now go with builtin values</span>
            <span class="c1"># FIXME: calc optimal lwork by calling ?hbevd(lwork=-1)</span>
            <span class="c1">#        or by using calc_lwork.f ???</span>
            <span class="c1"># lwork = calc_lwork.hbevd(bevd.typecode, a1.shape[0], lower)</span>
            <span class="n">internal_name</span> <span class="o">=</span> <span class="s1">&#39;hbevd&#39;</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># a1.dtype.char in &#39;fd&#39;:</span>
            <span class="c1"># FIXME: implement this somewhen, for now go with builtin values</span>
            <span class="c1">#         see above</span>
            <span class="c1"># lwork = calc_lwork.sbevd(bevd.typecode, a1.shape[0], lower)</span>
            <span class="n">internal_name</span> <span class="o">=</span> <span class="s1">&#39;sbevd&#39;</span>
        <span class="n">bevd</span><span class="p">,</span> <span class="o">=</span> <span class="n">get_lapack_funcs</span><span class="p">((</span><span class="n">internal_name</span><span class="p">,),</span> <span class="p">(</span><span class="n">a1</span><span class="p">,))</span>
        <span class="n">w</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">bevd</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">compute_v</span><span class="o">=</span><span class="ow">not</span> <span class="n">eigvals_only</span><span class="p">,</span>
                          <span class="n">lower</span><span class="o">=</span><span class="n">lower</span><span class="p">,</span> <span class="n">overwrite_ab</span><span class="o">=</span><span class="n">overwrite_a_band</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># select in [1, 2]</span>
        <span class="k">if</span> <span class="n">eigvals_only</span><span class="p">:</span>
            <span class="n">max_ev</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="c1"># calculate optimal abstol for dsbevx (see manpage)</span>
        <span class="k">if</span> <span class="n">a1</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">char</span> <span class="ow">in</span> <span class="s1">&#39;fF&#39;</span><span class="p">:</span>  <span class="c1"># single precision</span>
            <span class="n">lamch</span><span class="p">,</span> <span class="o">=</span> <span class="n">get_lapack_funcs</span><span class="p">((</span><span class="s1">&#39;lamch&#39;</span><span class="p">,),</span> <span class="p">(</span><span class="n">array</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;f&#39;</span><span class="p">),))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lamch</span><span class="p">,</span> <span class="o">=</span> <span class="n">get_lapack_funcs</span><span class="p">((</span><span class="s1">&#39;lamch&#39;</span><span class="p">,),</span> <span class="p">(</span><span class="n">array</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">),))</span>
        <span class="n">abstol</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lamch</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">a1</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">char</span> <span class="ow">in</span> <span class="s1">&#39;GFD&#39;</span><span class="p">:</span>
            <span class="n">internal_name</span> <span class="o">=</span> <span class="s1">&#39;hbevx&#39;</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># a1.dtype.char in &#39;gfd&#39;</span>
            <span class="n">internal_name</span> <span class="o">=</span> <span class="s1">&#39;sbevx&#39;</span>
        <span class="n">bevx</span><span class="p">,</span> <span class="o">=</span> <span class="n">get_lapack_funcs</span><span class="p">((</span><span class="n">internal_name</span><span class="p">,),</span> <span class="p">(</span><span class="n">a1</span><span class="p">,))</span>
        <span class="n">w</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">ifail</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">bevx</span><span class="p">(</span>
            <span class="n">a1</span><span class="p">,</span> <span class="n">vl</span><span class="p">,</span> <span class="n">vu</span><span class="p">,</span> <span class="n">il</span><span class="p">,</span> <span class="n">iu</span><span class="p">,</span> <span class="n">compute_v</span><span class="o">=</span><span class="ow">not</span> <span class="n">eigvals_only</span><span class="p">,</span> <span class="n">mmax</span><span class="o">=</span><span class="n">max_ev</span><span class="p">,</span>
            <span class="nb">range</span><span class="o">=</span><span class="n">select</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="n">lower</span><span class="p">,</span> <span class="n">overwrite_ab</span><span class="o">=</span><span class="n">overwrite_a_band</span><span class="p">,</span>
            <span class="n">abstol</span><span class="o">=</span><span class="n">abstol</span><span class="p">)</span>
        <span class="c1"># crop off w and v</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">w</span><span class="p">[:</span><span class="n">m</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">eigvals_only</span><span class="p">:</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">v</span><span class="p">[:,</span> <span class="p">:</span><span class="n">m</span><span class="p">]</span>
    <span class="n">_check_info</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">internal_name</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">eigvals_only</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">w</span>
    <span class="k">return</span> <span class="n">w</span><span class="p">,</span> <span class="n">v</span>


<div class="viewcode-block" id="eigvals">
<a class="viewcode-back" href="../../../_autosummary/egttools.utils.eigvals.html#egttools.analytical.sed_analytical.eigvals">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">eigvals</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overwrite_a</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">check_finite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">homogeneous_eigvals</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute eigenvalues from an ordinary or generalized eigenvalue problem.</span>

<span class="sd">    Find eigenvalues of a general matrix::</span>

<span class="sd">        a   vr[:,i] = w[i]        b   vr[:,i]</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : (M, M) array_like</span>
<span class="sd">        A complex or real matrix whose eigenvalues and eigenvectors</span>
<span class="sd">        will be computed.</span>
<span class="sd">    b : (M, M) array_like, optional</span>
<span class="sd">        Right-hand side matrix in a generalized eigenvalue problem.</span>
<span class="sd">        If omitted, identity matrix is assumed.</span>
<span class="sd">    overwrite_a : bool, optional</span>
<span class="sd">        Whether to overwrite data in a (may improve performance)</span>
<span class="sd">    check_finite : bool, optional</span>
<span class="sd">        Whether to check that the input matrices contain only finite numbers.</span>
<span class="sd">        Disabling may give a performance gain, but may result in problems</span>
<span class="sd">        (crashes, non-termination) if the inputs do contain infinities</span>
<span class="sd">        or NaNs.</span>
<span class="sd">    homogeneous_eigvals : bool, optional</span>
<span class="sd">        If True, return the eigenvalues in homogeneous coordinates.</span>
<span class="sd">        In this case ``w`` is a (2, M) array so that::</span>

<span class="sd">            w[1,i] a vr[:,i] = w[0,i] b vr[:,i]</span>

<span class="sd">        Default is False.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    w : (M,) or (2, M) double or complex ndarray</span>
<span class="sd">        The eigenvalues, each repeated according to its multiplicity</span>
<span class="sd">        but not in any specific order. The shape is (M,) unless</span>
<span class="sd">        ``homogeneous_eigvals=True``.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    LinAlgError</span>
<span class="sd">        If eigenvalue computation does not converge</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    eig : eigenvalues and right eigenvectors of general arrays.</span>
<span class="sd">    eigvalsh : eigenvalues of symmetric or Hermitian arrays</span>
<span class="sd">    eigvals_banded : eigenvalues for symmetric/Hermitian band matrices</span>
<span class="sd">    eigvalsh_tridiagonal : eigenvalues of symmetric/Hermitian tridiagonal</span>
<span class="sd">        matrices</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import numpy as np</span>
<span class="sd">    &gt;&gt;&gt; from scipy import linalg</span>
<span class="sd">    &gt;&gt;&gt; a = np.array([[0., -1.], [1., 0.]])</span>
<span class="sd">    &gt;&gt;&gt; linalg.eigvals(a)</span>
<span class="sd">    array([0.+1.j, 0.-1.j])</span>

<span class="sd">    &gt;&gt;&gt; b = np.array([[0., 1.], [1., 1.]])</span>
<span class="sd">    &gt;&gt;&gt; linalg.eigvals(a, b)</span>
<span class="sd">    array([ 1.+0.j, -1.+0.j])</span>

<span class="sd">    &gt;&gt;&gt; a = np.array([[3., 0., 0.], [0., 8., 0.], [0., 0., 7.]])</span>
<span class="sd">    &gt;&gt;&gt; linalg.eigvals(a, homogeneous_eigvals=True)</span>
<span class="sd">    array([[3.+0.j, 8.+0.j, 7.+0.j],</span>
<span class="sd">           [1.+0.j, 1.+0.j, 1.+0.j]])</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">eig</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">b</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">overwrite_a</span><span class="o">=</span><span class="n">overwrite_a</span><span class="p">,</span>
               <span class="n">check_finite</span><span class="o">=</span><span class="n">check_finite</span><span class="p">,</span>
               <span class="n">homogeneous_eigvals</span><span class="o">=</span><span class="n">homogeneous_eigvals</span><span class="p">)</span></div>



<span class="k">def</span><span class="w"> </span><span class="nf">eigvalsh</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">overwrite_a</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
             <span class="n">overwrite_b</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">check_finite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">subset_by_index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">subset_by_value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Solves a standard or generalized eigenvalue problem for a complex</span>
<span class="sd">    Hermitian or real symmetric matrix.</span>

<span class="sd">    Find eigenvalues array ``w`` of array ``a``, where ``b`` is positive</span>
<span class="sd">    definite such that for every eigenvalue λ (i-th entry of w) and its</span>
<span class="sd">    eigenvector vi (i-th column of v) satisfies::</span>

<span class="sd">                      a @ vi = λ * b @ vi</span>
<span class="sd">        vi.conj().T @ a @ vi = λ</span>
<span class="sd">        vi.conj().T @ b @ vi = 1</span>

<span class="sd">    In the standard problem, b is assumed to be the identity matrix.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : (M, M) array_like</span>
<span class="sd">        A complex Hermitian or real symmetric matrix whose eigenvalues will</span>
<span class="sd">        be computed.</span>
<span class="sd">    b : (M, M) array_like, optional</span>
<span class="sd">        A complex Hermitian or real symmetric definite positive matrix in.</span>
<span class="sd">        If omitted, identity matrix is assumed.</span>
<span class="sd">    lower : bool, optional</span>
<span class="sd">        Whether the pertinent array data is taken from the lower or upper</span>
<span class="sd">        triangle of ``a`` and, if applicable, ``b``. (Default: lower)</span>
<span class="sd">    overwrite_a : bool, optional</span>
<span class="sd">        Whether to overwrite data in ``a`` (may improve performance). Default</span>
<span class="sd">        is False.</span>
<span class="sd">    overwrite_b : bool, optional</span>
<span class="sd">        Whether to overwrite data in ``b`` (may improve performance). Default</span>
<span class="sd">        is False.</span>
<span class="sd">    type : int, optional</span>
<span class="sd">        For the generalized problems, this keyword specifies the problem type</span>
<span class="sd">        to be solved for ``w`` and ``v`` (only takes 1, 2, 3 as possible</span>
<span class="sd">        inputs)::</span>

<span class="sd">            1 =&gt;     a @ v = w @ b @ v</span>
<span class="sd">            2 =&gt; a @ b @ v = w @ v</span>
<span class="sd">            3 =&gt; b @ a @ v = w @ v</span>

<span class="sd">        This keyword is ignored for standard problems.</span>
<span class="sd">    check_finite : bool, optional</span>
<span class="sd">        Whether to check that the input matrices contain only finite numbers.</span>
<span class="sd">        Disabling may give a performance gain, but may result in problems</span>
<span class="sd">        (crashes, non-termination) if the inputs do contain infinities or NaNs.</span>
<span class="sd">    subset_by_index : iterable, optional</span>
<span class="sd">        If provided, this two-element iterable defines the start and the end</span>
<span class="sd">        indices of the desired eigenvalues (ascending order and 0-indexed).</span>
<span class="sd">        To return only the second smallest to fifth smallest eigenvalues,</span>
<span class="sd">        ``[1, 4]`` is used. ``[n-3, n-1]`` returns the largest three. Only</span>
<span class="sd">        available with &quot;evr&quot;, &quot;evx&quot;, and &quot;gvx&quot; drivers. The entries are</span>
<span class="sd">        directly converted to integers via ``int()``.</span>
<span class="sd">    subset_by_value : iterable, optional</span>
<span class="sd">        If provided, this two-element iterable defines the half-open interval</span>
<span class="sd">        ``(a, b]`` that, if any, only the eigenvalues between these values</span>
<span class="sd">        are returned. Only available with &quot;evr&quot;, &quot;evx&quot;, and &quot;gvx&quot; drivers. Use</span>
<span class="sd">        ``np.inf`` for the unconstrained ends.</span>
<span class="sd">    driver : str, optional</span>
<span class="sd">        Defines which LAPACK driver should be used. Valid options are &quot;ev&quot;,</span>
<span class="sd">        &quot;evd&quot;, &quot;evr&quot;, &quot;evx&quot; for standard problems and &quot;gv&quot;, &quot;gvd&quot;, &quot;gvx&quot; for</span>
<span class="sd">        generalized (where b is not None) problems. See the Notes section of</span>
<span class="sd">        `scipy.linalg.eigh`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    w : (N,) ndarray</span>
<span class="sd">        The N (N&lt;=M) selected eigenvalues, in ascending order, each</span>
<span class="sd">        repeated according to its multiplicity.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    LinAlgError</span>
<span class="sd">        If eigenvalue computation does not converge, an error occurred, or</span>
<span class="sd">        b matrix is not definite positive. Note that if input matrices are</span>
<span class="sd">        not symmetric or Hermitian, no error will be reported but results will</span>
<span class="sd">        be wrong.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    eigh : eigenvalues and right eigenvectors for symmetric/Hermitian arrays</span>
<span class="sd">    eigvals : eigenvalues of general arrays</span>
<span class="sd">    eigvals_banded : eigenvalues for symmetric/Hermitian band matrices</span>
<span class="sd">    eigvalsh_tridiagonal : eigenvalues of symmetric/Hermitian tridiagonal</span>
<span class="sd">        matrices</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    This function does not check the input array for being Hermitian/symmetric</span>
<span class="sd">    in order to allow for representing arrays with only their upper/lower</span>
<span class="sd">    triangular parts.</span>

<span class="sd">    This function serves as a one-liner shorthand for `scipy.linalg.eigh` with</span>
<span class="sd">    the option ``eigvals_only=True`` to get the eigenvalues and not the</span>
<span class="sd">    eigenvectors. Here it is kept as a legacy convenience. It might be</span>
<span class="sd">    beneficial to use the main function to have full control and to be a bit</span>
<span class="sd">    more pythonic.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    For more examples see `scipy.linalg.eigh`.</span>

<span class="sd">    &gt;&gt;&gt; import numpy as np</span>
<span class="sd">    &gt;&gt;&gt; from scipy.linalg import eigvalsh</span>
<span class="sd">    &gt;&gt;&gt; A = np.array([[6, 3, 1, 5], [3, 0, 5, 1], [1, 5, 6, 2], [5, 1, 2, 2]])</span>
<span class="sd">    &gt;&gt;&gt; w = eigvalsh(A)</span>
<span class="sd">    &gt;&gt;&gt; w</span>
<span class="sd">    array([-3.74637491, -0.76263923,  6.08502336, 12.42399079])</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">eigh</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">b</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="n">lower</span><span class="p">,</span> <span class="n">eigvals_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">overwrite_a</span><span class="o">=</span><span class="n">overwrite_a</span><span class="p">,</span>
                <span class="n">overwrite_b</span><span class="o">=</span><span class="n">overwrite_b</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">type</span><span class="p">,</span> <span class="n">check_finite</span><span class="o">=</span><span class="n">check_finite</span><span class="p">,</span>
                <span class="n">subset_by_index</span><span class="o">=</span><span class="n">subset_by_index</span><span class="p">,</span> <span class="n">subset_by_value</span><span class="o">=</span><span class="n">subset_by_value</span><span class="p">,</span>
                <span class="n">driver</span><span class="o">=</span><span class="n">driver</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">eigvals_banded</span><span class="p">(</span><span class="n">a_band</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">overwrite_a_band</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                   <span class="n">select</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">select_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">check_finite</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Solve real symmetric or complex Hermitian band matrix eigenvalue problem.</span>

<span class="sd">    Find eigenvalues w of a::</span>

<span class="sd">        a v[:,i] = w[i] v[:,i]</span>
<span class="sd">        v.H v    = identity</span>

<span class="sd">    The matrix a is stored in a_band either in lower diagonal or upper</span>
<span class="sd">    diagonal ordered form:</span>

<span class="sd">        a_band[u + i - j, j] == a[i,j]        (if upper form; i &lt;= j)</span>
<span class="sd">        a_band[    i - j, j] == a[i,j]        (if lower form; i &gt;= j)</span>

<span class="sd">    where u is the number of bands above the diagonal.</span>

<span class="sd">    Example of a_band (shape of a is (6,6), u=2)::</span>

<span class="sd">        upper form:</span>
<span class="sd">        *   *   a02 a13 a24 a35</span>
<span class="sd">        *   a01 a12 a23 a34 a45</span>
<span class="sd">        a00 a11 a22 a33 a44 a55</span>

<span class="sd">        lower form:</span>
<span class="sd">        a00 a11 a22 a33 a44 a55</span>
<span class="sd">        a10 a21 a32 a43 a54 *</span>
<span class="sd">        a20 a31 a42 a53 *   *</span>

<span class="sd">    Cells marked with * are not used.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a_band : (u+1, M) array_like</span>
<span class="sd">        The bands of the M by M matrix a.</span>
<span class="sd">    lower : bool, optional</span>
<span class="sd">        Is the matrix in the lower form. (Default is upper form)</span>
<span class="sd">    overwrite_a_band : bool, optional</span>
<span class="sd">        Discard data in a_band (may enhance performance)</span>
<span class="sd">    select : {&#39;a&#39;, &#39;v&#39;, &#39;i&#39;}, optional</span>
<span class="sd">        Which eigenvalues to calculate</span>

<span class="sd">        ======  ========================================</span>
<span class="sd">        select  calculated</span>
<span class="sd">        ======  ========================================</span>
<span class="sd">        &#39;a&#39;     All eigenvalues</span>
<span class="sd">        &#39;v&#39;     Eigenvalues in the interval (min, max]</span>
<span class="sd">        &#39;i&#39;     Eigenvalues with indices min &lt;= i &lt;= max</span>
<span class="sd">        ======  ========================================</span>
<span class="sd">    select_range : (min, max), optional</span>
<span class="sd">        Range of selected eigenvalues</span>
<span class="sd">    check_finite : bool, optional</span>
<span class="sd">        Whether to check that the input matrix contains only finite numbers.</span>
<span class="sd">        Disabling may give a performance gain, but may result in problems</span>
<span class="sd">        (crashes, non-termination) if the inputs do contain infinities or NaNs.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    w : (M,) ndarray</span>
<span class="sd">        The eigenvalues, in ascending order, each repeated according to its</span>
<span class="sd">        multiplicity.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    LinAlgError</span>
<span class="sd">        If eigenvalue computation does not converge.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    eig_banded : eigenvalues and right eigenvectors for symmetric/Hermitian</span>
<span class="sd">        band matrices</span>
<span class="sd">    eigvalsh_tridiagonal : eigenvalues of symmetric/Hermitian tridiagonal</span>
<span class="sd">        matrices</span>
<span class="sd">    eigvals : eigenvalues of general arrays</span>
<span class="sd">    eigh : eigenvalues and right eigenvectors for symmetric/Hermitian arrays</span>
<span class="sd">    eig : eigenvalues and right eigenvectors for non-symmetric arrays</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import numpy as np</span>
<span class="sd">    &gt;&gt;&gt; from scipy.linalg import eigvals_banded</span>
<span class="sd">    &gt;&gt;&gt; A = np.array([[1, 5, 2, 0], [5, 2, 5, 2], [2, 5, 3, 5], [0, 2, 5, 4]])</span>
<span class="sd">    &gt;&gt;&gt; Ab = np.array([[1, 2, 3, 4], [5, 5, 5, 0], [2, 2, 0, 0]])</span>
<span class="sd">    &gt;&gt;&gt; w = eigvals_banded(Ab, lower=True)</span>
<span class="sd">    &gt;&gt;&gt; w</span>
<span class="sd">    array([-4.26200532, -2.22987175,  3.95222349, 12.53965359])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">eig_banded</span><span class="p">(</span><span class="n">a_band</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="n">lower</span><span class="p">,</span> <span class="n">eigvals_only</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                      <span class="n">overwrite_a_band</span><span class="o">=</span><span class="n">overwrite_a_band</span><span class="p">,</span> <span class="n">select</span><span class="o">=</span><span class="n">select</span><span class="p">,</span>
                      <span class="n">select_range</span><span class="o">=</span><span class="n">select_range</span><span class="p">,</span> <span class="n">check_finite</span><span class="o">=</span><span class="n">check_finite</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">eigvalsh_tridiagonal</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">select</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">select_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                         <span class="n">check_finite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">lapack_driver</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Solve eigenvalue problem for a real symmetric tridiagonal matrix.</span>

<span class="sd">    Find eigenvalues `w` of ``a``::</span>

<span class="sd">        a v[:,i] = w[i] v[:,i]</span>
<span class="sd">        v.H v    = identity</span>

<span class="sd">    For a real symmetric matrix ``a`` with diagonal elements `d` and</span>
<span class="sd">    off-diagonal elements `e`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    d : ndarray, shape (ndim,)</span>
<span class="sd">        The diagonal elements of the array.</span>
<span class="sd">    e : ndarray, shape (ndim-1,)</span>
<span class="sd">        The off-diagonal elements of the array.</span>
<span class="sd">    select : {&#39;a&#39;, &#39;v&#39;, &#39;i&#39;}, optional</span>
<span class="sd">        Which eigenvalues to calculate</span>

<span class="sd">        ======  ========================================</span>
<span class="sd">        select  calculated</span>
<span class="sd">        ======  ========================================</span>
<span class="sd">        &#39;a&#39;     All eigenvalues</span>
<span class="sd">        &#39;v&#39;     Eigenvalues in the interval (min, max]</span>
<span class="sd">        &#39;i&#39;     Eigenvalues with indices min &lt;= i &lt;= max</span>
<span class="sd">        ======  ========================================</span>
<span class="sd">    select_range : (min, max), optional</span>
<span class="sd">        Range of selected eigenvalues</span>
<span class="sd">    check_finite : bool, optional</span>
<span class="sd">        Whether to check that the input matrix contains only finite numbers.</span>
<span class="sd">        Disabling may give a performance gain, but may result in problems</span>
<span class="sd">        (crashes, non-termination) if the inputs do contain infinities or NaNs.</span>
<span class="sd">    tol : float</span>
<span class="sd">        The absolute tolerance to which each eigenvalue is required</span>
<span class="sd">        (only used when ``lapack_driver=&#39;stebz&#39;``).</span>
<span class="sd">        An eigenvalue (or cluster) is considered to have converged if it</span>
<span class="sd">        lies in an interval of this width. If &lt;= 0. (default),</span>
<span class="sd">        the value ``eps*|a|`` is used where eps is the machine precision,</span>
<span class="sd">        and ``|a|`` is the 1-norm of the matrix ``a``.</span>
<span class="sd">    lapack_driver : str</span>
<span class="sd">        LAPACK function to use, can be &#39;auto&#39;, &#39;stemr&#39;, &#39;stebz&#39;,  &#39;sterf&#39;,</span>
<span class="sd">        or &#39;stev&#39;. When &#39;auto&#39; (default), it will use &#39;stemr&#39; if ``select=&#39;a&#39;``</span>
<span class="sd">        and &#39;stebz&#39; otherwise. &#39;sterf&#39; and &#39;stev&#39; can only be used when</span>
<span class="sd">        ``select=&#39;a&#39;``.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    w : (M,) ndarray</span>
<span class="sd">        The eigenvalues, in ascending order, each repeated according to its</span>
<span class="sd">        multiplicity.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    LinAlgError</span>
<span class="sd">        If eigenvalue computation does not converge.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    eigh_tridiagonal : eigenvalues and right eiegenvectors for</span>
<span class="sd">        symmetric/Hermitian tridiagonal matrices</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import numpy as np</span>
<span class="sd">    &gt;&gt;&gt; from scipy.linalg import eigvalsh_tridiagonal, eigvalsh</span>
<span class="sd">    &gt;&gt;&gt; d = 3*np.ones(4)</span>
<span class="sd">    &gt;&gt;&gt; e = -1*np.ones(3)</span>
<span class="sd">    &gt;&gt;&gt; w = eigvalsh_tridiagonal(d, e)</span>
<span class="sd">    &gt;&gt;&gt; A = np.diag(d) + np.diag(e, k=1) + np.diag(e, k=-1)</span>
<span class="sd">    &gt;&gt;&gt; w2 = eigvalsh(A)  # Verify with other eigenvalue routines</span>
<span class="sd">    &gt;&gt;&gt; np.allclose(w - w2, np.zeros(4))</span>
<span class="sd">    True</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">eigh_tridiagonal</span><span class="p">(</span>
        <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">eigvals_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">select</span><span class="o">=</span><span class="n">select</span><span class="p">,</span> <span class="n">select_range</span><span class="o">=</span><span class="n">select_range</span><span class="p">,</span>
        <span class="n">check_finite</span><span class="o">=</span><span class="n">check_finite</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="n">tol</span><span class="p">,</span> <span class="n">lapack_driver</span><span class="o">=</span><span class="n">lapack_driver</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">eigh_tridiagonal</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">eigvals_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">select</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">select_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">check_finite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">lapack_driver</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Solve eigenvalue problem for a real symmetric tridiagonal matrix.</span>

<span class="sd">    Find eigenvalues `w` and optionally right eigenvectors `v` of ``a``::</span>

<span class="sd">        a v[:,i] = w[i] v[:,i]</span>
<span class="sd">        v.H v    = identity</span>

<span class="sd">    For a real symmetric matrix ``a`` with diagonal elements `d` and</span>
<span class="sd">    off-diagonal elements `e`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    d : ndarray, shape (ndim,)</span>
<span class="sd">        The diagonal elements of the array.</span>
<span class="sd">    e : ndarray, shape (ndim-1,)</span>
<span class="sd">        The off-diagonal elements of the array.</span>
<span class="sd">    eigvals_only : bool, optional</span>
<span class="sd">        Compute only the eigenvalues and no eigenvectors.</span>
<span class="sd">        (Default: calculate also eigenvectors)</span>
<span class="sd">    select : {&#39;a&#39;, &#39;v&#39;, &#39;i&#39;}, optional</span>
<span class="sd">        Which eigenvalues to calculate</span>

<span class="sd">        ======  ========================================</span>
<span class="sd">        select  calculated</span>
<span class="sd">        ======  ========================================</span>
<span class="sd">        &#39;a&#39;     All eigenvalues</span>
<span class="sd">        &#39;v&#39;     Eigenvalues in the interval (min, max]</span>
<span class="sd">        &#39;i&#39;     Eigenvalues with indices min &lt;= i &lt;= max</span>
<span class="sd">        ======  ========================================</span>
<span class="sd">    select_range : (min, max), optional</span>
<span class="sd">        Range of selected eigenvalues</span>
<span class="sd">    check_finite : bool, optional</span>
<span class="sd">        Whether to check that the input matrix contains only finite numbers.</span>
<span class="sd">        Disabling may give a performance gain, but may result in problems</span>
<span class="sd">        (crashes, non-termination) if the inputs do contain infinities or NaNs.</span>
<span class="sd">    tol : float</span>
<span class="sd">        The absolute tolerance to which each eigenvalue is required</span>
<span class="sd">        (only used when &#39;stebz&#39; is the `lapack_driver`).</span>
<span class="sd">        An eigenvalue (or cluster) is considered to have converged if it</span>
<span class="sd">        lies in an interval of this width. If &lt;= 0. (default),</span>
<span class="sd">        the value ``eps*|a|`` is used where eps is the machine precision,</span>
<span class="sd">        and ``|a|`` is the 1-norm of the matrix ``a``.</span>
<span class="sd">    lapack_driver : str</span>
<span class="sd">        LAPACK function to use, can be &#39;auto&#39;, &#39;stemr&#39;, &#39;stebz&#39;, &#39;sterf&#39;,</span>
<span class="sd">        or &#39;stev&#39;. When &#39;auto&#39; (default), it will use &#39;stemr&#39; if ``select=&#39;a&#39;``</span>
<span class="sd">        and &#39;stebz&#39; otherwise. When &#39;stebz&#39; is used to find the eigenvalues and</span>
<span class="sd">        ``eigvals_only=False``, then a second LAPACK call (to ``?STEIN``) is</span>
<span class="sd">        used to find the corresponding eigenvectors. &#39;sterf&#39; can only be</span>
<span class="sd">        used when ``eigvals_only=True`` and ``select=&#39;a&#39;``. &#39;stev&#39; can only</span>
<span class="sd">        be used when ``select=&#39;a&#39;``.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    w : (M,) ndarray</span>
<span class="sd">        The eigenvalues, in ascending order, each repeated according to its</span>
<span class="sd">        multiplicity.</span>
<span class="sd">    v : (M, M) ndarray</span>
<span class="sd">        The normalized eigenvector corresponding to the eigenvalue ``w[i]`` is</span>
<span class="sd">        the column ``v[:,i]``. Only returned if ``eigvals_only=False``.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    LinAlgError</span>
<span class="sd">        If eigenvalue computation does not converge.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    eigvalsh_tridiagonal : eigenvalues of symmetric/Hermitian tridiagonal</span>
<span class="sd">        matrices</span>
<span class="sd">    eig : eigenvalues and right eigenvectors for non-symmetric arrays</span>
<span class="sd">    eigh : eigenvalues and right eigenvectors for symmetric/Hermitian arrays</span>
<span class="sd">    eig_banded : eigenvalues and right eigenvectors for symmetric/Hermitian</span>
<span class="sd">        band matrices</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    This function makes use of LAPACK ``S/DSTEMR`` routines.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import numpy as np</span>
<span class="sd">    &gt;&gt;&gt; from scipy.linalg import eigh_tridiagonal</span>
<span class="sd">    &gt;&gt;&gt; d = 3*np.ones(4)</span>
<span class="sd">    &gt;&gt;&gt; e = -1*np.ones(3)</span>
<span class="sd">    &gt;&gt;&gt; w, v = eigh_tridiagonal(d, e)</span>
<span class="sd">    &gt;&gt;&gt; A = np.diag(d) + np.diag(e, k=1) + np.diag(e, k=-1)</span>
<span class="sd">    &gt;&gt;&gt; np.allclose(A @ v - v @ np.diag(w), np.zeros((4, 4)))</span>
<span class="sd">    True</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">_asarray_validated</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">check_finite</span><span class="o">=</span><span class="n">check_finite</span><span class="p">)</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">_asarray_validated</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">check_finite</span><span class="o">=</span><span class="n">check_finite</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">check</span> <span class="ow">in</span> <span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">check</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;expected a 1-D array&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">check</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">char</span> <span class="ow">in</span> <span class="s1">&#39;GFD&#39;</span><span class="p">:</span>  <span class="c1"># complex</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Only real arrays currently supported&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">e</span><span class="o">.</span><span class="n">size</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;d (</span><span class="si">{</span><span class="n">d</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s1">) must have one more element than e (</span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
    <span class="n">select</span><span class="p">,</span> <span class="n">vl</span><span class="p">,</span> <span class="n">vu</span><span class="p">,</span> <span class="n">il</span><span class="p">,</span> <span class="n">iu</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">_check_select</span><span class="p">(</span>
        <span class="n">select</span><span class="p">,</span> <span class="n">select_range</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">d</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lapack_driver</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;lapack_driver must be str&#39;</span><span class="p">)</span>
    <span class="n">drivers</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="s1">&#39;stemr&#39;</span><span class="p">,</span> <span class="s1">&#39;sterf&#39;</span><span class="p">,</span> <span class="s1">&#39;stebz&#39;</span><span class="p">,</span> <span class="s1">&#39;stev&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">lapack_driver</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">drivers</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;lapack_driver must be one of </span><span class="si">{</span><span class="n">drivers</span><span class="si">}</span><span class="s1">, &#39;</span>
                         <span class="sa">f</span><span class="s1">&#39;got </span><span class="si">{</span><span class="n">lapack_driver</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">lapack_driver</span> <span class="o">==</span> <span class="s1">&#39;auto&#39;</span><span class="p">:</span>
        <span class="n">lapack_driver</span> <span class="o">=</span> <span class="s1">&#39;stemr&#39;</span> <span class="k">if</span> <span class="n">select</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;stebz&#39;</span>

    <span class="c1"># Quick exit for 1x1 case</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">select</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="p">(</span><span class="n">vl</span> <span class="o">&lt;</span> <span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">vu</span><span class="p">)):</span>  <span class="c1"># request by value</span>
            <span class="n">w</span> <span class="o">=</span> <span class="n">array</span><span class="p">([])</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">empty</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># all and request by index</span>
            <span class="n">w</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">eigvals_only</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">w</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">w</span><span class="p">,</span> <span class="n">v</span>

    <span class="n">func</span><span class="p">,</span> <span class="o">=</span> <span class="n">get_lapack_funcs</span><span class="p">((</span><span class="n">lapack_driver</span><span class="p">,),</span> <span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>
    <span class="n">compute_v</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">eigvals_only</span>
    <span class="k">if</span> <span class="n">lapack_driver</span> <span class="o">==</span> <span class="s1">&#39;sterf&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">select</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;sterf can only be used when select == &quot;a&quot;&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">eigvals_only</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;sterf can only be used when eigvals_only is &#39;</span>
                             <span class="s1">&#39;True&#39;</span><span class="p">)</span>
        <span class="n">w</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">lapack_driver</span> <span class="o">==</span> <span class="s1">&#39;stev&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">select</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;stev can only be used when select == &quot;a&quot;&#39;</span><span class="p">)</span>
        <span class="n">w</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">compute_v</span><span class="o">=</span><span class="n">compute_v</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">lapack_driver</span> <span class="o">==</span> <span class="s1">&#39;stebz&#39;</span><span class="p">:</span>
        <span class="n">tol</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">tol</span><span class="p">)</span>
        <span class="n">internal_name</span> <span class="o">=</span> <span class="s1">&#39;stebz&#39;</span>
        <span class="n">stebz</span><span class="p">,</span> <span class="o">=</span> <span class="n">get_lapack_funcs</span><span class="p">((</span><span class="n">internal_name</span><span class="p">,),</span> <span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>
        <span class="c1"># If getting eigenvectors, needs to be block-ordered (B) instead of</span>
        <span class="c1"># matrix-ordered (E), and we will reorder later</span>
        <span class="n">order</span> <span class="o">=</span> <span class="s1">&#39;E&#39;</span> <span class="k">if</span> <span class="n">eigvals_only</span> <span class="k">else</span> <span class="s1">&#39;B&#39;</span>
        <span class="n">m</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">iblock</span><span class="p">,</span> <span class="n">isplit</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">stebz</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">select</span><span class="p">,</span> <span class="n">vl</span><span class="p">,</span> <span class="n">vu</span><span class="p">,</span> <span class="n">il</span><span class="p">,</span> <span class="n">iu</span><span class="p">,</span> <span class="n">tol</span><span class="p">,</span>
                                           <span class="n">order</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>   <span class="c1"># &#39;stemr&#39;</span>
        <span class="c1"># ?STEMR annoyingly requires size N instead of N-1</span>
        <span class="n">e_</span> <span class="o">=</span> <span class="n">empty</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">size</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
        <span class="n">e_</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">e</span>
        <span class="n">stemr_lwork</span><span class="p">,</span> <span class="o">=</span> <span class="n">get_lapack_funcs</span><span class="p">((</span><span class="s1">&#39;stemr_lwork&#39;</span><span class="p">,),</span> <span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>
        <span class="n">lwork</span><span class="p">,</span> <span class="n">liwork</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">stemr_lwork</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">e_</span><span class="p">,</span> <span class="n">select</span><span class="p">,</span> <span class="n">vl</span><span class="p">,</span> <span class="n">vu</span><span class="p">,</span> <span class="n">il</span><span class="p">,</span> <span class="n">iu</span><span class="p">,</span>
                                          <span class="n">compute_v</span><span class="o">=</span><span class="n">compute_v</span><span class="p">)</span>
        <span class="n">_check_info</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="s1">&#39;stemr_lwork&#39;</span><span class="p">)</span>
        <span class="n">m</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">e_</span><span class="p">,</span> <span class="n">select</span><span class="p">,</span> <span class="n">vl</span><span class="p">,</span> <span class="n">vu</span><span class="p">,</span> <span class="n">il</span><span class="p">,</span> <span class="n">iu</span><span class="p">,</span>
                             <span class="n">compute_v</span><span class="o">=</span><span class="n">compute_v</span><span class="p">,</span> <span class="n">lwork</span><span class="o">=</span><span class="n">lwork</span><span class="p">,</span> <span class="n">liwork</span><span class="o">=</span><span class="n">liwork</span><span class="p">)</span>
    <span class="n">_check_info</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">lapack_driver</span> <span class="o">+</span> <span class="s1">&#39; (eigh_tridiagonal)&#39;</span><span class="p">)</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">w</span><span class="p">[:</span><span class="n">m</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">eigvals_only</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">w</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Do we still need to compute the eigenvalues?</span>
        <span class="k">if</span> <span class="n">lapack_driver</span> <span class="o">==</span> <span class="s1">&#39;stebz&#39;</span><span class="p">:</span>
            <span class="n">func</span><span class="p">,</span> <span class="o">=</span> <span class="n">get_lapack_funcs</span><span class="p">((</span><span class="s1">&#39;stein&#39;</span><span class="p">,),</span> <span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>
            <span class="n">v</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">iblock</span><span class="p">,</span> <span class="n">isplit</span><span class="p">)</span>
            <span class="n">_check_info</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="s1">&#39;stein (eigh_tridiagonal)&#39;</span><span class="p">,</span>
                        <span class="n">positive</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1"> eigenvectors failed to converge&#39;</span><span class="p">)</span>
            <span class="c1"># Convert block-order to matrix-order</span>
            <span class="n">order</span> <span class="o">=</span> <span class="n">argsort</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
            <span class="n">w</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">w</span><span class="p">[</span><span class="n">order</span><span class="p">],</span> <span class="n">v</span><span class="p">[:,</span> <span class="n">order</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">v</span><span class="p">[:,</span> <span class="p">:</span><span class="n">m</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">w</span><span class="p">,</span> <span class="n">v</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_check_info</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">driver</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="s1">&#39;did not converge (LAPACK info=</span><span class="si">%d</span><span class="s1">)&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check info return value.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">info</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;illegal value in argument </span><span class="si">%d</span><span class="s1"> of internal </span><span class="si">%s</span><span class="s1">&#39;</span>
                         <span class="o">%</span> <span class="p">(</span><span class="o">-</span><span class="n">info</span><span class="p">,</span> <span class="n">driver</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">info</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">positive</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">LinAlgError</span><span class="p">((</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> &quot;</span> <span class="o">+</span> <span class="n">positive</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">info</span><span class="p">,))</span>


<span class="k">def</span><span class="w"> </span><span class="nf">hessenberg</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">calc_q</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">overwrite_a</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">check_finite</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute Hessenberg form of a matrix.</span>

<span class="sd">    The Hessenberg decomposition is::</span>

<span class="sd">        A = Q H Q^H</span>

<span class="sd">    where `Q` is unitary/orthogonal and `H` has only zero elements below</span>
<span class="sd">    the first sub-diagonal.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : (M, M) array_like</span>
<span class="sd">        Matrix to bring into Hessenberg form.</span>
<span class="sd">    calc_q : bool, optional</span>
<span class="sd">        Whether to compute the transformation matrix.  Default is False.</span>
<span class="sd">    overwrite_a : bool, optional</span>
<span class="sd">        Whether to overwrite `a`; may improve performance.</span>
<span class="sd">        Default is False.</span>
<span class="sd">    check_finite : bool, optional</span>
<span class="sd">        Whether to check that the input matrix contains only finite numbers.</span>
<span class="sd">        Disabling may give a performance gain, but may result in problems</span>
<span class="sd">        (crashes, non-termination) if the inputs do contain infinities or NaNs.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    H : (M, M) ndarray</span>
<span class="sd">        Hessenberg form of `a`.</span>
<span class="sd">    Q : (M, M) ndarray</span>
<span class="sd">        Unitary/orthogonal similarity transformation matrix ``A = Q H Q^H``.</span>
<span class="sd">        Only returned if ``calc_q=True``.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import numpy as np</span>
<span class="sd">    &gt;&gt;&gt; from scipy.linalg import hessenberg</span>
<span class="sd">    &gt;&gt;&gt; A = np.array([[2, 5, 8, 7], [5, 2, 2, 8], [7, 5, 6, 6], [5, 4, 4, 8]])</span>
<span class="sd">    &gt;&gt;&gt; H, Q = hessenberg(A, calc_q=True)</span>
<span class="sd">    &gt;&gt;&gt; H</span>
<span class="sd">    array([[  2.        , -11.65843866,   1.42005301,   0.25349066],</span>
<span class="sd">           [ -9.94987437,  14.53535354,  -5.31022304,   2.43081618],</span>
<span class="sd">           [  0.        ,  -1.83299243,   0.38969961,  -0.51527034],</span>
<span class="sd">           [  0.        ,   0.        ,  -3.83189513,   1.07494686]])</span>
<span class="sd">    &gt;&gt;&gt; np.allclose(Q @ H @ Q.conj().T - A, np.zeros((4, 4)))</span>
<span class="sd">    True</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a1</span> <span class="o">=</span> <span class="n">_asarray_validated</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">check_finite</span><span class="o">=</span><span class="n">check_finite</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">a1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span> <span class="ow">or</span> <span class="p">(</span><span class="n">a1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">a1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;expected square matrix&#39;</span><span class="p">)</span>
    <span class="n">overwrite_a</span> <span class="o">=</span> <span class="n">overwrite_a</span> <span class="ow">or</span> <span class="p">(</span><span class="n">_datacopied</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">a1</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">h3</span> <span class="o">=</span> <span class="n">hessenberg</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">a1</span><span class="o">.</span><span class="n">dtype</span><span class="p">))</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">a1</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">h3</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">calc_q</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">h</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">h3</span><span class="p">,</span> <span class="n">q3</span> <span class="o">=</span> <span class="n">hessenberg</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">a1</span><span class="o">.</span><span class="n">dtype</span><span class="p">),</span> <span class="n">calc_q</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">a1</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">q3</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
            <span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">a1</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">h3</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">h</span><span class="p">,</span> <span class="n">q</span>

    <span class="c1"># if 2x2 or smaller: already in Hessenberg</span>
    <span class="k">if</span> <span class="n">a1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">calc_q</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">a1</span><span class="p">,</span> <span class="n">eye</span><span class="p">(</span><span class="n">a1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">a1</span>

    <span class="n">gehrd</span><span class="p">,</span> <span class="n">gebal</span><span class="p">,</span> <span class="n">gehrd_lwork</span> <span class="o">=</span> <span class="n">get_lapack_funcs</span><span class="p">((</span><span class="s1">&#39;gehrd&#39;</span><span class="p">,</span> <span class="s1">&#39;gebal&#39;</span><span class="p">,</span>
                                                  <span class="s1">&#39;gehrd_lwork&#39;</span><span class="p">),</span> <span class="p">(</span><span class="n">a1</span><span class="p">,))</span>
    <span class="n">ba</span><span class="p">,</span> <span class="n">lo</span><span class="p">,</span> <span class="n">hi</span><span class="p">,</span> <span class="n">pivscale</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">gebal</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">permute</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">overwrite_a</span><span class="o">=</span><span class="n">overwrite_a</span><span class="p">)</span>
    <span class="n">_check_info</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="s1">&#39;gebal (hessenberg)&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">a1</span><span class="p">)</span>

    <span class="n">lwork</span> <span class="o">=</span> <span class="n">_compute_lwork</span><span class="p">(</span><span class="n">gehrd_lwork</span><span class="p">,</span> <span class="n">ba</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lo</span><span class="o">=</span><span class="n">lo</span><span class="p">,</span> <span class="n">hi</span><span class="o">=</span><span class="n">hi</span><span class="p">)</span>

    <span class="n">hq</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">gehrd</span><span class="p">(</span><span class="n">ba</span><span class="p">,</span> <span class="n">lo</span><span class="o">=</span><span class="n">lo</span><span class="p">,</span> <span class="n">hi</span><span class="o">=</span><span class="n">hi</span><span class="p">,</span> <span class="n">lwork</span><span class="o">=</span><span class="n">lwork</span><span class="p">,</span> <span class="n">overwrite_a</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">_check_info</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="s1">&#39;gehrd (hessenberg)&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">triu</span><span class="p">(</span><span class="n">hq</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">calc_q</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">h</span>

    <span class="c1"># use orghr/unghr to compute q</span>
    <span class="n">orghr</span><span class="p">,</span> <span class="n">orghr_lwork</span> <span class="o">=</span> <span class="n">get_lapack_funcs</span><span class="p">((</span><span class="s1">&#39;orghr&#39;</span><span class="p">,</span> <span class="s1">&#39;orghr_lwork&#39;</span><span class="p">),</span> <span class="p">(</span><span class="n">a1</span><span class="p">,))</span>
    <span class="n">lwork</span> <span class="o">=</span> <span class="n">_compute_lwork</span><span class="p">(</span><span class="n">orghr_lwork</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">lo</span><span class="o">=</span><span class="n">lo</span><span class="p">,</span> <span class="n">hi</span><span class="o">=</span><span class="n">hi</span><span class="p">)</span>

    <span class="n">q</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">orghr</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">hq</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="n">tau</span><span class="p">,</span> <span class="n">lo</span><span class="o">=</span><span class="n">lo</span><span class="p">,</span> <span class="n">hi</span><span class="o">=</span><span class="n">hi</span><span class="p">,</span> <span class="n">lwork</span><span class="o">=</span><span class="n">lwork</span><span class="p">,</span> <span class="n">overwrite_a</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">_check_info</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="s1">&#39;orghr (hessenberg)&#39;</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">h</span><span class="p">,</span> <span class="n">q</span>


<span class="k">def</span><span class="w"> </span><span class="nf">cdf2rdf</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts complex eigenvalues ``w`` and eigenvectors ``v`` to real</span>
<span class="sd">    eigenvalues in a block diagonal form ``wr`` and the associated real</span>
<span class="sd">    eigenvectors ``vr``, such that::</span>

<span class="sd">        vr @ wr = X @ vr</span>

<span class="sd">    continues to hold, where ``X`` is the original array for which ``w`` and</span>
<span class="sd">    ``v`` are the eigenvalues and eigenvectors.</span>

<span class="sd">    .. versionadded:: 1.1.0</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    w : (..., M) array_like</span>
<span class="sd">        Complex or real eigenvalues, an array or stack of arrays</span>

<span class="sd">        Conjugate pairs must not be interleaved, else the wrong result</span>
<span class="sd">        will be produced. So ``[1+1j, 1, 1-1j]`` will give a correct result,</span>
<span class="sd">        but ``[1+1j, 2+1j, 1-1j, 2-1j]`` will not.</span>

<span class="sd">    v : (..., M, M) array_like</span>
<span class="sd">        Complex or real eigenvectors, a square array or stack of square arrays.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    wr : (..., M, M) ndarray</span>
<span class="sd">        Real diagonal block form of eigenvalues</span>
<span class="sd">    vr : (..., M, M) ndarray</span>
<span class="sd">        Real eigenvectors associated with ``wr``</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    eig : Eigenvalues and right eigenvectors for non-symmetric arrays</span>
<span class="sd">    rsf2csf : Convert real Schur form to complex Schur form</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    ``w``, ``v`` must be the eigenstructure for some *real* matrix ``X``.</span>
<span class="sd">    For example, obtained by ``w, v = scipy.linalg.eig(X)`` or</span>
<span class="sd">    ``w, v = numpy.linalg.eig(X)`` in which case ``X`` can also represent</span>
<span class="sd">    stacked arrays.</span>

<span class="sd">    .. versionadded:: 1.1.0</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import numpy as np</span>
<span class="sd">    &gt;&gt;&gt; X = np.array([[1, 2, 3], [0, 4, 5], [0, -5, 4]])</span>
<span class="sd">    &gt;&gt;&gt; X</span>
<span class="sd">    array([[ 1,  2,  3],</span>
<span class="sd">           [ 0,  4,  5],</span>
<span class="sd">           [ 0, -5,  4]])</span>

<span class="sd">    &gt;&gt;&gt; from scipy import linalg</span>
<span class="sd">    &gt;&gt;&gt; w, v = linalg.eig(X)</span>
<span class="sd">    &gt;&gt;&gt; w</span>
<span class="sd">    array([ 1.+0.j,  4.+5.j,  4.-5.j])</span>
<span class="sd">    &gt;&gt;&gt; v</span>
<span class="sd">    array([[ 1.00000+0.j     , -0.01906-0.40016j, -0.01906+0.40016j],</span>
<span class="sd">           [ 0.00000+0.j     ,  0.00000-0.64788j,  0.00000+0.64788j],</span>
<span class="sd">           [ 0.00000+0.j     ,  0.64788+0.j     ,  0.64788-0.j     ]])</span>

<span class="sd">    &gt;&gt;&gt; wr, vr = linalg.cdf2rdf(w, v)</span>
<span class="sd">    &gt;&gt;&gt; wr</span>
<span class="sd">    array([[ 1.,  0.,  0.],</span>
<span class="sd">           [ 0.,  4.,  5.],</span>
<span class="sd">           [ 0., -5.,  4.]])</span>
<span class="sd">    &gt;&gt;&gt; vr</span>
<span class="sd">    array([[ 1.     ,  0.40016, -0.01906],</span>
<span class="sd">           [ 0.     ,  0.64788,  0.     ],</span>
<span class="sd">           [ 0.     ,  0.     ,  0.64788]])</span>

<span class="sd">    &gt;&gt;&gt; vr @ wr</span>
<span class="sd">    array([[ 1.     ,  1.69593,  1.9246 ],</span>
<span class="sd">           [ 0.     ,  2.59153,  3.23942],</span>
<span class="sd">           [ 0.     , -3.23942,  2.59153]])</span>
<span class="sd">    &gt;&gt;&gt; X @ vr</span>
<span class="sd">    array([[ 1.     ,  1.69593,  1.9246 ],</span>
<span class="sd">           [ 0.     ,  2.59153,  3.23942],</span>
<span class="sd">           [ 0.     , -3.23942,  2.59153]])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">w</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">_asarray_validated</span><span class="p">(</span><span class="n">w</span><span class="p">),</span> <span class="n">_asarray_validated</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

    <span class="c1"># check dimensions</span>
    <span class="k">if</span> <span class="n">w</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;expected w to be at least 1D&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;expected v to be at least 2D&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="n">w</span><span class="o">.</span><span class="n">ndim</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;expected eigenvectors array to have exactly one &#39;</span>
                         <span class="s1">&#39;dimension more than eigenvalues array&#39;</span><span class="p">)</span>

    <span class="c1"># check shapes</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="n">v</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;expected v to be a square matrix or stacked square &#39;</span>
                         <span class="s1">&#39;matrices: v.shape[-2] = v.shape[-1]&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">n</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;expected the same number of eigenvalues as &#39;</span>
                         <span class="s1">&#39;eigenvectors&#39;</span><span class="p">)</span>

    <span class="c1"># get indices for each first pair of complex eigenvalues</span>
    <span class="n">complex_mask</span> <span class="o">=</span> <span class="n">iscomplex</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
    <span class="n">n_complex</span> <span class="o">=</span> <span class="n">complex_mask</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># check if all complex eigenvalues have conjugate pairs</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">n_complex</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;expected complex-conjugate pairs of eigenvalues&#39;</span><span class="p">)</span>

    <span class="c1"># find complex indices</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">nonzero</span><span class="p">(</span><span class="n">complex_mask</span><span class="p">)</span>
    <span class="n">idx_stack</span> <span class="o">=</span> <span class="n">idx</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">idx_elem</span> <span class="o">=</span> <span class="n">idx</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># filter them to conjugate indices, assuming pairs are not interleaved</span>
    <span class="n">j</span> <span class="o">=</span> <span class="n">idx_elem</span><span class="p">[</span><span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">idx_elem</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">stack_ind</span> <span class="o">=</span> <span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idx_stack</span><span class="p">:</span>
        <span class="c1"># should never happen, assuming nonzero orders by the last axis</span>
        <span class="k">assert</span> <span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">all</span><span class="p">(),</span> \
                <span class="s2">&quot;Conjugate pair spanned different arrays!&quot;</span>
        <span class="n">stack_ind</span> <span class="o">+=</span> <span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">],)</span>

    <span class="c1"># all eigenvalues to diagonal form</span>
    <span class="n">wr</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">M</span> <span class="o">+</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">w</span><span class="o">.</span><span class="n">real</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
    <span class="n">di</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">wr</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">di</span><span class="p">,</span> <span class="n">di</span><span class="p">]</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">real</span>

    <span class="c1"># complex eigenvalues to real block diagonal form</span>
    <span class="n">wr</span><span class="p">[</span><span class="n">stack_ind</span> <span class="o">+</span> <span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)]</span> <span class="o">=</span> <span class="n">w</span><span class="p">[</span><span class="n">stack_ind</span> <span class="o">+</span> <span class="p">(</span><span class="n">j</span><span class="p">,)]</span><span class="o">.</span><span class="n">imag</span>
    <span class="n">wr</span><span class="p">[</span><span class="n">stack_ind</span> <span class="o">+</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">j</span><span class="p">)]</span> <span class="o">=</span> <span class="n">w</span><span class="p">[</span><span class="n">stack_ind</span> <span class="o">+</span> <span class="p">(</span><span class="n">k</span><span class="p">,)]</span><span class="o">.</span><span class="n">imag</span>

    <span class="c1"># compute real eigenvectors associated with real block diagonal eigenvalues</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="n">M</span> <span class="o">+</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">cdouble</span><span class="p">)</span>
    <span class="n">u</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">di</span><span class="p">,</span> <span class="n">di</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">u</span><span class="p">[</span><span class="n">stack_ind</span> <span class="o">+</span> <span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">j</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">0.5</span><span class="n">j</span>
    <span class="n">u</span><span class="p">[</span><span class="n">stack_ind</span> <span class="o">+</span> <span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">0.5</span>
    <span class="n">u</span><span class="p">[</span><span class="n">stack_ind</span> <span class="o">+</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">j</span><span class="p">)]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span><span class="n">j</span>
    <span class="n">u</span><span class="p">[</span><span class="n">stack_ind</span> <span class="o">+</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">k</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">0.5</span>

    <span class="c1"># multiply matrices v and u (equivalent to v @ u)</span>
    <span class="n">vr</span> <span class="o">=</span> <span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;...ij,...jk-&gt;...ik&#39;</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span><span class="o">.</span><span class="n">real</span>

    <span class="k">return</span> <span class="n">wr</span><span class="p">,</span> <span class="n">vr</span>
</pre></div>
        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2019-2025, Elias Fernández
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </div>
</div><script src="../../../_static/documentation_options.js?v=a7611213"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/scripts/furo.js?v=46bd48cc"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    </body>
</html>