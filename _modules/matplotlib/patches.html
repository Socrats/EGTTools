<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" />
        <link rel="prefetch" href="../../_static/logo.png" as="image" />

    <!-- Generated with Sphinx 8.1.3 and Furo 2025.07.19 -->
        <title>matplotlib.patches - EGTtools &#34;0.1.14.2&#34; documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=25af2a20" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=8dab3a3b" />
    <link rel="stylesheet" type="text/css" href="../../_static/readthedocs-custom.css?v=07c3a6e0" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #2b2b2b;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #2b2b2b;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">EGTtools "0.1.14.2" documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../../_static/logo.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">EGTtools "0.1.14.2" documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Home page</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../tutorials.html">Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/create_new_python_game.html">Create a new game in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/create_cpp_game.html">Create a new game in C++ and bind it to Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/create_new_behaviors.html">Create new strategies/behaviors for existing games</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/analytical_methods.html">Use analytical methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/numerical_methods.html">Use numerical methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/plotting.html">Visualize results</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/references.html">References</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../examples.html">Examples</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Examples</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../examples/hawk_dove_dynamics.html">Hawk and dove dynamics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/hawk_dove_dynamics_pairwise_comparison.html">Hawk and dove dynamics with new PairwiseComparison class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/normal_form_game_mc_simulations.html">Monte Carlo simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/plot_invasion_diagram.html">Fixation probabilities and Invasion diagram</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/plot_invasion_diagram.html#Instantiate-the-Normal-Form-Game">Instantiate the Normal Form Game</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/plot_simplex.html">2D Simplex plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/plot_simplex_simplified.html">2D Simplex plot simplified</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/examples_of_use.html">General examples</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../_autosummary/egttools.html">API reference</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of API reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/egttools.calculate_nb_states.html">egttools.calculate_nb_states</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/egttools.calculate_state.html">egttools.calculate_state</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/egttools.calculate_strategies_distribution.html">egttools.calculate_strategies_distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/egttools.files.html">egttools.files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/egttools.is_blas_lapack_enabled.html">egttools.is_blas_lapack_enabled</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/egttools.is_openmp_enabled.html">egttools.is_openmp_enabled</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/egttools.sample_simplex.html">egttools.sample_simplex</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/egttools.sample_unit_simplex.html">egttools.sample_unit_simplex</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/egttools.show_build_info.html">egttools.show_build_info</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../_autosummary/egttools.analytical.html">egttools.analytical</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of egttools.analytical</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.analytical.replicator_equation.html">egttools.analytical.replicator_equation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.analytical.replicator_equation_n_player.html">egttools.analytical.replicator_equation_n_player</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.analytical.PairwiseComparison.html">egttools.analytical.PairwiseComparison</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.analytical.StochDynamics.html">egttools.analytical.StochDynamics</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/egttools.analytical.sed_analytical.html">egttools.analytical.sed_analytical</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of egttools.analytical.sed_analytical</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.analytical.sed_analytical.calculate_nb_states.html">egttools.analytical.sed_analytical.calculate_nb_states</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.analytical.sed_analytical.calculate_state.html">egttools.analytical.sed_analytical.calculate_state</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.analytical.sed_analytical.eig.html">egttools.analytical.sed_analytical.eig</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.analytical.sed_analytical.replicator_equation.html">egttools.analytical.sed_analytical.replicator_equation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.analytical.sed_analytical.replicator_equation_n_player.html">egttools.analytical.sed_analytical.replicator_equation_n_player</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.analytical.sed_analytical.sample_simplex.html">egttools.analytical.sed_analytical.sample_simplex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.analytical.sed_analytical.warn.html">egttools.analytical.sed_analytical.warn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.analytical.sed_analytical.StochDynamics.html">egttools.analytical.sed_analytical.StochDynamics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.analytical.sed_analytical.csr_matrix.html">egttools.analytical.sed_analytical.csr_matrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.analytical.sed_analytical.lil_matrix.html">egttools.analytical.sed_analytical.lil_matrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.analytical.sed_analytical.permutations.html">egttools.analytical.sed_analytical.permutations</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/egttools.analytical.utils.html">egttools.analytical.utils</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of egttools.analytical.utils</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.analytical.utils.calculate_gradients.html">egttools.analytical.utils.calculate_gradients</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.analytical.utils.check_if_point_in_unit_simplex.html">egttools.analytical.utils.check_if_point_in_unit_simplex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.analytical.utils.check_if_there_is_random_drift.html">egttools.analytical.utils.check_if_there_is_random_drift</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.analytical.utils.check_replicator_stability_pairwise_games.html">egttools.analytical.utils.check_replicator_stability_pairwise_games</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.analytical.utils.eigvals.html">egttools.analytical.utils.eigvals</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.analytical.utils.find_roots.html">egttools.analytical.utils.find_roots</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.analytical.utils.find_roots_and_stability.html">egttools.analytical.utils.find_roots_and_stability</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.analytical.utils.get_pairwise_gradient_from_replicator.html">egttools.analytical.utils.get_pairwise_gradient_from_replicator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.analytical.utils.get_pairwise_gradient_from_replicator_n_player.html">egttools.analytical.utils.get_pairwise_gradient_from_replicator_n_player</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.analytical.utils.replicator_equation.html">egttools.analytical.utils.replicator_equation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.analytical.utils.replicator_equation_n_player.html">egttools.analytical.utils.replicator_equation_n_player</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.analytical.utils.root.html">egttools.analytical.utils.root</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.analytical.utils.sample_unit_simplex.html">egttools.analytical.utils.sample_unit_simplex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.analytical.utils.StochDynamics.html">egttools.analytical.utils.StochDynamics</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../_autosummary/egttools.behaviors.html">egttools.behaviors</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of egttools.behaviors</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/egttools.behaviors.CPR.html">egttools.behaviors.CPR</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of egttools.behaviors.CPR</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../_autosummary/egttools.behaviors.CPR.abstract_cpr_strategy.html">egttools.behaviors.CPR.abstract_cpr_strategy</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of egttools.behaviors.CPR.abstract_cpr_strategy</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/egttools.behaviors.CPR.abstract_cpr_strategy.abstractmethod.html">egttools.behaviors.CPR.abstract_cpr_strategy.abstractmethod</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/egttools.behaviors.CPR.abstract_cpr_strategy.ABC.html">egttools.behaviors.CPR.abstract_cpr_strategy.ABC</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/egttools.behaviors.CPR.abstract_cpr_strategy.AbstractCPRStrategy.html">egttools.behaviors.CPR.abstract_cpr_strategy.AbstractCPRStrategy</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../_autosummary/egttools.behaviors.CPR.cpr_strategies.html">egttools.behaviors.CPR.cpr_strategies</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of egttools.behaviors.CPR.cpr_strategies</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/egttools.behaviors.CPR.cpr_strategies.fair_extraction.html">egttools.behaviors.CPR.cpr_strategies.fair_extraction</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/egttools.behaviors.CPR.cpr_strategies.high_extraction.html">egttools.behaviors.CPR.cpr_strategies.high_extraction</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/egttools.behaviors.CPR.cpr_strategies.nash_extraction.html">egttools.behaviors.CPR.cpr_strategies.nash_extraction</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/egttools.behaviors.CPR.cpr_strategies.payoff_no_commitment.html">egttools.behaviors.CPR.cpr_strategies.payoff_no_commitment</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/egttools.behaviors.CPR.cpr_strategies.AbstractCPRStrategy.html">egttools.behaviors.CPR.cpr_strategies.AbstractCPRStrategy</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/egttools.behaviors.CPR.cpr_strategies.CommitmentStrategy.html">egttools.behaviors.CPR.cpr_strategies.CommitmentStrategy</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/egttools.behaviors.CPR.cpr_strategies.FairExtraction.html">egttools.behaviors.CPR.cpr_strategies.FairExtraction</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/egttools.behaviors.CPR.cpr_strategies.FakeStrategy.html">egttools.behaviors.CPR.cpr_strategies.FakeStrategy</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/egttools.behaviors.CPR.cpr_strategies.FixedExtraction.html">egttools.behaviors.CPR.cpr_strategies.FixedExtraction</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/egttools.behaviors.CPR.cpr_strategies.FreeStrategy.html">egttools.behaviors.CPR.cpr_strategies.FreeStrategy</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/egttools.behaviors.CPR.cpr_strategies.HighExtraction.html">egttools.behaviors.CPR.cpr_strategies.HighExtraction</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/egttools.behaviors.CPR.cpr_strategies.NashExtraction.html">egttools.behaviors.CPR.cpr_strategies.NashExtraction</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/egttools.behaviors.CRD.html">egttools.behaviors.CRD</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of egttools.behaviors.CRD</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.behaviors.CRD.AbstractCRDStrategy.html">egttools.behaviors.CRD.AbstractCRDStrategy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.behaviors.CRD.CRDMemoryOnePlayer.html">egttools.behaviors.CRD.CRDMemoryOnePlayer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.behaviors.CRD.GoalBasedCRDStrategy.html">egttools.behaviors.CRD.GoalBasedCRDStrategy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.behaviors.CRD.MovingAverageCRDStrategy.html">egttools.behaviors.CRD.MovingAverageCRDStrategy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.behaviors.CRD.TimeBasedCRDStrategy.html">egttools.behaviors.CRD.TimeBasedCRDStrategy</a></li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../_autosummary/egttools.behaviors.CRD.goal_based.html">egttools.behaviors.CRD.goal_based</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of egttools.behaviors.CRD.goal_based</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/egttools.behaviors.CRD.goal_based.AbstractCRDStrategy.html">egttools.behaviors.CRD.goal_based.AbstractCRDStrategy</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/egttools.behaviors.CRD.goal_based.GoalBasedCRDStrategy.html">egttools.behaviors.CRD.goal_based.GoalBasedCRDStrategy</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../_autosummary/egttools.behaviors.CRD.moving_average.html">egttools.behaviors.CRD.moving_average</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of egttools.behaviors.CRD.moving_average</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/egttools.behaviors.CRD.moving_average.AbstractCRDStrategy.html">egttools.behaviors.CRD.moving_average.AbstractCRDStrategy</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/egttools.behaviors.CRD.moving_average.MovingAverageCRDStrategy.html">egttools.behaviors.CRD.moving_average.MovingAverageCRDStrategy</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../_autosummary/egttools.behaviors.CRD.time_based.html">egttools.behaviors.CRD.time_based</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of egttools.behaviors.CRD.time_based</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/egttools.behaviors.CRD.time_based.AbstractCRDStrategy.html">egttools.behaviors.CRD.time_based.AbstractCRDStrategy</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/egttools.behaviors.CRD.time_based.TimeBasedCRDStrategy.html">egttools.behaviors.CRD.time_based.TimeBasedCRDStrategy</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/egttools.behaviors.NormalForm.html">egttools.behaviors.NormalForm</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle navigation of egttools.behaviors.NormalForm</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.behaviors.NormalForm.AbstractNFGStrategy.html">egttools.behaviors.NormalForm.AbstractNFGStrategy</a></li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../_autosummary/egttools.behaviors.NormalForm.TwoActions.html">egttools.behaviors.NormalForm.TwoActions</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle navigation of egttools.behaviors.NormalForm.TwoActions</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/egttools.behaviors.NormalForm.TwoActions.ActionInertia.html">egttools.behaviors.NormalForm.TwoActions.ActionInertia</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/egttools.behaviors.NormalForm.TwoActions.Cooperator.html">egttools.behaviors.NormalForm.TwoActions.Cooperator</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/egttools.behaviors.NormalForm.TwoActions.Defector.html">egttools.behaviors.NormalForm.TwoActions.Defector</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/egttools.behaviors.NormalForm.TwoActions.Detective.html">egttools.behaviors.NormalForm.TwoActions.Detective</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/egttools.behaviors.NormalForm.TwoActions.EpsilonGRIM.html">egttools.behaviors.NormalForm.TwoActions.EpsilonGRIM</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/egttools.behaviors.NormalForm.TwoActions.EpsilonTFT.html">egttools.behaviors.NormalForm.TwoActions.EpsilonTFT</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/egttools.behaviors.NormalForm.TwoActions.GRIM.html">egttools.behaviors.NormalForm.TwoActions.GRIM</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/egttools.behaviors.NormalForm.TwoActions.GenerousTFT.html">egttools.behaviors.NormalForm.TwoActions.GenerousTFT</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/egttools.behaviors.NormalForm.TwoActions.GradualTFT.html">egttools.behaviors.NormalForm.TwoActions.GradualTFT</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/egttools.behaviors.NormalForm.TwoActions.ImperfectTFT.html">egttools.behaviors.NormalForm.TwoActions.ImperfectTFT</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/egttools.behaviors.NormalForm.TwoActions.MemoryOneStrategy.html">egttools.behaviors.NormalForm.TwoActions.MemoryOneStrategy</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/egttools.behaviors.NormalForm.TwoActions.Pavlov.html">egttools.behaviors.NormalForm.TwoActions.Pavlov</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/egttools.behaviors.NormalForm.TwoActions.Random.html">egttools.behaviors.NormalForm.TwoActions.Random</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/egttools.behaviors.NormalForm.TwoActions.SuspiciousTFT.html">egttools.behaviors.NormalForm.TwoActions.SuspiciousTFT</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/egttools.behaviors.NormalForm.TwoActions.TFT.html">egttools.behaviors.NormalForm.TwoActions.TFT</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/egttools.behaviors.NormalForm.TwoActions.TFTT.html">egttools.behaviors.NormalForm.TwoActions.TFTT</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/egttools.behaviors.NormalForm.TwoActions.TTFT.html">egttools.behaviors.NormalForm.TwoActions.TTFT</a></li>
<li class="toctree-l5 has-children"><a class="reference internal" href="../../_autosummary/egttools.behaviors.NormalForm.TwoActions.nfg_strategies.html">egttools.behaviors.NormalForm.TwoActions.nfg_strategies</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle navigation of egttools.behaviors.NormalForm.TwoActions.nfg_strategies</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l6"><a class="reference internal" href="../../_autosummary/egttools.behaviors.NormalForm.TwoActions.nfg_strategies.AbstractNFGStrategy.html">egttools.behaviors.NormalForm.TwoActions.nfg_strategies.AbstractNFGStrategy</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../_autosummary/egttools.behaviors.NormalForm.TwoActions.nfg_strategies.Detective.html">egttools.behaviors.NormalForm.TwoActions.nfg_strategies.Detective</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../_autosummary/egttools.behaviors.NormalForm.TwoActions.nfg_strategies.EpsilonGRIM.html">egttools.behaviors.NormalForm.TwoActions.nfg_strategies.EpsilonGRIM</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../_autosummary/egttools.behaviors.NormalForm.TwoActions.nfg_strategies.EpsilonTFT.html">egttools.behaviors.NormalForm.TwoActions.nfg_strategies.EpsilonTFT</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../_autosummary/egttools.behaviors.NormalForm.TwoActions.nfg_strategies.MemoryOneStrategy.html">egttools.behaviors.NormalForm.TwoActions.nfg_strategies.MemoryOneStrategy</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/egttools.behaviors.opinion_behaviors.html">egttools.behaviors.opinion_behaviors</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle navigation of egttools.behaviors.opinion_behaviors</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.behaviors.opinion_behaviors.opinion_factory.html">egttools.behaviors.opinion_behaviors.opinion_factory</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.behaviors.opinion_behaviors.Opinion.html">egttools.behaviors.opinion_behaviors.Opinion</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/egttools.behaviors.pgg_behaviors.html">egttools.behaviors.pgg_behaviors</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle navigation of egttools.behaviors.pgg_behaviors</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.behaviors.pgg_behaviors.player_factory.html">egttools.behaviors.pgg_behaviors.player_factory</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.behaviors.pgg_behaviors.PGGOneShotStrategy.html">egttools.behaviors.pgg_behaviors.PGGOneShotStrategy</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../_autosummary/egttools.datastructures.html">egttools.datastructures</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle navigation of egttools.datastructures</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.datastructures.DataTable.html">egttools.datastructures.DataTable</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../_autosummary/egttools.distributions.html">egttools.distributions</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><div class="visually-hidden">Toggle navigation of egttools.distributions</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.distributions.binom.html">egttools.distributions.binom</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.distributions.comb.html">egttools.distributions.comb</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.distributions.multinomial_pmf.html">egttools.distributions.multinomial_pmf</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.distributions.multivariate_hypergeometric_pdf.html">egttools.distributions.multivariate_hypergeometric_pdf</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.distributions.TimingUncertainty.html">egttools.distributions.TimingUncertainty</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../_autosummary/egttools.games.html">egttools.games</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" role="switch" type="checkbox"/><label for="toctree-checkbox-22"><div class="visually-hidden">Toggle navigation of egttools.games</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.games.AbstractGame.html">egttools.games.AbstractGame</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.games.AbstractNPlayerGame.html">egttools.games.AbstractNPlayerGame</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.games.AbstractSpatialGame.html">egttools.games.AbstractSpatialGame</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.games.AbstractTwoPLayerGame.html">egttools.games.AbstractTwoPLayerGame</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.games.CRDGame.html">egttools.games.CRDGame</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.games.CRDGameTU.html">egttools.games.CRDGameTU</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.games.CommonPoolResourceDilemma.html">egttools.games.CommonPoolResourceDilemma</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.games.CommonPoolResourceDilemmaCommitment.html">egttools.games.CommonPoolResourceDilemmaCommitment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.games.InformalRiskGame.html">egttools.games.InformalRiskGame</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.games.Matrix2PlayerGameHolder.html">egttools.games.Matrix2PlayerGameHolder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.games.MatrixNPlayerGameHolder.html">egttools.games.MatrixNPlayerGameHolder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.games.NPlayerStagHunt.html">egttools.games.NPlayerStagHunt</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.games.NormalFormGame.html">egttools.games.NormalFormGame</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.games.NormalFormNetworkGame.html">egttools.games.NormalFormNetworkGame</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.games.OneShotCRD.html">egttools.games.OneShotCRD</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.games.OneShotCRDNetworkGame.html">egttools.games.OneShotCRDNetworkGame</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.games.PGG.html">egttools.games.PGG</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/egttools.games.abstract_games.html">egttools.games.abstract_games</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" role="switch" type="checkbox"/><label for="toctree-checkbox-23"><div class="visually-hidden">Toggle navigation of egttools.games.abstract_games</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.games.abstract_games.abstractmethod.html">egttools.games.abstract_games.abstractmethod</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.games.abstract_games.calculate_state.html">egttools.games.abstract_games.calculate_state</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.games.abstract_games.sample_simplex.html">egttools.games.abstract_games.sample_simplex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.games.abstract_games.AbstractGame.html">egttools.games.abstract_games.AbstractGame</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.games.abstract_games.AbstractNPlayerGame.html">egttools.games.abstract_games.AbstractNPlayerGame</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.games.abstract_games.AbstractNPlayerGameExpectedPayoff.html">egttools.games.abstract_games.AbstractNPlayerGameExpectedPayoff</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.games.abstract_games.AbstractTwoPLayerGame.html">egttools.games.abstract_games.AbstractTwoPLayerGame</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/egttools.games.informal_risk.html">egttools.games.informal_risk</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" role="switch" type="checkbox"/><label for="toctree-checkbox-24"><div class="visually-hidden">Toggle navigation of egttools.games.informal_risk</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.games.informal_risk.calculate_nb_states.html">egttools.games.informal_risk.calculate_nb_states</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.games.informal_risk.calculate_state.html">egttools.games.informal_risk.calculate_state</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.games.informal_risk.sample_simplex.html">egttools.games.informal_risk.sample_simplex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.games.informal_risk.AbstractGame.html">egttools.games.informal_risk.AbstractGame</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.games.informal_risk.InformalRiskGame.html">egttools.games.informal_risk.InformalRiskGame</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/egttools.games.nonlinear_games.html">egttools.games.nonlinear_games</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" role="switch" type="checkbox"/><label for="toctree-checkbox-25"><div class="visually-hidden">Toggle navigation of egttools.games.nonlinear_games</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.games.nonlinear_games.calculate_state.html">egttools.games.nonlinear_games.calculate_state</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.games.nonlinear_games.sample_simplex.html">egttools.games.nonlinear_games.sample_simplex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.games.nonlinear_games.AbstractCPRStrategy.html">egttools.games.nonlinear_games.AbstractCPRStrategy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.games.nonlinear_games.AbstractNPlayerGame.html">egttools.games.nonlinear_games.AbstractNPlayerGame</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.games.nonlinear_games.CommonPoolResourceDilemma.html">egttools.games.nonlinear_games.CommonPoolResourceDilemma</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.games.nonlinear_games.CommonPoolResourceDilemmaCommitment.html">egttools.games.nonlinear_games.CommonPoolResourceDilemmaCommitment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.games.nonlinear_games.NPlayerStagHunt.html">egttools.games.nonlinear_games.NPlayerStagHunt</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/egttools.games.opinion_game.html">egttools.games.opinion_game</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" role="switch" type="checkbox"/><label for="toctree-checkbox-26"><div class="visually-hidden">Toggle navigation of egttools.games.opinion_game</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.games.opinion_game.moment.html">egttools.games.opinion_game.moment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.games.opinion_game.sample_simplex.html">egttools.games.opinion_game.sample_simplex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.games.opinion_game.sigmoid.html">egttools.games.opinion_game.sigmoid</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.games.opinion_game.AbstractNPlayerGame.html">egttools.games.opinion_game.AbstractNPlayerGame</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.games.opinion_game.OpinionGame.html">egttools.games.opinion_game.OpinionGame</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/egttools.games.pgg.html">egttools.games.pgg</a><input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" role="switch" type="checkbox"/><label for="toctree-checkbox-27"><div class="visually-hidden">Toggle navigation of egttools.games.pgg</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.games.pgg.sample_simplex.html">egttools.games.pgg.sample_simplex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.games.pgg.AbstractNPlayerGame.html">egttools.games.pgg.AbstractNPlayerGame</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.games.pgg.PGG.html">egttools.games.pgg.PGG</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.games.pgg.PGGOneShotStrategy.html">egttools.games.pgg.PGGOneShotStrategy</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../_autosummary/egttools.helpers.html">egttools.helpers</a><input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" role="switch" type="checkbox"/><label for="toctree-checkbox-28"><div class="visually-hidden">Toggle navigation of egttools.helpers</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/egttools.helpers.vectorized.html">egttools.helpers.vectorized</a><input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" role="switch" type="checkbox"/><label for="toctree-checkbox-29"><div class="visually-hidden">Toggle navigation of egttools.helpers.vectorized</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.helpers.vectorized.barycentric_to_xy_coordinates.html">egttools.helpers.vectorized.barycentric_to_xy_coordinates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.helpers.vectorized.cpp_vectorized_replicator_equation_n_player.html">egttools.helpers.vectorized.cpp_vectorized_replicator_equation_n_player</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.helpers.vectorized.replicator_equation_n_player.html">egttools.helpers.vectorized.replicator_equation_n_player</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.helpers.vectorized.vectorized_barycentric_to_xy_coordinates.html">egttools.helpers.vectorized.vectorized_barycentric_to_xy_coordinates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.helpers.vectorized.vectorized_replicator_equation.html">egttools.helpers.vectorized.vectorized_replicator_equation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.helpers.vectorized.vectorized_replicator_equation_n_player.html">egttools.helpers.vectorized.vectorized_replicator_equation_n_player</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../_autosummary/egttools.numerical.html">egttools.numerical</a><input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" role="switch" type="checkbox"/><label for="toctree-checkbox-30"><div class="visually-hidden">Toggle navigation of egttools.numerical</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.numerical.GeneralPopulationEvolver.html">egttools.numerical.GeneralPopulationEvolver</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.numerical.NetworkEvolver.html">egttools.numerical.NetworkEvolver</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.numerical.PairwiseComparisonNumerical.html">egttools.numerical.PairwiseComparisonNumerical</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/egttools.numerical.numerical_.html">egttools.numerical.numerical_</a><input class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" role="switch" type="checkbox"/><label for="toctree-checkbox-31"><div class="visually-hidden">Toggle navigation of egttools.numerical.numerical_</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.numerical.numerical_.calculate_nb_states.html">egttools.numerical.numerical_.calculate_nb_states</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.numerical.numerical_.calculate_state.html">egttools.numerical.numerical_.calculate_state</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.numerical.numerical_.calculate_strategies_distribution.html">egttools.numerical.numerical_.calculate_strategies_distribution</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.numerical.numerical_.is_blas_lapack_enabled.html">egttools.numerical.numerical_.is_blas_lapack_enabled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.numerical.numerical_.is_openmp_enabled.html">egttools.numerical.numerical_.is_openmp_enabled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.numerical.numerical_.replicator_equation.html">egttools.numerical.numerical_.replicator_equation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.numerical.numerical_.replicator_equation_n_player.html">egttools.numerical.numerical_.replicator_equation_n_player</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.numerical.numerical_.sample_simplex.html">egttools.numerical.numerical_.sample_simplex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.numerical.numerical_.sample_simplex_directly.html">egttools.numerical.numerical_.sample_simplex_directly</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.numerical.numerical_.sample_unit_simplex.html">egttools.numerical.numerical_.sample_unit_simplex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.numerical.numerical_.vectorized_replicator_equation_n_player.html">egttools.numerical.numerical_.vectorized_replicator_equation_n_player</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.numerical.numerical_.GeneralPopulationEvolver.html">egttools.numerical.numerical_.GeneralPopulationEvolver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.numerical.numerical_.NetworkEvolver.html">egttools.numerical.numerical_.NetworkEvolver</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.numerical.numerical_.PairwiseComparison.html">egttools.numerical.numerical_.PairwiseComparison</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.numerical.numerical_.PairwiseComparisonNumerical.html">egttools.numerical.numerical_.PairwiseComparisonNumerical</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/egttools.numerical.structure.html">egttools.numerical.structure</a><input class="toctree-checkbox" id="toctree-checkbox-32" name="toctree-checkbox-32" role="switch" type="checkbox"/><label for="toctree-checkbox-32"><div class="visually-hidden">Toggle navigation of egttools.numerical.structure</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.numerical.structure.AbstractStructure.html">egttools.numerical.structure.AbstractStructure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.numerical.structure.Network.html">egttools.numerical.structure.Network</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.numerical.structure.NetworkGroup.html">egttools.numerical.structure.NetworkGroup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.numerical.structure.NetworkGroupSync.html">egttools.numerical.structure.NetworkGroupSync</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.numerical.structure.NetworkSync.html">egttools.numerical.structure.NetworkSync</a></li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../_autosummary/egttools.numerical.structure.factories.html">egttools.numerical.structure.factories</a><input class="toctree-checkbox" id="toctree-checkbox-33" name="toctree-checkbox-33" role="switch" type="checkbox"/><label for="toctree-checkbox-33"><div class="visually-hidden">Toggle navigation of egttools.numerical.structure.factories</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/egttools.numerical.structure.factories.network_factory.html">egttools.numerical.structure.factories.network_factory</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/egttools.numerical.structure.factories.network_group_factory.html">egttools.numerical.structure.factories.network_group_factory</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/egttools.numerical.structure.factories.network_group_sync_factory.html">egttools.numerical.structure.factories.network_group_sync_factory</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/egttools.numerical.structure.factories.network_sync_factory.html">egttools.numerical.structure.factories.network_sync_factory</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/egttools.numerical.structure.factories.AbstractSpatialGame.html">egttools.numerical.structure.factories.AbstractSpatialGame</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/egttools.numerical.structure.factories.Network.html">egttools.numerical.structure.factories.Network</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/egttools.numerical.structure.factories.NetworkGroup.html">egttools.numerical.structure.factories.NetworkGroup</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/egttools.numerical.structure.factories.NetworkGroupSync.html">egttools.numerical.structure.factories.NetworkGroupSync</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/egttools.numerical.structure.factories.NetworkSync.html">egttools.numerical.structure.factories.NetworkSync</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../_autosummary/egttools.plotting.html">egttools.plotting</a><input class="toctree-checkbox" id="toctree-checkbox-34" name="toctree-checkbox-34" role="switch" type="checkbox"/><label for="toctree-checkbox-34"><div class="visually-hidden">Toggle navigation of egttools.plotting</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.plotting.draw_invasion_diagram.html">egttools.plotting.draw_invasion_diagram</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.plotting.plot_gradient.html">egttools.plotting.plot_gradient</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.plotting.plot_gradients.html">egttools.plotting.plot_gradients</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.plotting.plot_pairwise_comparison_rule_dynamics_in_simplex.html">egttools.plotting.plot_pairwise_comparison_rule_dynamics_in_simplex</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.plotting.plot_pairwise_comparison_rule_dynamics_in_simplex_without_roots.html">egttools.plotting.plot_pairwise_comparison_rule_dynamics_in_simplex_without_roots</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.plotting.plot_replicator_dynamics_in_simplex.html">egttools.plotting.plot_replicator_dynamics_in_simplex</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.plotting.Simplex2D.html">egttools.plotting.Simplex2D</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/egttools.plotting.helpers.html">egttools.plotting.helpers</a><input class="toctree-checkbox" id="toctree-checkbox-35" name="toctree-checkbox-35" role="switch" type="checkbox"/><label for="toctree-checkbox-35"><div class="visually-hidden">Toggle navigation of egttools.plotting.helpers</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.helpers.add_arrow.html">egttools.plotting.helpers.add_arrow</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.helpers.barycentric_to_xy_coordinates.html">egttools.plotting.helpers.barycentric_to_xy_coordinates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.helpers.calculate_nb_states.html">egttools.plotting.helpers.calculate_nb_states</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.helpers.calculate_stability.html">egttools.plotting.helpers.calculate_stability</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.helpers.calculate_stationary_points.html">egttools.plotting.helpers.calculate_stationary_points</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.helpers.check_if_point_in_unit_simplex.html">egttools.plotting.helpers.check_if_point_in_unit_simplex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.helpers.find_roots_in_discrete_barycentric_coordinates.html">egttools.plotting.helpers.find_roots_in_discrete_barycentric_coordinates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.helpers.find_where_point_is_in_simplex.html">egttools.plotting.helpers.find_where_point_is_in_simplex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.helpers.perturb_state.html">egttools.plotting.helpers.perturb_state</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.helpers.perturb_state_discrete.html">egttools.plotting.helpers.perturb_state_discrete</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.helpers.root.html">egttools.plotting.helpers.root</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.helpers.sample_simplex.html">egttools.plotting.helpers.sample_simplex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.helpers.simplex_iterator.html">egttools.plotting.helpers.simplex_iterator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.helpers.xy_to_barycentric_coordinates.html">egttools.plotting.helpers.xy_to_barycentric_coordinates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.helpers.NDArray.html">egttools.plotting.helpers.NDArray</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/egttools.plotting.indicators.html">egttools.plotting.indicators</a><input class="toctree-checkbox" id="toctree-checkbox-36" name="toctree-checkbox-36" role="switch" type="checkbox"/><label for="toctree-checkbox-36"><div class="visually-hidden">Toggle navigation of egttools.plotting.indicators</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.indicators.draw_invasion_diagram.html">egttools.plotting.indicators.draw_invasion_diagram</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.indicators.plot_gradient.html">egttools.plotting.indicators.plot_gradient</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.indicators.plot_gradients.html">egttools.plotting.indicators.plot_gradients</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.indicators.AutoMinorLocator.html">egttools.plotting.indicators.AutoMinorLocator</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/egttools.plotting.simplex2d.html">egttools.plotting.simplex2d</a><input class="toctree-checkbox" id="toctree-checkbox-37" name="toctree-checkbox-37" role="switch" type="checkbox"/><label for="toctree-checkbox-37"><div class="visually-hidden">Toggle navigation of egttools.plotting.simplex2d</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.simplex2d.add_arrow.html">egttools.plotting.simplex2d.add_arrow</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.simplex2d.barycentric_to_xy_coordinates.html">egttools.plotting.simplex2d.barycentric_to_xy_coordinates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.simplex2d.calculate_nb_states.html">egttools.plotting.simplex2d.calculate_nb_states</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.simplex2d.find_where_point_is_in_simplex.html">egttools.plotting.simplex2d.find_where_point_is_in_simplex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.simplex2d.odeint.html">egttools.plotting.simplex2d.odeint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.simplex2d.perturb_state.html">egttools.plotting.simplex2d.perturb_state</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.simplex2d.perturb_state_discrete.html">egttools.plotting.simplex2d.perturb_state_discrete</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.simplex2d.sample_simplex.html">egttools.plotting.simplex2d.sample_simplex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.simplex2d.sample_unit_simplex.html">egttools.plotting.simplex2d.sample_unit_simplex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.simplex2d.xy_to_barycentric_coordinates.html">egttools.plotting.simplex2d.xy_to_barycentric_coordinates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.simplex2d.Circle.html">egttools.plotting.simplex2d.Circle</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.simplex2d.Simplex2D.html">egttools.plotting.simplex2d.Simplex2D</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.simplex2d.TypeVar.html">egttools.plotting.simplex2d.TypeVar</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../_autosummary/egttools.plotting.simplified.html">egttools.plotting.simplified</a><input class="toctree-checkbox" id="toctree-checkbox-38" name="toctree-checkbox-38" role="switch" type="checkbox"/><label for="toctree-checkbox-38"><div class="visually-hidden">Toggle navigation of egttools.plotting.simplified</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.simplified.barycentric_to_xy_coordinates.html">egttools.plotting.simplified.barycentric_to_xy_coordinates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.simplified.calculate_nb_states.html">egttools.plotting.simplified.calculate_nb_states</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.simplified.calculate_stability.html">egttools.plotting.simplified.calculate_stability</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.simplified.check_if_there_is_random_drift.html">egttools.plotting.simplified.check_if_there_is_random_drift</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.simplified.check_replicator_stability_pairwise_games.html">egttools.plotting.simplified.check_replicator_stability_pairwise_games</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.simplified.find_roots.html">egttools.plotting.simplified.find_roots</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.simplified.find_roots_in_discrete_barycentric_coordinates.html">egttools.plotting.simplified.find_roots_in_discrete_barycentric_coordinates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.simplified.plot_pairwise_comparison_rule_dynamics_in_simplex.html">egttools.plotting.simplified.plot_pairwise_comparison_rule_dynamics_in_simplex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.simplified.plot_pairwise_comparison_rule_dynamics_in_simplex_without_roots.html">egttools.plotting.simplified.plot_pairwise_comparison_rule_dynamics_in_simplex_without_roots</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.simplified.plot_replicator_dynamics_in_simplex.html">egttools.plotting.simplified.plot_replicator_dynamics_in_simplex</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.simplified.replicator_equation.html">egttools.plotting.simplified.replicator_equation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.simplified.replicator_equation_n_player.html">egttools.plotting.simplified.replicator_equation_n_player</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.simplified.vectorized_barycentric_to_xy_coordinates.html">egttools.plotting.simplified.vectorized_barycentric_to_xy_coordinates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.simplified.vectorized_replicator_equation.html">egttools.plotting.simplified.vectorized_replicator_equation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.simplified.vectorized_replicator_equation_n_player.html">egttools.plotting.simplified.vectorized_replicator_equation_n_player</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.simplified.xy_to_barycentric_coordinates.html">egttools.plotting.simplified.xy_to_barycentric_coordinates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.simplified.AbstractGame.html">egttools.plotting.simplified.AbstractGame</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.simplified.Matrix2PlayerGameHolder.html">egttools.plotting.simplified.Matrix2PlayerGameHolder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.simplified.MatrixNPlayerGameHolder.html">egttools.plotting.simplified.MatrixNPlayerGameHolder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.simplified.NDArray.html">egttools.plotting.simplified.NDArray</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.simplified.PairwiseComparison.html">egttools.plotting.simplified.PairwiseComparison</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/egttools.plotting.simplified.Simplex2D.html">egttools.plotting.simplified.Simplex2D</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../_autosummary/egttools.utils.html">egttools.utils</a><input class="toctree-checkbox" id="toctree-checkbox-39" name="toctree-checkbox-39" role="switch" type="checkbox"/><label for="toctree-checkbox-39"><div class="visually-hidden">Toggle navigation of egttools.utils</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.utils.calculate_nb_unique_combinations.html">egttools.utils.calculate_nb_unique_combinations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.utils.calculate_stationary_distribution.html">egttools.utils.calculate_stationary_distribution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.utils.calculate_stationary_distribution_non_hermitian.html">egttools.utils.calculate_stationary_distribution_non_hermitian</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.utils.combine.html">egttools.utils.combine</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.utils.eigvals.html">egttools.utils.eigvals</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.utils.find_saddle_type_and_gradient_direction.html">egttools.utils.find_saddle_type_and_gradient_direction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.utils.get_payoff_function.html">egttools.utils.get_payoff_function</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.utils.schur.html">egttools.utils.schur</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.utils.transform_graph_to_dict_of_lists.html">egttools.utils.transform_graph_to_dict_of_lists</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.utils.transform_payoffs_to_pairwise.html">egttools.utils.transform_payoffs_to_pairwise</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.utils.warn.html">egttools.utils.warn</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.utils.AbstractGame.html">egttools.utils.AbstractGame</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.utils.Graph.html">egttools.utils.Graph</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.utils.csc_matrix.html">egttools.utils.csc_matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/egttools.utils.csr_matrix.html">egttools.utils.csr_matrix</a></li>
</ul>
</li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <h1>Source code for matplotlib.patches</h1><div class="highlight"><pre>
<span></span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Patches are `.Artist`\s with a face color and an edge color.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">functools</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">inspect</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">numbers</span><span class="w"> </span><span class="kn">import</span> <span class="n">Number</span><span class="p">,</span> <span class="n">Real</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">textwrap</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">types</span><span class="w"> </span><span class="kn">import</span> <span class="n">SimpleNamespace</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">namedtuple</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.transforms</span><span class="w"> </span><span class="kn">import</span> <span class="n">Affine2D</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mpl</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span><span class="n">_api</span><span class="p">,</span> <span class="n">artist</span><span class="p">,</span> <span class="n">cbook</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">_docstring</span><span class="p">,</span> <span class="n">hatch</span> <span class="k">as</span> <span class="n">mhatch</span><span class="p">,</span>
               <span class="n">lines</span> <span class="k">as</span> <span class="n">mlines</span><span class="p">,</span> <span class="n">transforms</span><span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.bezier</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">NonIntersectingPathException</span><span class="p">,</span> <span class="n">get_cos_sin</span><span class="p">,</span> <span class="n">get_intersection</span><span class="p">,</span>
    <span class="n">get_parallels</span><span class="p">,</span> <span class="n">inside_circle</span><span class="p">,</span> <span class="n">make_wedged_bezier2</span><span class="p">,</span>
    <span class="n">split_bezier_intersecting_with_closedpath</span><span class="p">,</span> <span class="n">split_path_inout</span><span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.path</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">._enums</span><span class="w"> </span><span class="kn">import</span> <span class="n">JoinStyle</span><span class="p">,</span> <span class="n">CapStyle</span>


<span class="nd">@_docstring</span><span class="o">.</span><span class="n">interpd</span>
<span class="nd">@_api</span><span class="o">.</span><span class="n">define_aliases</span><span class="p">({</span>
    <span class="s2">&quot;antialiased&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;aa&quot;</span><span class="p">],</span>
    <span class="s2">&quot;edgecolor&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;ec&quot;</span><span class="p">],</span>
    <span class="s2">&quot;facecolor&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;fc&quot;</span><span class="p">],</span>
    <span class="s2">&quot;linestyle&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;ls&quot;</span><span class="p">],</span>
    <span class="s2">&quot;linewidth&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;lw&quot;</span><span class="p">],</span>
<span class="p">})</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Patch</span><span class="p">(</span><span class="n">artist</span><span class="o">.</span><span class="n">Artist</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A patch is a 2D artist with a face color and an edge color.</span>

<span class="sd">    If any of *edgecolor*, *facecolor*, *linewidth*, or *antialiased*</span>
<span class="sd">    are *None*, they default to their rc params setting.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">zorder</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="c1"># Whether to draw an edge by default.  Set on a</span>
    <span class="c1"># subclass-by-subclass basis.</span>
    <span class="n">_edge_default</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                 <span class="n">edgecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">facecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">linewidth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">linestyle</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">antialiased</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">hatch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">capstyle</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">joinstyle</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The following kwarg properties are supported</span>

<span class="sd">        %(Patch:kwdoc)s</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">linestyle</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">linestyle</span> <span class="o">=</span> <span class="s2">&quot;solid&quot;</span>
        <span class="k">if</span> <span class="n">capstyle</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">capstyle</span> <span class="o">=</span> <span class="n">CapStyle</span><span class="o">.</span><span class="n">butt</span>
        <span class="k">if</span> <span class="n">joinstyle</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">joinstyle</span> <span class="o">=</span> <span class="n">JoinStyle</span><span class="o">.</span><span class="n">miter</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_hatch_color</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">to_rgba</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;hatch.color&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hatch_linewidth</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;hatch.linewidth&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fill</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">fill</span><span class="p">)</span>  <span class="c1"># needed for set_facecolor call</span>
        <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">edgecolor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">facecolor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">_api</span><span class="o">.</span><span class="n">warn_external</span><span class="p">(</span>
                    <span class="s2">&quot;Setting the &#39;color&#39; property will override &quot;</span>
                    <span class="s2">&quot;the edgecolor or facecolor properties.&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_edgecolor</span><span class="p">(</span><span class="n">edgecolor</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="n">facecolor</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_linewidth</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_unscaled_dash_pattern</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>  <span class="c1"># offset, dash</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dash_pattern</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>  <span class="c1"># offset, dash (scaled by linewidth)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_linestyle</span><span class="p">(</span><span class="n">linestyle</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="n">linewidth</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_antialiased</span><span class="p">(</span><span class="n">antialiased</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_hatch</span><span class="p">(</span><span class="n">hatch</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_capstyle</span><span class="p">(</span><span class="n">capstyle</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_joinstyle</span><span class="p">(</span><span class="n">joinstyle</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_internal_update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_verts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a copy of the vertices used in this patch.</span>

<span class="sd">        If the patch contains Bézier curves, the curves will be interpolated by</span>
<span class="sd">        line segments.  To access the curves as curves, use `get_path`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">trans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_transform</span><span class="p">()</span>
        <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_path</span><span class="p">()</span>
        <span class="n">polygons</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">to_polygons</span><span class="p">(</span><span class="n">trans</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">polygons</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">polygons</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_process_radius</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">radius</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">radius</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">radius</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_picker</span><span class="p">,</span> <span class="n">Number</span><span class="p">):</span>
            <span class="n">_radius</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_picker</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_edgecolor</span><span class="p">()[</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">_radius</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">_radius</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_linewidth</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">_radius</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">contains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mouseevent</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Test whether the mouse event occurred in the patch.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        mouseevent : `~matplotlib.backend_bases.MouseEvent`</span>
<span class="sd">            Where the user clicked.</span>

<span class="sd">        radius : float, optional</span>
<span class="sd">            Additional margin on the patch in target coordinates of</span>
<span class="sd">            `.Patch.get_transform`. See `.Path.contains_point` for further</span>
<span class="sd">            details.</span>

<span class="sd">            If `None`, the default value depends on the state of the object:</span>

<span class="sd">            - If `.Artist.get_picker` is a number, the default</span>
<span class="sd">              is that value.  This is so that picking works as expected.</span>
<span class="sd">            - Otherwise if the edge color has a non-zero alpha, the default</span>
<span class="sd">              is half of the linewidth.  This is so that all the colored</span>
<span class="sd">              pixels are &quot;in&quot; the patch.</span>
<span class="sd">            - Finally, if the edge has 0 alpha, the default is 0.  This is</span>
<span class="sd">              so that patches without a stroked edge do not have points</span>
<span class="sd">              outside of the filled region report as &quot;in&quot; due to an</span>
<span class="sd">              invisible edge.</span>


<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        (bool, empty dict)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_different_canvas</span><span class="p">(</span><span class="n">mouseevent</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="p">{}</span>
        <span class="n">radius</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_process_radius</span><span class="p">(</span><span class="n">radius</span><span class="p">)</span>
        <span class="n">codes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_path</span><span class="p">()</span><span class="o">.</span><span class="n">codes</span>
        <span class="k">if</span> <span class="n">codes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">vertices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_path</span><span class="p">()</span><span class="o">.</span><span class="n">vertices</span>
            <span class="c1"># if the current path is concatenated by multiple sub paths.</span>
            <span class="c1"># get the indexes of the starting code(MOVETO) of all sub paths</span>
            <span class="n">idxs</span><span class="p">,</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">codes</span> <span class="o">==</span> <span class="n">Path</span><span class="o">.</span><span class="n">MOVETO</span><span class="p">)</span>
            <span class="c1"># Don&#39;t split before the first MOVETO.</span>
            <span class="n">idxs</span> <span class="o">=</span> <span class="n">idxs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
            <span class="n">subpaths</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span>
                <span class="n">Path</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span> <span class="n">idxs</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">codes</span><span class="p">,</span> <span class="n">idxs</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">subpaths</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_path</span><span class="p">()]</span>
        <span class="n">inside</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="n">subpath</span><span class="o">.</span><span class="n">contains_point</span><span class="p">(</span>
                <span class="p">(</span><span class="n">mouseevent</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">mouseevent</span><span class="o">.</span><span class="n">y</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_transform</span><span class="p">(),</span> <span class="n">radius</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">subpath</span> <span class="ow">in</span> <span class="n">subpaths</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">inside</span><span class="p">,</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">contains_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return whether the given point is inside the patch.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        point : (float, float)</span>
<span class="sd">            The point (x, y) to check, in target coordinates of</span>
<span class="sd">            ``.Patch.get_transform()``. These are display coordinates for patches</span>
<span class="sd">            that are added to a figure or Axes.</span>
<span class="sd">        radius : float, optional</span>
<span class="sd">            Additional margin on the patch in target coordinates of</span>
<span class="sd">            `.Patch.get_transform`. See `.Path.contains_point` for further</span>
<span class="sd">            details.</span>

<span class="sd">            If `None`, the default value depends on the state of the object:</span>

<span class="sd">            - If `.Artist.get_picker` is a number, the default</span>
<span class="sd">              is that value.  This is so that picking works as expected.</span>
<span class="sd">            - Otherwise if the edge color has a non-zero alpha, the default</span>
<span class="sd">              is half of the linewidth.  This is so that all the colored</span>
<span class="sd">              pixels are &quot;in&quot; the patch.</span>
<span class="sd">            - Finally, if the edge has 0 alpha, the default is 0.  This is</span>
<span class="sd">              so that patches without a stroked edge do not have points</span>
<span class="sd">              outside of the filled region report as &quot;in&quot; due to an</span>
<span class="sd">              invisible edge.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The proper use of this method depends on the transform of the patch.</span>
<span class="sd">        Isolated patches do not have a transform. In this case, the patch</span>
<span class="sd">        creation coordinates and the point coordinates match. The following</span>
<span class="sd">        example checks that the center of a circle is within the circle</span>

<span class="sd">        &gt;&gt;&gt; center = 0, 0</span>
<span class="sd">        &gt;&gt;&gt; c = Circle(center, radius=1)</span>
<span class="sd">        &gt;&gt;&gt; c.contains_point(center)</span>
<span class="sd">        True</span>

<span class="sd">        The convention of checking against the transformed patch stems from</span>
<span class="sd">        the fact that this method is predominantly used to check if display</span>
<span class="sd">        coordinates (e.g. from mouse events) are within the patch. If you want</span>
<span class="sd">        to do the above check with data coordinates, you have to properly</span>
<span class="sd">        transform them first:</span>

<span class="sd">        &gt;&gt;&gt; center = 0, 0</span>
<span class="sd">        &gt;&gt;&gt; c = Circle(center, radius=3)</span>
<span class="sd">        &gt;&gt;&gt; plt.gca().add_patch(c)</span>
<span class="sd">        &gt;&gt;&gt; transformed_interior_point = c.get_data_transform().transform((0, 2))</span>
<span class="sd">        &gt;&gt;&gt; c.contains_point(transformed_interior_point)</span>
<span class="sd">        True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">radius</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_process_radius</span><span class="p">(</span><span class="n">radius</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_path</span><span class="p">()</span><span class="o">.</span><span class="n">contains_point</span><span class="p">(</span><span class="n">point</span><span class="p">,</span>
                                              <span class="bp">self</span><span class="o">.</span><span class="n">get_transform</span><span class="p">(),</span>
                                              <span class="n">radius</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">contains_points</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return whether the given points are inside the patch.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        points : (N, 2) array</span>
<span class="sd">            The points to check, in target coordinates of</span>
<span class="sd">            ``self.get_transform()``. These are display coordinates for patches</span>
<span class="sd">            that are added to a figure or Axes. Columns contain x and y values.</span>
<span class="sd">        radius : float, optional</span>
<span class="sd">            Additional margin on the patch in target coordinates of</span>
<span class="sd">            `.Patch.get_transform`. See `.Path.contains_point` for further</span>
<span class="sd">            details.</span>

<span class="sd">            If `None`, the default value depends on the state of the object:</span>

<span class="sd">            - If `.Artist.get_picker` is a number, the default</span>
<span class="sd">              is that value.  This is so that picking works as expected.</span>
<span class="sd">            - Otherwise if the edge color has a non-zero alpha, the default</span>
<span class="sd">              is half of the linewidth.  This is so that all the colored</span>
<span class="sd">              pixels are &quot;in&quot; the patch.</span>
<span class="sd">            - Finally, if the edge has 0 alpha, the default is 0.  This is</span>
<span class="sd">              so that patches without a stroked edge do not have points</span>
<span class="sd">              outside of the filled region report as &quot;in&quot; due to an</span>
<span class="sd">              invisible edge.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        length-N bool array</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The proper use of this method depends on the transform of the patch.</span>
<span class="sd">        See the notes on `.Patch.contains_point`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">radius</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_process_radius</span><span class="p">(</span><span class="n">radius</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_path</span><span class="p">()</span><span class="o">.</span><span class="n">contains_points</span><span class="p">(</span><span class="n">points</span><span class="p">,</span>
                                               <span class="bp">self</span><span class="o">.</span><span class="n">get_transform</span><span class="p">(),</span>
                                               <span class="n">radius</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update_from</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="c1"># docstring inherited.</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">update_from</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="c1"># For some properties we don&#39;t need or don&#39;t want to go through the</span>
        <span class="c1"># getters/setters, so we just copy them directly.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_edgecolor</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">_edgecolor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_facecolor</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">_facecolor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_original_edgecolor</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">_original_edgecolor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_original_facecolor</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">_original_facecolor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fill</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">_fill</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hatch</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">_hatch</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hatch_color</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">_hatch_color</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_unscaled_dash_pattern</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">_unscaled_dash_pattern</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">_linewidth</span><span class="p">)</span>  <span class="c1"># also sets scaled dashes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_transform</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">get_data_transform</span><span class="p">())</span>
        <span class="c1"># If the transform of other needs further initialization, then it will</span>
        <span class="c1"># be the case for this artist too.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_transformSet</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">is_transform_set</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_extents</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the `Patch`&#39;s axis-aligned extents as a `~.transforms.Bbox`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_path</span><span class="p">()</span><span class="o">.</span><span class="n">get_extents</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_transform</span><span class="p">())</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the `~.transforms.Transform` applied to the `Patch`.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_patch_transform</span><span class="p">()</span> <span class="o">+</span> <span class="n">artist</span><span class="o">.</span><span class="n">Artist</span><span class="o">.</span><span class="n">get_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_data_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the `~.transforms.Transform` mapping data coordinates to</span>
<span class="sd">        physical coordinates.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">artist</span><span class="o">.</span><span class="n">Artist</span><span class="o">.</span><span class="n">get_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_patch_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the `~.transforms.Transform` instance mapping patch coordinates</span>
<span class="sd">        to data coordinates.</span>

<span class="sd">        For example, one may define a patch of a circle which represents a</span>
<span class="sd">        radius of 5 by providing coordinates for a unit circle, and a</span>
<span class="sd">        transform which scales the coordinates (the patch coordinate) by 5.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">transforms</span><span class="o">.</span><span class="n">IdentityTransform</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_antialiased</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return whether antialiasing is used for drawing.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_antialiased</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_edgecolor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the edge color.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_edgecolor</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_facecolor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the face color.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_facecolor</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_linewidth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the line width in points.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_linewidth</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_linestyle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the linestyle.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_linestyle</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_antialiased</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aa</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set whether to use antialiased rendering.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        aa : bool or None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">aa</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">aa</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;patch.antialiased&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_antialiased</span> <span class="o">=</span> <span class="n">aa</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_set_edgecolor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
        <span class="n">set_hatch_color</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;patch.force_edgecolor&#39;</span><span class="p">]</span> <span class="ow">or</span>
                    <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fill</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_edge_default</span><span class="p">):</span>
                <span class="n">color</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;patch.edgecolor&#39;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span>
                <span class="n">set_hatch_color</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_edgecolor</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">to_rgba</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_alpha</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">set_hatch_color</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_hatch_color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_edgecolor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_edgecolor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the patch edge color.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        color : :mpltype:`color` or None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_original_edgecolor</span> <span class="o">=</span> <span class="n">color</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_edgecolor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_set_facecolor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">color</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;patch.facecolor&#39;</span><span class="p">]</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_alpha</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fill</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_facecolor</span> <span class="o">=</span> <span class="n">colors</span><span class="o">.</span><span class="n">to_rgba</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_facecolor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the patch face color.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        color : :mpltype:`color` or None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_original_facecolor</span> <span class="o">=</span> <span class="n">color</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_facecolor</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_color</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set both the edgecolor and the facecolor.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        c : :mpltype:`color`</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        Patch.set_facecolor, Patch.set_edgecolor</span>
<span class="sd">            For setting the edge or face color individually.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_edgecolor</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_alpha</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alpha</span><span class="p">):</span>
        <span class="c1"># docstring inherited</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_facecolor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_original_facecolor</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_edgecolor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_original_edgecolor</span><span class="p">)</span>
        <span class="c1"># stale is already True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_linewidth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">w</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the patch linewidth in points.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        w : float or None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">w</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">w</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;patch.linewidth&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_linewidth</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dash_pattern</span> <span class="o">=</span> <span class="n">mlines</span><span class="o">.</span><span class="n">_scale_dashes</span><span class="p">(</span>
            <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_unscaled_dash_pattern</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_linestyle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ls</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the patch linestyle.</span>

<span class="sd">        ==========================================  =================</span>
<span class="sd">        linestyle                                   description</span>
<span class="sd">        ==========================================  =================</span>
<span class="sd">        ``&#39;-&#39;`` or ``&#39;solid&#39;``                      solid line</span>
<span class="sd">        ``&#39;--&#39;`` or  ``&#39;dashed&#39;``                   dashed line</span>
<span class="sd">        ``&#39;-.&#39;`` or  ``&#39;dashdot&#39;``                  dash-dotted line</span>
<span class="sd">        ``&#39;:&#39;`` or ``&#39;dotted&#39;``                     dotted line</span>
<span class="sd">        ``&#39;none&#39;``, ``&#39;None&#39;``, ``&#39; &#39;``, or ``&#39;&#39;``  draw nothing</span>
<span class="sd">        ==========================================  =================</span>

<span class="sd">        Alternatively a dash tuple of the following form can be provided::</span>

<span class="sd">            (offset, onoffseq)</span>

<span class="sd">        where ``onoffseq`` is an even length tuple of on and off ink in points.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ls : {&#39;-&#39;, &#39;--&#39;, &#39;-.&#39;, &#39;:&#39;, &#39;&#39;, (offset, on-off-seq), ...}</span>
<span class="sd">            The line style.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ls</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ls</span> <span class="o">=</span> <span class="s2">&quot;solid&quot;</span>
        <span class="k">if</span> <span class="n">ls</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;none&#39;</span><span class="p">]:</span>
            <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;None&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_linestyle</span> <span class="o">=</span> <span class="n">ls</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_unscaled_dash_pattern</span> <span class="o">=</span> <span class="n">mlines</span><span class="o">.</span><span class="n">_get_dash_pattern</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dash_pattern</span> <span class="o">=</span> <span class="n">mlines</span><span class="o">.</span><span class="n">_scale_dashes</span><span class="p">(</span>
            <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_unscaled_dash_pattern</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_linewidth</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_fill</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set whether to fill the patch.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        b : bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fill</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_facecolor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_original_facecolor</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_edgecolor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_original_edgecolor</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_fill</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return whether the patch is filled.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fill</span>

    <span class="c1"># Make fill a property so as to preserve the long-standing</span>
    <span class="c1"># but somewhat inconsistent behavior in which fill was an</span>
    <span class="c1"># attribute.</span>
    <span class="n">fill</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_fill</span><span class="p">,</span> <span class="n">set_fill</span><span class="p">)</span>

    <span class="nd">@_docstring</span><span class="o">.</span><span class="n">interpd</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_capstyle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the `.CapStyle`.</span>

<span class="sd">        The default capstyle is &#39;round&#39; for `.FancyArrowPatch` and &#39;butt&#39; for</span>
<span class="sd">        all other patches.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s : `.CapStyle` or %(CapStyle)s</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cs</span> <span class="o">=</span> <span class="n">CapStyle</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_capstyle</span> <span class="o">=</span> <span class="n">cs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_capstyle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the capstyle.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_capstyle</span><span class="o">.</span><span class="n">name</span>

    <span class="nd">@_docstring</span><span class="o">.</span><span class="n">interpd</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_joinstyle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the `.JoinStyle`.</span>

<span class="sd">        The default joinstyle is &#39;round&#39; for `.FancyArrowPatch` and &#39;miter&#39; for</span>
<span class="sd">        all other patches.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        s : `.JoinStyle` or %(JoinStyle)s</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">js</span> <span class="o">=</span> <span class="n">JoinStyle</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_joinstyle</span> <span class="o">=</span> <span class="n">js</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_joinstyle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the joinstyle.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_joinstyle</span><span class="o">.</span><span class="n">name</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_hatch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hatch</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the hatching pattern.</span>

<span class="sd">        *hatch* can be one of::</span>

<span class="sd">          /   - diagonal hatching</span>
<span class="sd">          \   - back diagonal</span>
<span class="sd">          |   - vertical</span>
<span class="sd">          -   - horizontal</span>
<span class="sd">          +   - crossed</span>
<span class="sd">          x   - crossed diagonal</span>
<span class="sd">          o   - small circle</span>
<span class="sd">          O   - large circle</span>
<span class="sd">          .   - dots</span>
<span class="sd">          *   - stars</span>

<span class="sd">        Letters can be combined, in which case all the specified</span>
<span class="sd">        hatchings are done.  If same letter repeats, it increases the</span>
<span class="sd">        density of hatching of that pattern.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        hatch : {&#39;/&#39;, &#39;\\&#39;, &#39;|&#39;, &#39;-&#39;, &#39;+&#39;, &#39;x&#39;, &#39;o&#39;, &#39;O&#39;, &#39;.&#39;, &#39;*&#39;}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Use validate_hatch(list) after deprecation.</span>
        <span class="n">mhatch</span><span class="o">.</span><span class="n">_validate_hatch_pattern</span><span class="p">(</span><span class="n">hatch</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hatch</span> <span class="o">=</span> <span class="n">hatch</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_hatch</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the hatching pattern.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hatch</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_hatch_linewidth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lw</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the hatch linewidth.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hatch_linewidth</span> <span class="o">=</span> <span class="n">lw</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_hatch_linewidth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the hatch linewidth.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hatch_linewidth</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_draw_paths_with_artist_properties</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">,</span> <span class="n">draw_path_args_list</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ``draw()`` helper factored out for sharing with `FancyArrowPatch`.</span>

<span class="sd">        Configure *renderer* and the associated graphics context *gc*</span>
<span class="sd">        from the artist properties, then repeatedly call</span>
<span class="sd">        ``renderer.draw_path(gc, *draw_path_args)`` for each tuple</span>
<span class="sd">        *draw_path_args* in *draw_path_args_list*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">renderer</span><span class="o">.</span><span class="n">open_group</span><span class="p">(</span><span class="s1">&#39;patch&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_gid</span><span class="p">())</span>
        <span class="n">gc</span> <span class="o">=</span> <span class="n">renderer</span><span class="o">.</span><span class="n">new_gc</span><span class="p">()</span>

        <span class="n">gc</span><span class="o">.</span><span class="n">set_foreground</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_edgecolor</span><span class="p">,</span> <span class="n">isRGBA</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">lw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_linewidth</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_edgecolor</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_linestyle</span> <span class="o">==</span> <span class="s1">&#39;None&#39;</span><span class="p">:</span>
            <span class="n">lw</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">gc</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="n">lw</span><span class="p">)</span>
        <span class="n">gc</span><span class="o">.</span><span class="n">set_dashes</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_dash_pattern</span><span class="p">)</span>
        <span class="n">gc</span><span class="o">.</span><span class="n">set_capstyle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_capstyle</span><span class="p">)</span>
        <span class="n">gc</span><span class="o">.</span><span class="n">set_joinstyle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_joinstyle</span><span class="p">)</span>

        <span class="n">gc</span><span class="o">.</span><span class="n">set_antialiased</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_antialiased</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_gc_clip</span><span class="p">(</span><span class="n">gc</span><span class="p">)</span>
        <span class="n">gc</span><span class="o">.</span><span class="n">set_url</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_url</span><span class="p">)</span>
        <span class="n">gc</span><span class="o">.</span><span class="n">set_snap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_snap</span><span class="p">())</span>

        <span class="n">gc</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_alpha</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hatch</span><span class="p">:</span>
            <span class="n">gc</span><span class="o">.</span><span class="n">set_hatch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_hatch</span><span class="p">)</span>
            <span class="n">gc</span><span class="o">.</span><span class="n">set_hatch_color</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_hatch_color</span><span class="p">)</span>
            <span class="n">gc</span><span class="o">.</span><span class="n">set_hatch_linewidth</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_hatch_linewidth</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_sketch_params</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">gc</span><span class="o">.</span><span class="n">set_sketch_params</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">get_sketch_params</span><span class="p">())</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_path_effects</span><span class="p">():</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.patheffects</span><span class="w"> </span><span class="kn">import</span> <span class="n">PathEffectRenderer</span>
            <span class="n">renderer</span> <span class="o">=</span> <span class="n">PathEffectRenderer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_path_effects</span><span class="p">(),</span> <span class="n">renderer</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">draw_path_args</span> <span class="ow">in</span> <span class="n">draw_path_args_list</span><span class="p">:</span>
            <span class="n">renderer</span><span class="o">.</span><span class="n">draw_path</span><span class="p">(</span><span class="n">gc</span><span class="p">,</span> <span class="o">*</span><span class="n">draw_path_args</span><span class="p">)</span>

        <span class="n">gc</span><span class="o">.</span><span class="n">restore</span><span class="p">()</span>
        <span class="n">renderer</span><span class="o">.</span><span class="n">close_group</span><span class="p">(</span><span class="s1">&#39;patch&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="nd">@artist</span><span class="o">.</span><span class="n">allow_rasterization</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">):</span>
        <span class="c1"># docstring inherited</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_visible</span><span class="p">():</span>
            <span class="k">return</span>
        <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_path</span><span class="p">()</span>
        <span class="n">transform</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_transform</span><span class="p">()</span>
        <span class="n">tpath</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">transform_path_non_affine</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="n">affine</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">get_affine</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_draw_paths_with_artist_properties</span><span class="p">(</span>
            <span class="n">renderer</span><span class="p">,</span>
            <span class="p">[(</span><span class="n">tpath</span><span class="p">,</span> <span class="n">affine</span><span class="p">,</span>
              <span class="c1"># Work around a bug in the PDF and SVG renderers, which</span>
              <span class="c1"># do not draw the hatches if the facecolor is fully</span>
              <span class="c1"># transparent, but do if it is None.</span>
              <span class="bp">self</span><span class="o">.</span><span class="n">_facecolor</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_facecolor</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)])</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the path of this patch.&quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;Derived must override&#39;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_window_extent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_path</span><span class="p">()</span><span class="o">.</span><span class="n">get_extents</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_transform</span><span class="p">())</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_convert_xy_units</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xy</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert x and y units for a tuple (x, y).&quot;&quot;&quot;</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_xunits</span><span class="p">(</span><span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_yunits</span><span class="p">(</span><span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>


<span class="k">class</span><span class="w"> </span><span class="nc">Shadow</span><span class="p">(</span><span class="n">Patch</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Shadow(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">patch</span><span class="si">}</span><span class="s2">)&quot;</span>

    <span class="nd">@_docstring</span><span class="o">.</span><span class="n">interpd</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">patch</span><span class="p">,</span> <span class="n">ox</span><span class="p">,</span> <span class="n">oy</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">shade</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a shadow of the given *patch*.</span>

<span class="sd">        By default, the shadow will have the same face color as the *patch*,</span>
<span class="sd">        but darkened. The darkness can be controlled by *shade*.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        patch : `~matplotlib.patches.Patch`</span>
<span class="sd">            The patch to create the shadow for.</span>
<span class="sd">        ox, oy : float</span>
<span class="sd">            The shift of the shadow in data coordinates, scaled by a factor</span>
<span class="sd">            of dpi/72.</span>
<span class="sd">        shade : float, default: 0.7</span>
<span class="sd">            How the darkness of the shadow relates to the original color. If 1, the</span>
<span class="sd">            shadow is black, if 0, the shadow has the same color as the *patch*.</span>

<span class="sd">            .. versionadded:: 3.8</span>

<span class="sd">        **kwargs</span>
<span class="sd">            Properties of the shadow patch. Supported keys are:</span>

<span class="sd">            %(Patch:kwdoc)s</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">patch</span> <span class="o">=</span> <span class="n">patch</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ox</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_oy</span> <span class="o">=</span> <span class="n">ox</span><span class="p">,</span> <span class="n">oy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shadow_transform</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Affine2D</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_from</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">patch</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">shade</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;shade must be between 0 and 1.&quot;</span><span class="p">)</span>
        <span class="n">color</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">shade</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">colors</span><span class="o">.</span><span class="n">to_rgb</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">get_facecolor</span><span class="p">()))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;facecolor&#39;</span><span class="p">:</span> <span class="n">color</span><span class="p">,</span> <span class="s1">&#39;edgecolor&#39;</span><span class="p">:</span> <span class="n">color</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
                     <span class="c1"># Place shadow patch directly behind the inherited patch.</span>
                     <span class="s1">&#39;zorder&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">nextafter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">zorder</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">),</span>
                     <span class="o">**</span><span class="n">kwargs</span><span class="p">})</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_update_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">):</span>
        <span class="n">ox</span> <span class="o">=</span> <span class="n">renderer</span><span class="o">.</span><span class="n">points_to_pixels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ox</span><span class="p">)</span>
        <span class="n">oy</span> <span class="o">=</span> <span class="n">renderer</span><span class="o">.</span><span class="n">points_to_pixels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_oy</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shadow_transform</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">ox</span><span class="p">,</span> <span class="n">oy</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">get_path</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_patch_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">get_patch_transform</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shadow_transform</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_transform</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>


<span class="k">class</span><span class="w"> </span><span class="nc">Rectangle</span><span class="p">(</span><span class="n">Patch</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A rectangle defined via an anchor point *xy* and its *width* and *height*.</span>

<span class="sd">    The rectangle extends from ``xy[0]`` to ``xy[0] + width`` in x-direction</span>
<span class="sd">    and from ``xy[1]`` to ``xy[1] + height`` in y-direction. ::</span>

<span class="sd">      :                +------------------+</span>
<span class="sd">      :                |                  |</span>
<span class="sd">      :              height               |</span>
<span class="sd">      :                |                  |</span>
<span class="sd">      :               (xy)---- width -----+</span>

<span class="sd">    One may picture *xy* as the bottom left corner, but which corner *xy* is</span>
<span class="sd">    actually depends on the direction of the axis and the sign of *width*</span>
<span class="sd">    and *height*; e.g. *xy* would be the bottom right corner if the x-axis</span>
<span class="sd">    was inverted or if *width* was negative.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">pars</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle</span>
        <span class="n">fmt</span> <span class="o">=</span> <span class="s2">&quot;Rectangle(xy=(</span><span class="si">%g</span><span class="s2">, </span><span class="si">%g</span><span class="s2">), width=</span><span class="si">%g</span><span class="s2">, height=</span><span class="si">%g</span><span class="s2">, angle=</span><span class="si">%g</span><span class="s2">)&quot;</span>
        <span class="k">return</span> <span class="n">fmt</span> <span class="o">%</span> <span class="n">pars</span>

    <span class="nd">@_docstring</span><span class="o">.</span><span class="n">interpd</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xy</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                 <span class="n">angle</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">rotation_point</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        xy : (float, float)</span>
<span class="sd">            The anchor point.</span>
<span class="sd">        width : float</span>
<span class="sd">            Rectangle width.</span>
<span class="sd">        height : float</span>
<span class="sd">            Rectangle height.</span>
<span class="sd">        angle : float, default: 0</span>
<span class="sd">            Rotation in degrees anti-clockwise about the rotation point.</span>
<span class="sd">        rotation_point : {&#39;xy&#39;, &#39;center&#39;, (number, number)}, default: &#39;xy&#39;</span>
<span class="sd">            If ``&#39;xy&#39;``, rotate around the anchor point. If ``&#39;center&#39;`` rotate</span>
<span class="sd">            around the center. If 2-tuple of number, rotate around this</span>
<span class="sd">            coordinate.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        **kwargs : `~matplotlib.patches.Patch` properties</span>
<span class="sd">            %(Patch:kwdoc)s</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_x0</span> <span class="o">=</span> <span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_y0</span> <span class="o">=</span> <span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_width</span> <span class="o">=</span> <span class="n">width</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_height</span> <span class="o">=</span> <span class="n">height</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">angle</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rotation_point</span> <span class="o">=</span> <span class="n">rotation_point</span>
        <span class="c1"># Required for RectangleSelector with axes aspect ratio != 1</span>
        <span class="c1"># The patch is defined in data coordinates and when changing the</span>
        <span class="c1"># selector with square modifier and not in data coordinates, we need</span>
        <span class="c1"># to correct for the aspect ratio difference between the data and</span>
        <span class="c1"># display coordinate systems. Its value is typically provide by</span>
        <span class="c1"># Axes._get_aspect_ratio()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_aspect_ratio_correction</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_convert_units</span><span class="p">()</span>  <span class="c1"># Validate the inputs.</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the vertices of the rectangle.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Path</span><span class="o">.</span><span class="n">unit_rectangle</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_convert_units</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert bounds of the rectangle.&quot;&quot;&quot;</span>
        <span class="n">x0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_xunits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_x0</span><span class="p">)</span>
        <span class="n">y0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_yunits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_y0</span><span class="p">)</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_xunits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_x0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_width</span><span class="p">)</span>
        <span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_yunits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_y0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_height</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_patch_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Note: This cannot be called until after this has been added to</span>
        <span class="c1"># an Axes, otherwise unit conversion will fail. This makes it very</span>
        <span class="c1"># important to call the accessor method and not directly access the</span>
        <span class="c1"># transformation member variable.</span>
        <span class="n">bbox</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bbox</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation_point</span> <span class="o">==</span> <span class="s1">&#39;center&#39;</span><span class="p">:</span>
            <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">bbox</span><span class="o">.</span><span class="n">x1</span> <span class="o">-</span> <span class="n">bbox</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span> <span class="n">bbox</span><span class="o">.</span><span class="n">y1</span> <span class="o">-</span> <span class="n">bbox</span><span class="o">.</span><span class="n">y0</span>
            <span class="n">rotation_point</span> <span class="o">=</span> <span class="n">bbox</span><span class="o">.</span><span class="n">x0</span> <span class="o">+</span> <span class="n">width</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">,</span> <span class="n">bbox</span><span class="o">.</span><span class="n">y0</span> <span class="o">+</span> <span class="n">height</span> <span class="o">/</span> <span class="mf">2.</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation_point</span> <span class="o">==</span> <span class="s1">&#39;xy&#39;</span><span class="p">:</span>
            <span class="n">rotation_point</span> <span class="o">=</span> <span class="n">bbox</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span> <span class="n">bbox</span><span class="o">.</span><span class="n">y0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rotation_point</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation_point</span>
        <span class="k">return</span> <span class="n">transforms</span><span class="o">.</span><span class="n">BboxTransformTo</span><span class="p">(</span><span class="n">bbox</span><span class="p">)</span> \
                <span class="o">+</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Affine2D</span><span class="p">()</span> \
                <span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="o">-</span><span class="n">rotation_point</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="n">rotation_point</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> \
                <span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aspect_ratio_correction</span><span class="p">)</span> \
                <span class="o">.</span><span class="n">rotate_deg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angle</span><span class="p">)</span> \
                <span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aspect_ratio_correction</span><span class="p">)</span> \
                <span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="o">*</span><span class="n">rotation_point</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">rotation_point</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The rotation point of the patch.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rotation_point</span>

    <span class="nd">@rotation_point</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">rotation_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="s1">&#39;xy&#39;</span><span class="p">]</span> <span class="ow">or</span> <span class="p">(</span>
                <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span>
                <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Real</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">Real</span><span class="p">)</span>
                <span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rotation_point</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`rotation_point` must be one of &quot;</span>
                             <span class="s2">&quot;{&#39;xy&#39;, &#39;center&#39;, (number, number)}.&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the left coordinate of the rectangle.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x0</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_y</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the bottom coordinate of the rectangle.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y0</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_xy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the left and bottom coords of the rectangle as a tuple.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y0</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_corners</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the corners of the rectangle, moving anti-clockwise from</span>
<span class="sd">        (x0, y0).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_patch_transform</span><span class="p">()</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
            <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_center</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the centre of the rectangle.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_patch_transform</span><span class="p">()</span><span class="o">.</span><span class="n">transform</span><span class="p">((</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_width</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the width of the rectangle.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_width</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_height</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the height of the rectangle.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_height</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_angle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the rotation angle in degrees.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the left coordinate of the rectangle.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_x0</span> <span class="o">=</span> <span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the bottom coordinate of the rectangle.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_y0</span> <span class="o">=</span> <span class="n">y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_angle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angle</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the rotation angle in degrees.</span>

<span class="sd">        The rotation is performed anti-clockwise around *xy*.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">angle</span> <span class="o">=</span> <span class="n">angle</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_xy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xy</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the left and bottom coordinates of the rectangle.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        xy : (float, float)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_x0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y0</span> <span class="o">=</span> <span class="n">xy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_width</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">w</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the width of the rectangle.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_width</span> <span class="o">=</span> <span class="n">w</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_height</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the height of the rectangle.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_height</span> <span class="o">=</span> <span class="n">h</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the bounds of the rectangle as *left*, *bottom*, *width*, *height*.</span>

<span class="sd">        The values may be passed as separate parameters or as a tuple::</span>

<span class="sd">            set_bounds(left, bottom, width, height)</span>
<span class="sd">            set_bounds((left, bottom, width, height))</span>

<span class="sd">        .. ACCEPTS: (left, bottom, width, height)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">l</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">l</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">args</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_x0</span> <span class="o">=</span> <span class="n">l</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_y0</span> <span class="o">=</span> <span class="n">b</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_width</span> <span class="o">=</span> <span class="n">w</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_height</span> <span class="o">=</span> <span class="n">h</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_bbox</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the `.Bbox`.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Bbox</span><span class="o">.</span><span class="n">from_extents</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_convert_units</span><span class="p">())</span>

    <span class="n">xy</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_xy</span><span class="p">,</span> <span class="n">set_xy</span><span class="p">)</span>


<span class="k">class</span><span class="w"> </span><span class="nc">RegularPolygon</span><span class="p">(</span><span class="n">Patch</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A regular polygon patch.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;RegularPolygon((</span><span class="si">%g</span><span class="s2">, </span><span class="si">%g</span><span class="s2">), </span><span class="si">%d</span><span class="s2">, radius=</span><span class="si">%g</span><span class="s2">, orientation=</span><span class="si">%g</span><span class="s2">)&quot;</span>
        <span class="k">return</span> <span class="n">s</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">numvertices</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">orientation</span><span class="p">)</span>

    <span class="nd">@_docstring</span><span class="o">.</span><span class="n">interpd</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xy</span><span class="p">,</span> <span class="n">numVertices</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                 <span class="n">radius</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        xy : (float, float)</span>
<span class="sd">            The center position.</span>

<span class="sd">        numVertices : int</span>
<span class="sd">            The number of vertices.</span>

<span class="sd">        radius : float</span>
<span class="sd">            The distance from the center to each of the vertices.</span>

<span class="sd">        orientation : float</span>
<span class="sd">            The polygon rotation angle (in radians).</span>

<span class="sd">        **kwargs</span>
<span class="sd">            `Patch` properties:</span>

<span class="sd">            %(Patch:kwdoc)s</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xy</span> <span class="o">=</span> <span class="n">xy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">numvertices</span> <span class="o">=</span> <span class="n">numVertices</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">orientation</span> <span class="o">=</span> <span class="n">orientation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radius</span> <span class="o">=</span> <span class="n">radius</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_path</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">unit_regular_polygon</span><span class="p">(</span><span class="n">numVertices</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_patch_transform</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Affine2D</span><span class="p">()</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_patch_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_patch_transform</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span> \
            <span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">)</span> \
            <span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">orientation</span><span class="p">)</span> \
            <span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">xy</span><span class="p">)</span>


<span class="k">class</span><span class="w"> </span><span class="nc">PathPatch</span><span class="p">(</span><span class="n">Patch</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A general polycurve path patch.&quot;&quot;&quot;</span>

    <span class="n">_edge_default</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;PathPatch</span><span class="si">%d</span><span class="s2">((</span><span class="si">%g</span><span class="s2">, </span><span class="si">%g</span><span class="s2">) ...)&quot;</span>
        <span class="k">return</span> <span class="n">s</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">vertices</span><span class="p">),</span> <span class="o">*</span><span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

    <span class="nd">@_docstring</span><span class="o">.</span><span class="n">interpd</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        *path* is a `.Path` object.</span>

<span class="sd">        Valid keyword arguments are:</span>

<span class="sd">        %(Patch:kwdoc)s</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_path</span> <span class="o">=</span> <span class="n">path</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_path</span> <span class="o">=</span> <span class="n">path</span>


<span class="k">class</span><span class="w"> </span><span class="nc">StepPatch</span><span class="p">(</span><span class="n">PathPatch</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A path patch describing a stepwise constant function.</span>

<span class="sd">    By default, the path is not closed and starts and stops at</span>
<span class="sd">    baseline value.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_edge_default</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="nd">@_docstring</span><span class="o">.</span><span class="n">interpd</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">edges</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                 <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span> <span class="n">baseline</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        values : array-like</span>
<span class="sd">            The step heights.</span>

<span class="sd">        edges : array-like</span>
<span class="sd">            The edge positions, with ``len(edges) == len(vals) + 1``,</span>
<span class="sd">            between which the curve takes on vals values.</span>

<span class="sd">        orientation : {&#39;vertical&#39;, &#39;horizontal&#39;}, default: &#39;vertical&#39;</span>
<span class="sd">            The direction of the steps. Vertical means that *values* are</span>
<span class="sd">            along the y-axis, and edges are along the x-axis.</span>

<span class="sd">        baseline : float, array-like or None, default: 0</span>
<span class="sd">            The bottom value of the bounding edges or when</span>
<span class="sd">            ``fill=True``, position of lower edge. If *fill* is</span>
<span class="sd">            True or an array is passed to *baseline*, a closed</span>
<span class="sd">            path is drawn.</span>

<span class="sd">        **kwargs</span>
<span class="sd">            `Patch` properties:</span>

<span class="sd">            %(Patch:kwdoc)s</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">orientation</span> <span class="o">=</span> <span class="n">orientation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_baseline</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">baseline</span><span class="p">)</span> <span class="k">if</span> <span class="n">baseline</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_path</span><span class="p">()</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_path</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_update_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_edges</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Nan values in &quot;edges&quot; are disallowed&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_edges</span><span class="o">.</span><span class="n">size</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Size mismatch between &quot;values&quot; and &quot;edges&quot;. &#39;</span>
                             <span class="s2">&quot;Expected `len(values) + 1 == len(edges)`, but &quot;</span>
                             <span class="sa">f</span><span class="s2">&quot;`len(values) = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s2">` and &quot;</span>
                             <span class="sa">f</span><span class="s2">&quot;`len(edges) = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_edges</span><span class="o">.</span><span class="n">size</span><span class="si">}</span><span class="s2">`.&quot;</span><span class="p">)</span>
        <span class="c1"># Initializing with empty arrays allows supporting empty stairs.</span>
        <span class="n">verts</span><span class="p">,</span> <span class="n">codes</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">Path</span><span class="o">.</span><span class="n">code_type</span><span class="p">)]</span>

        <span class="n">_nan_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_baseline</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_nan_mask</span> <span class="o">|=</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_baseline</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">idx0</span><span class="p">,</span> <span class="n">idx1</span> <span class="ow">in</span> <span class="n">cbook</span><span class="o">.</span><span class="n">contiguous_regions</span><span class="p">(</span><span class="o">~</span><span class="n">_nan_mask</span><span class="p">):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_edges</span><span class="p">[</span><span class="n">idx0</span><span class="p">:</span><span class="n">idx1</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">idx0</span><span class="p">:</span><span class="n">idx1</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_baseline</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">y</span><span class="p">[:</span><span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:]])</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_baseline</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># single baseline value</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([[</span><span class="bp">self</span><span class="o">.</span><span class="n">_baseline</span><span class="p">],</span> <span class="n">y</span><span class="p">,</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_baseline</span><span class="p">]])</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_baseline</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># baseline array</span>
                <span class="n">base</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_baseline</span><span class="p">[</span><span class="n">idx0</span><span class="p">:</span><span class="n">idx1</span><span class="p">],</span> <span class="mi">2</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">base</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:],</span> <span class="n">y</span><span class="p">,</span> <span class="n">base</span><span class="p">[:</span><span class="mi">1</span><span class="p">],</span>
                                    <span class="n">base</span><span class="p">[:</span><span class="mi">1</span><span class="p">],</span> <span class="n">base</span><span class="p">,</span> <span class="n">base</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:]])</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># no baseline</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Invalid `baseline` specified&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">orientation</span> <span class="o">==</span> <span class="s1">&#39;vertical&#39;</span><span class="p">:</span>
                <span class="n">xy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">xy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">])</span>
            <span class="n">verts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xy</span><span class="p">)</span>
            <span class="n">codes</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">Path</span><span class="o">.</span><span class="n">MOVETO</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">Path</span><span class="o">.</span><span class="n">LINETO</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xy</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">verts</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">codes</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get `.StepPatch` values, edges and baseline as namedtuple.&quot;&quot;&quot;</span>
        <span class="n">StairData</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;StairData&#39;</span><span class="p">,</span> <span class="s1">&#39;values edges baseline&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">StairData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_edges</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_baseline</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">edges</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">baseline</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set `.StepPatch` values, edges and baseline.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        values : 1D array-like or None</span>
<span class="sd">            Will not update values, if passing None</span>
<span class="sd">        edges : 1D array-like, optional</span>
<span class="sd">        baseline : float, 1D array-like or None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">values</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">edges</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">baseline</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Must set *values*, *edges* or *baseline*.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">edges</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">edges</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">baseline</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_baseline</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">baseline</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_path</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>


<span class="k">class</span><span class="w"> </span><span class="nc">Polygon</span><span class="p">(</span><span class="n">Patch</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A general polygon patch.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">vertices</span><span class="p">):</span>
            <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;Polygon</span><span class="si">%d</span><span class="s2">((</span><span class="si">%g</span><span class="s2">, </span><span class="si">%g</span><span class="s2">) ...)&quot;</span>
            <span class="k">return</span> <span class="n">s</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">vertices</span><span class="p">),</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;Polygon0()&quot;</span>

    <span class="nd">@_docstring</span><span class="o">.</span><span class="n">interpd</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xy</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        xy : (N, 2) array</span>

<span class="sd">        closed : bool, default: True</span>
<span class="sd">            Whether the polygon is closed (i.e., has identical start and end</span>
<span class="sd">            points).</span>

<span class="sd">        **kwargs</span>
<span class="sd">            %(Patch:kwdoc)s</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_closed</span> <span class="o">=</span> <span class="n">closed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_xy</span><span class="p">(</span><span class="n">xy</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the `.Path` of the polygon.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_closed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return whether the polygon is closed.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_closed</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_closed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">closed</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set whether the polygon is closed.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        closed : bool</span>
<span class="sd">            True if the polygon is closed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_closed</span> <span class="o">==</span> <span class="nb">bool</span><span class="p">(</span><span class="n">closed</span><span class="p">):</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_closed</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">closed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_xy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_xy</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_xy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the vertices of the path.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        (N, 2) array</span>
<span class="sd">            The coordinates of the vertices.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">vertices</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_xy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xy</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the vertices of the polygon.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        xy : (N, 2) array-like</span>
<span class="sd">            The coordinates of the vertices.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Unlike `.Path`, we do not ignore the last input vertex. If the</span>
<span class="sd">        polygon is meant to be closed, and the last point of the polygon is not</span>
<span class="sd">        equal to the first, we assume that the user has not explicitly passed a</span>
<span class="sd">        ``CLOSEPOLY`` vertex, and add it ourselves.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">xy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">xy</span><span class="p">)</span>
        <span class="n">nverts</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">xy</span><span class="o">.</span><span class="n">shape</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_closed</span><span class="p">:</span>
            <span class="c1"># if the first and last vertex are the &quot;same&quot;, then we assume that</span>
            <span class="c1"># the user explicitly passed the CLOSEPOLY vertex. Otherwise, we</span>
            <span class="c1"># have to append one since the last vertex will be &quot;ignored&quot; by</span>
            <span class="c1"># Path</span>
            <span class="k">if</span> <span class="n">nverts</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">nverts</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="p">(</span><span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">xy</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
                <span class="n">xy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">xy</span><span class="p">,</span> <span class="p">[</span><span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]]])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># if we aren&#39;t closed, and the last vertex matches the first, then</span>
            <span class="c1"># we assume we have an unnecessary CLOSEPOLY vertex and remove it</span>
            <span class="k">if</span> <span class="n">nverts</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="ow">and</span> <span class="p">(</span><span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">xy</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
                <span class="n">xy</span> <span class="o">=</span> <span class="n">xy</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_closed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">xy</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_xy</span><span class="p">,</span> <span class="n">set_xy</span><span class="p">,</span>
                  <span class="n">doc</span><span class="o">=</span><span class="s1">&#39;The vertices of the path as a (N, 2) array.&#39;</span><span class="p">)</span>


<span class="k">class</span><span class="w"> </span><span class="nc">Wedge</span><span class="p">(</span><span class="n">Patch</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wedge shaped patch.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">pars</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">theta1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">)</span>
        <span class="n">fmt</span> <span class="o">=</span> <span class="s2">&quot;Wedge(center=(</span><span class="si">%g</span><span class="s2">, </span><span class="si">%g</span><span class="s2">), r=</span><span class="si">%g</span><span class="s2">, theta1=</span><span class="si">%g</span><span class="s2">, theta2=</span><span class="si">%g</span><span class="s2">, width=</span><span class="si">%s</span><span class="s2">)&quot;</span>
        <span class="k">return</span> <span class="n">fmt</span> <span class="o">%</span> <span class="n">pars</span>

    <span class="nd">@_docstring</span><span class="o">.</span><span class="n">interpd</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">theta1</span><span class="p">,</span> <span class="n">theta2</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A wedge centered at *x*, *y* center with radius *r* that</span>
<span class="sd">        sweeps *theta1* to *theta2* (in degrees).  If *width* is given,</span>
<span class="sd">        then a partial wedge is drawn from inner radius *r* - *width*</span>
<span class="sd">        to outer radius *r*.</span>

<span class="sd">        Valid keyword arguments are:</span>

<span class="sd">        %(Patch:kwdoc)s</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">center</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">r</span><span class="p">,</span> <span class="n">width</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">theta1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta2</span> <span class="o">=</span> <span class="n">theta1</span><span class="p">,</span> <span class="n">theta2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_patch_transform</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">IdentityTransform</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_recompute_path</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_recompute_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Inner and outer rings are connected unless the annulus is complete</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">theta2</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">360</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">1e-12</span><span class="p">:</span>
            <span class="n">theta1</span><span class="p">,</span> <span class="n">theta2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">360</span>
            <span class="n">connector</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">MOVETO</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">theta1</span><span class="p">,</span> <span class="n">theta2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta2</span>
            <span class="n">connector</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">LINETO</span>

        <span class="c1"># Form the outer ring</span>
        <span class="n">arc</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">arc</span><span class="p">(</span><span class="n">theta1</span><span class="p">,</span> <span class="n">theta2</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Partial annulus needs to draw the outer ring</span>
            <span class="c1"># followed by a reversed and scaled inner ring</span>
            <span class="n">v1</span> <span class="o">=</span> <span class="n">arc</span><span class="o">.</span><span class="n">vertices</span>
            <span class="n">v2</span> <span class="o">=</span> <span class="n">arc</span><span class="o">.</span><span class="n">vertices</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]])</span>
            <span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="n">arc</span><span class="o">.</span><span class="n">codes</span><span class="p">,</span> <span class="n">connector</span><span class="p">,</span> <span class="o">*</span><span class="n">arc</span><span class="o">.</span><span class="n">codes</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">Path</span><span class="o">.</span><span class="n">CLOSEPOLY</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Wedge doesn&#39;t need an inner ring</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">arc</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]])</span>
            <span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="n">arc</span><span class="o">.</span><span class="n">codes</span><span class="p">,</span> <span class="n">connector</span><span class="p">,</span> <span class="n">Path</span><span class="o">.</span><span class="n">CLOSEPOLY</span><span class="p">]</span>

        <span class="c1"># Shift and scale the wedge to the final location.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">v</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_center</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">center</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_path</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">center</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_radius</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">radius</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_path</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="n">radius</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_theta1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">theta1</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_path</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">theta1</span> <span class="o">=</span> <span class="n">theta1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_theta2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">theta2</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_path</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">theta2</span> <span class="o">=</span> <span class="n">theta2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_width</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_path</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">width</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_recompute_path</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path</span>


<span class="c1"># COVERAGE NOTE: Not used internally or from examples</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Arrow</span><span class="p">(</span><span class="n">Patch</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;An arrow patch.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Arrow()&quot;</span>

    <span class="n">_path</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">_create_closed</span><span class="p">([</span>
        <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]])</span>

    <span class="nd">@_docstring</span><span class="o">.</span><span class="n">interpd</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Draws an arrow from (*x*, *y*) to (*x* + *dx*, *y* + *dy*).</span>
<span class="sd">        The width of the arrow is scaled by *width*.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : float</span>
<span class="sd">            x coordinate of the arrow tail.</span>
<span class="sd">        y : float</span>
<span class="sd">            y coordinate of the arrow tail.</span>
<span class="sd">        dx : float</span>
<span class="sd">            Arrow length in the x direction.</span>
<span class="sd">        dy : float</span>
<span class="sd">            Arrow length in the y direction.</span>
<span class="sd">        width : float, default: 1</span>
<span class="sd">            Scale factor for the width of the arrow. With a default value of 1,</span>
<span class="sd">            the tail width is 0.2 and head width is 0.6.</span>
<span class="sd">        **kwargs</span>
<span class="sd">            Keyword arguments control the `Patch` properties:</span>

<span class="sd">            %(Patch:kwdoc)s</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        FancyArrow</span>
<span class="sd">            Patch that allows independent control of the head and tail</span>
<span class="sd">            properties.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">width</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_patch_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_patch_transform</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set `.Arrow` x, y, dx, dy and width.</span>
<span class="sd">        Values left as None will not be updated.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x, y : float or None, default: None</span>
<span class="sd">            The x and y coordinates of the arrow base.</span>

<span class="sd">        dx, dy : float or None, default: None</span>
<span class="sd">            The length of the arrow along x and y direction.</span>

<span class="sd">        width : float or None, default: None</span>
<span class="sd">            Width of full arrow tail.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">=</span> <span class="n">x</span>
        <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">=</span> <span class="n">y</span>
        <span class="k">if</span> <span class="n">dx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dx</span> <span class="o">=</span> <span class="n">dx</span>
        <span class="k">if</span> <span class="n">dy</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dy</span> <span class="o">=</span> <span class="n">dy</span>
        <span class="k">if</span> <span class="n">width</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_width</span> <span class="o">=</span> <span class="n">width</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_patch_transform</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">transforms</span><span class="o">.</span><span class="n">Affine2D</span><span class="p">()</span>
            <span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">hypot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dy</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_width</span><span class="p">)</span>
            <span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dy</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dx</span><span class="p">))</span>
            <span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="p">)</span>
            <span class="o">.</span><span class="n">frozen</span><span class="p">())</span>


<span class="k">class</span><span class="w"> </span><span class="nc">FancyArrow</span><span class="p">(</span><span class="n">Polygon</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Like Arrow, but lets you set head width and head height independently.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_edge_default</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;FancyArrow()&quot;</span>

    <span class="nd">@_docstring</span><span class="o">.</span><span class="n">interpd</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                 <span class="n">width</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">length_includes_head</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">head_width</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">head_length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">,</span> <span class="n">overhang</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                 <span class="n">head_starts_at_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x, y : float</span>
<span class="sd">            The x and y coordinates of the arrow base.</span>

<span class="sd">        dx, dy : float</span>
<span class="sd">            The length of the arrow along x and y direction.</span>

<span class="sd">        width : float, default: 0.001</span>
<span class="sd">            Width of full arrow tail.</span>

<span class="sd">        length_includes_head : bool, default: False</span>
<span class="sd">            True if head is to be counted in calculating the length.</span>

<span class="sd">        head_width : float or None, default: 3*width</span>
<span class="sd">            Total width of the full arrow head.</span>

<span class="sd">        head_length : float or None, default: 1.5*head_width</span>
<span class="sd">            Length of arrow head.</span>

<span class="sd">        shape : {&#39;full&#39;, &#39;left&#39;, &#39;right&#39;}, default: &#39;full&#39;</span>
<span class="sd">            Draw the left-half, right-half, or full arrow.</span>

<span class="sd">        overhang : float, default: 0</span>
<span class="sd">            Fraction that the arrow is swept back (0 overhang means</span>
<span class="sd">            triangular shape). Can be negative or greater than one.</span>

<span class="sd">        head_starts_at_zero : bool, default: False</span>
<span class="sd">            If True, the head starts being drawn at coordinate 0</span>
<span class="sd">            instead of ending at coordinate 0.</span>

<span class="sd">        **kwargs</span>
<span class="sd">            `.Patch` properties:</span>

<span class="sd">            %(Patch:kwdoc)s</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">=</span> <span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">=</span> <span class="n">y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dx</span> <span class="o">=</span> <span class="n">dx</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dy</span> <span class="o">=</span> <span class="n">dy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_width</span> <span class="o">=</span> <span class="n">width</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_length_includes_head</span> <span class="o">=</span> <span class="n">length_includes_head</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_head_width</span> <span class="o">=</span> <span class="n">head_width</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_head_length</span> <span class="o">=</span> <span class="n">head_length</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span> <span class="o">=</span> <span class="n">shape</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_overhang</span> <span class="o">=</span> <span class="n">overhang</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_head_starts_at_zero</span> <span class="o">=</span> <span class="n">head_starts_at_zero</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_make_verts</span><span class="p">()</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">verts</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">head_width</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set `.FancyArrow` x, y, dx, dy, width, head_with, and head_length.</span>
<span class="sd">        Values left as None will not be updated.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x, y : float or None, default: None</span>
<span class="sd">            The x and y coordinates of the arrow base.</span>

<span class="sd">        dx, dy : float or None, default: None</span>
<span class="sd">            The length of the arrow along x and y direction.</span>

<span class="sd">        width : float or None, default: None</span>
<span class="sd">            Width of full arrow tail.</span>

<span class="sd">        head_width : float or None, default: None</span>
<span class="sd">            Total width of the full arrow head.</span>

<span class="sd">        head_length : float or None, default: None</span>
<span class="sd">            Length of arrow head.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">=</span> <span class="n">x</span>
        <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">=</span> <span class="n">y</span>
        <span class="k">if</span> <span class="n">dx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dx</span> <span class="o">=</span> <span class="n">dx</span>
        <span class="k">if</span> <span class="n">dy</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dy</span> <span class="o">=</span> <span class="n">dy</span>
        <span class="k">if</span> <span class="n">width</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_width</span> <span class="o">=</span> <span class="n">width</span>
        <span class="k">if</span> <span class="n">head_width</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_head_width</span> <span class="o">=</span> <span class="n">head_width</span>
        <span class="k">if</span> <span class="n">head_length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_head_length</span> <span class="o">=</span> <span class="n">head_length</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_make_verts</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_xy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">verts</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_make_verts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_head_width</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">head_width</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_width</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">head_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_head_width</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_head_length</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">head_length</span> <span class="o">=</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">head_width</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">head_length</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_head_length</span>

        <span class="n">distance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hypot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dy</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_length_includes_head</span><span class="p">:</span>
            <span class="n">length</span> <span class="o">=</span> <span class="n">distance</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">length</span> <span class="o">=</span> <span class="n">distance</span> <span class="o">+</span> <span class="n">head_length</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">length</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">verts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>  <span class="c1"># display nothing if empty</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># start by drawing horizontal arrow, point at (0, 0)</span>
            <span class="n">hw</span><span class="p">,</span> <span class="n">hl</span> <span class="o">=</span> <span class="n">head_width</span><span class="p">,</span> <span class="n">head_length</span>
            <span class="n">hs</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_overhang</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_width</span>
            <span class="n">left_half_arrow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
                <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>                 <span class="c1"># tip</span>
                <span class="p">[</span><span class="o">-</span><span class="n">hl</span><span class="p">,</span> <span class="o">-</span><span class="n">hw</span> <span class="o">/</span> <span class="mi">2</span><span class="p">],</span>             <span class="c1"># leftmost</span>
                <span class="p">[</span><span class="o">-</span><span class="n">hl</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">hs</span><span class="p">),</span> <span class="o">-</span><span class="n">lw</span> <span class="o">/</span> <span class="mi">2</span><span class="p">],</span>  <span class="c1"># meets stem</span>
                <span class="p">[</span><span class="o">-</span><span class="n">length</span><span class="p">,</span> <span class="o">-</span><span class="n">lw</span> <span class="o">/</span> <span class="mi">2</span><span class="p">],</span>         <span class="c1"># bottom left</span>
                <span class="p">[</span><span class="o">-</span><span class="n">length</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="p">])</span>
            <span class="c1"># if we&#39;re not including the head, shift up by head length</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_length_includes_head</span><span class="p">:</span>
                <span class="n">left_half_arrow</span> <span class="o">+=</span> <span class="p">[</span><span class="n">head_length</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="c1"># if the head starts at 0, shift up by another head length</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_head_starts_at_zero</span><span class="p">:</span>
                <span class="n">left_half_arrow</span> <span class="o">+=</span> <span class="p">[</span><span class="n">head_length</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="c1"># figure out the shape, and complete accordingly</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span> <span class="o">==</span> <span class="s1">&#39;left&#39;</span><span class="p">:</span>
                <span class="n">coords</span> <span class="o">=</span> <span class="n">left_half_arrow</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">right_half_arrow</span> <span class="o">=</span> <span class="n">left_half_arrow</span> <span class="o">*</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span> <span class="o">==</span> <span class="s1">&#39;right&#39;</span><span class="p">:</span>
                    <span class="n">coords</span> <span class="o">=</span> <span class="n">right_half_arrow</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shape</span> <span class="o">==</span> <span class="s1">&#39;full&#39;</span><span class="p">:</span>
                    <span class="c1"># The half-arrows contain the midpoint of the stem,</span>
                    <span class="c1"># which we can omit from the full arrow. Including it</span>
                    <span class="c1"># twice caused a problem with xpdf.</span>
                    <span class="n">coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">left_half_arrow</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                             <span class="n">right_half_arrow</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">::</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Got unknown shape: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_shape</span><span class="si">!r}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">distance</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">cx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dx</span> <span class="o">/</span> <span class="n">distance</span>
                <span class="n">sx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dy</span> <span class="o">/</span> <span class="n">distance</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Account for division by zero</span>
                <span class="n">cx</span><span class="p">,</span> <span class="n">sx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
            <span class="n">M</span> <span class="o">=</span> <span class="p">[[</span><span class="n">cx</span><span class="p">,</span> <span class="n">sx</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="n">sx</span><span class="p">,</span> <span class="n">cx</span><span class="p">]]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">verts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dx</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dy</span><span class="p">,</span>
            <span class="p">]</span>


<span class="n">_docstring</span><span class="o">.</span><span class="n">interpd</span><span class="o">.</span><span class="n">register</span><span class="p">(</span>
    <span class="n">FancyArrow</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">getdoc</span><span class="p">(</span><span class="n">FancyArrow</span><span class="o">.</span><span class="fm">__init__</span><span class="p">)</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()[</span><span class="mi">2</span><span class="p">:]))</span>


<span class="k">class</span><span class="w"> </span><span class="nc">CirclePolygon</span><span class="p">(</span><span class="n">RegularPolygon</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A polygon-approximation of a circle patch.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;CirclePolygon((</span><span class="si">%g</span><span class="s2">, </span><span class="si">%g</span><span class="s2">), radius=</span><span class="si">%g</span><span class="s2">, resolution=</span><span class="si">%d</span><span class="s2">)&quot;</span>
        <span class="k">return</span> <span class="n">s</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">numvertices</span><span class="p">)</span>

    <span class="nd">@_docstring</span><span class="o">.</span><span class="n">interpd</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xy</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                 <span class="n">resolution</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>  <span class="c1"># the number of vertices</span>
                 <span class="o">**</span> <span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a circle at *xy* = (*x*, *y*) with given *radius*.</span>

<span class="sd">        This circle is approximated by a regular polygon with *resolution*</span>
<span class="sd">        sides.  For a smoother circle drawn with splines, see `Circle`.</span>

<span class="sd">        Valid keyword arguments are:</span>

<span class="sd">        %(Patch:kwdoc)s</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">xy</span><span class="p">,</span> <span class="n">resolution</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">radius</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span><span class="w"> </span><span class="nc">Ellipse</span><span class="p">(</span><span class="n">Patch</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A scale-free ellipse.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">pars</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_center</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_center</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle</span><span class="p">)</span>
        <span class="n">fmt</span> <span class="o">=</span> <span class="s2">&quot;Ellipse(xy=(</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">), width=</span><span class="si">%s</span><span class="s2">, height=</span><span class="si">%s</span><span class="s2">, angle=</span><span class="si">%s</span><span class="s2">)&quot;</span>
        <span class="k">return</span> <span class="n">fmt</span> <span class="o">%</span> <span class="n">pars</span>

    <span class="nd">@_docstring</span><span class="o">.</span><span class="n">interpd</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xy</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        xy : (float, float)</span>
<span class="sd">            xy coordinates of ellipse centre.</span>
<span class="sd">        width : float</span>
<span class="sd">            Total length (diameter) of horizontal axis.</span>
<span class="sd">        height : float</span>
<span class="sd">            Total length (diameter) of vertical axis.</span>
<span class="sd">        angle : float, default: 0</span>
<span class="sd">            Rotation in degrees anti-clockwise.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Valid keyword arguments are:</span>

<span class="sd">        %(Patch:kwdoc)s</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_center</span> <span class="o">=</span> <span class="n">xy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_height</span> <span class="o">=</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_angle</span> <span class="o">=</span> <span class="n">angle</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_path</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">unit_circle</span><span class="p">()</span>
        <span class="c1"># Required for EllipseSelector with axes aspect ratio != 1</span>
        <span class="c1"># The patch is defined in data coordinates and when changing the</span>
        <span class="c1"># selector with square modifier and not in data coordinates, we need</span>
        <span class="c1"># to correct for the aspect ratio difference between the data and</span>
        <span class="c1"># display coordinate systems.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_aspect_ratio_correction</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="c1"># Note: This cannot be calculated until this is added to an Axes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_patch_transform</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">IdentityTransform</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_recompute_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This cannot be called until after this has been added to an Axes,</span>
<span class="sd">        otherwise unit conversion will fail. This makes it very important to</span>
<span class="sd">        call the accessor method and not directly access the transformation</span>
<span class="sd">        member variable.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">center</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">convert_xunits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_center</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                  <span class="bp">self</span><span class="o">.</span><span class="n">convert_yunits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_center</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="n">width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_xunits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_width</span><span class="p">)</span>
        <span class="n">height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_yunits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_height</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_patch_transform</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Affine2D</span><span class="p">()</span> \
            <span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">width</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">height</span> <span class="o">*</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aspect_ratio_correction</span><span class="p">)</span> \
            <span class="o">.</span><span class="n">rotate_deg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angle</span><span class="p">)</span> \
            <span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aspect_ratio_correction</span><span class="p">)</span> \
            <span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="o">*</span><span class="n">center</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the path of the ellipse.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_patch_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_recompute_transform</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_patch_transform</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_center</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xy</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the center of the ellipse.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        xy : (float, float)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_center</span> <span class="o">=</span> <span class="n">xy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_center</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the center of the ellipse.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_center</span>

    <span class="n">center</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_center</span><span class="p">,</span> <span class="n">set_center</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_width</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the width of the ellipse.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        width : float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_width</span> <span class="o">=</span> <span class="n">width</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_width</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the width of the ellipse.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_width</span>

    <span class="n">width</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_width</span><span class="p">,</span> <span class="n">set_width</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_height</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">height</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the height of the ellipse.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        height : float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_height</span> <span class="o">=</span> <span class="n">height</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_height</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the height of the ellipse.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_height</span>

    <span class="n">height</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_height</span><span class="p">,</span> <span class="n">set_height</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_angle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angle</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the angle of the ellipse.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        angle : float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_angle</span> <span class="o">=</span> <span class="n">angle</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_angle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the angle of the ellipse.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_angle</span>

    <span class="n">angle</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_angle</span><span class="p">,</span> <span class="n">set_angle</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_corners</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the corners of the ellipse bounding box.</span>

<span class="sd">        The bounding box orientation is moving anti-clockwise from the</span>
<span class="sd">        lower left corner defined before rotation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_patch_transform</span><span class="p">()</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
            <span class="p">[(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_vertices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the vertices coordinates of the ellipse.</span>

<span class="sd">        The definition can be found `here &lt;https://en.wikipedia.org/wiki/Ellipse&gt;`_</span>

<span class="sd">        .. versionadded:: 3.8</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">:</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_patch_transform</span><span class="p">()</span><span class="o">.</span><span class="n">transform</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_patch_transform</span><span class="p">()</span><span class="o">.</span><span class="n">transform</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)])</span>
        <span class="k">return</span> <span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ret</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_co_vertices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the co-vertices coordinates of the ellipse.</span>

<span class="sd">        The definition can be found `here &lt;https://en.wikipedia.org/wiki/Ellipse&gt;`_</span>

<span class="sd">        .. versionadded:: 3.8</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">:</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_patch_transform</span><span class="p">()</span><span class="o">.</span><span class="n">transform</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_patch_transform</span><span class="p">()</span><span class="o">.</span><span class="n">transform</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)])</span>
        <span class="k">return</span> <span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ret</span><span class="p">]</span>


<span class="k">class</span><span class="w"> </span><span class="nc">Annulus</span><span class="p">(</span><span class="n">Patch</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An elliptical annulus.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@_docstring</span><span class="o">.</span><span class="n">interpd</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xy</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        xy : (float, float)</span>
<span class="sd">            xy coordinates of annulus centre.</span>
<span class="sd">        r : float or (float, float)</span>
<span class="sd">            The radius, or semi-axes:</span>

<span class="sd">            - If float: radius of the outer circle.</span>
<span class="sd">            - If two floats: semi-major and -minor axes of outer ellipse.</span>
<span class="sd">        width : float</span>
<span class="sd">            Width (thickness) of the annular ring. The width is measured inward</span>
<span class="sd">            from the outer ellipse so that for the inner ellipse the semi-axes</span>
<span class="sd">            are given by ``r - width``. *width* must be less than or equal to</span>
<span class="sd">            the semi-minor axis.</span>
<span class="sd">        angle : float, default: 0</span>
<span class="sd">            Rotation angle in degrees (anti-clockwise from the positive</span>
<span class="sd">            x-axis). Ignored for circular annuli (i.e., if *r* is a scalar).</span>
<span class="sd">        **kwargs</span>
<span class="sd">            Keyword arguments control the `Patch` properties:</span>

<span class="sd">            %(Patch:kwdoc)s</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_radii</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">xy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">width</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">angle</span> <span class="o">=</span> <span class="n">angle</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_path</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">)</span>

        <span class="k">return</span> <span class="s2">&quot;Annulus(xy=(</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">), r=</span><span class="si">%s</span><span class="s2">, width=</span><span class="si">%s</span><span class="s2">, angle=</span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> \
                <span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_center</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xy</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the center of the annulus.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        xy : (float, float)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_center</span> <span class="o">=</span> <span class="n">xy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_path</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_center</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the center of the annulus.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_center</span>

    <span class="n">center</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_center</span><span class="p">,</span> <span class="n">set_center</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_width</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the width (thickness) of the annulus ring.</span>

<span class="sd">        The width is measured inwards from the outer ellipse.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        width : float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">width</span> <span class="o">&gt;</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;Width of annulus must be less than or equal to semi-minor axis&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_width</span> <span class="o">=</span> <span class="n">width</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_path</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_width</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the width (thickness) of the annulus ring.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_width</span>

    <span class="n">width</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_width</span><span class="p">,</span> <span class="n">set_width</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_angle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angle</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the tilt angle of the annulus.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        angle : float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_angle</span> <span class="o">=</span> <span class="n">angle</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_path</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_angle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the angle of the annulus.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_angle</span>

    <span class="n">angle</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_angle</span><span class="p">,</span> <span class="n">set_angle</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_semimajor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the semi-major axis *a* of the annulus.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        a : float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_path</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_semiminor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the semi-minor axis *b* of the annulus.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        b : float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_path</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_radii</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the semi-major (*a*) and semi-minor radii (*b*) of the annulus.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        r : float or (float, float)</span>
<span class="sd">            The radius, or semi-axes:</span>

<span class="sd">            - If float: radius of the outer circle.</span>
<span class="sd">            - If two floats: semi-major and -minor axes of outer ellipse.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">2</span><span class="p">,):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">r</span>
        <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">==</span> <span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Parameter &#39;r&#39; must be one or two floats.&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_path</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_radii</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the semi-major and semi-minor radii of the annulus.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span>

    <span class="n">radii</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_radii</span><span class="p">,</span> <span class="n">set_radii</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_transform_verts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verts</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Affine2D</span><span class="p">()</span> \
            <span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_convert_xy_units</span><span class="p">((</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)))</span> \
            <span class="o">.</span><span class="n">rotate_deg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angle</span><span class="p">)</span> \
            <span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_convert_xy_units</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">))</span> \
            <span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">verts</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_recompute_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># circular arc</span>
        <span class="n">arc</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">arc</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">)</span>

        <span class="c1"># annulus needs to draw an outer ring</span>
        <span class="c1"># followed by a reversed and scaled inner ring</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span>
        <span class="n">v1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transform_verts</span><span class="p">(</span><span class="n">arc</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
        <span class="n">v2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transform_verts</span><span class="p">(</span><span class="n">arc</span><span class="o">.</span><span class="n">vertices</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">a</span> <span class="o">-</span> <span class="n">w</span><span class="p">,</span> <span class="n">b</span> <span class="o">-</span> <span class="n">w</span><span class="p">)</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">v1</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)])</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">arc</span><span class="o">.</span><span class="n">codes</span><span class="p">,</span> <span class="n">Path</span><span class="o">.</span><span class="n">MOVETO</span><span class="p">,</span>
                       <span class="n">arc</span><span class="o">.</span><span class="n">codes</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">Path</span><span class="o">.</span><span class="n">MOVETO</span><span class="p">,</span>
                       <span class="n">Path</span><span class="o">.</span><span class="n">CLOSEPOLY</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_recompute_path</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path</span>


<div class="viewcode-block" id="Circle">
<a class="viewcode-back" href="../../_autosummary/egttools.plotting.simplex2d.Circle.html#egttools.plotting.simplex2d.Circle">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Circle</span><span class="p">(</span><span class="n">Ellipse</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A circle patch.</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="Circle.__str__">
<a class="viewcode-back" href="../../_autosummary/egttools.plotting.simplex2d.Circle.html#egttools.plotting.simplex2d.Circle.__str__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">pars</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius</span>
        <span class="n">fmt</span> <span class="o">=</span> <span class="s2">&quot;Circle(xy=(</span><span class="si">%g</span><span class="s2">, </span><span class="si">%g</span><span class="s2">), radius=</span><span class="si">%g</span><span class="s2">)&quot;</span>
        <span class="k">return</span> <span class="n">fmt</span> <span class="o">%</span> <span class="n">pars</span></div>


<div class="viewcode-block" id="Circle.__init__">
<a class="viewcode-back" href="../../_autosummary/egttools.plotting.simplex2d.Circle.html#egttools.plotting.simplex2d.Circle.__init__">[docs]</a>
    <span class="nd">@_docstring</span><span class="o">.</span><span class="n">interpd</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xy</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a true circle at center *xy* = (*x*, *y*) with given *radius*.</span>

<span class="sd">        Unlike `CirclePolygon` which is a polygonal approximation, this uses</span>
<span class="sd">        Bezier splines and is much closer to a scale-free circle.</span>

<span class="sd">        Valid keyword arguments are:</span>

<span class="sd">        %(Patch:kwdoc)s</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span> <span class="n">radius</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">radius</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radius</span> <span class="o">=</span> <span class="n">radius</span></div>


<div class="viewcode-block" id="Circle.set_radius">
<a class="viewcode-back" href="../../_autosummary/egttools.plotting.simplex2d.Circle.html#egttools.plotting.simplex2d.Circle.set_radius">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_radius</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">radius</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the radius of the circle.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        radius : float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">radius</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="Circle.get_radius">
<a class="viewcode-back" href="../../_autosummary/egttools.plotting.simplex2d.Circle.html#egttools.plotting.simplex2d.Circle.get_radius">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_radius</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the radius of the circle.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">/</span> <span class="mf">2.</span></div>


    <span class="n">radius</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_radius</span><span class="p">,</span> <span class="n">set_radius</span><span class="p">)</span></div>



<span class="k">class</span><span class="w"> </span><span class="nc">Arc</span><span class="p">(</span><span class="n">Ellipse</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An elliptical arc, i.e. a segment of an ellipse.</span>

<span class="sd">    Due to internal optimizations, the arc cannot be filled.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">pars</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta2</span><span class="p">)</span>
        <span class="n">fmt</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Arc(xy=(</span><span class="si">%g</span><span class="s2">, </span><span class="si">%g</span><span class="s2">), width=</span><span class="si">%g</span><span class="s2">, &quot;</span>
               <span class="s2">&quot;height=</span><span class="si">%g</span><span class="s2">, angle=</span><span class="si">%g</span><span class="s2">, theta1=</span><span class="si">%g</span><span class="s2">, theta2=</span><span class="si">%g</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fmt</span> <span class="o">%</span> <span class="n">pars</span>

    <span class="nd">@_docstring</span><span class="o">.</span><span class="n">interpd</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xy</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                 <span class="n">angle</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">theta1</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">theta2</span><span class="o">=</span><span class="mf">360.0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        xy : (float, float)</span>
<span class="sd">            The center of the ellipse.</span>

<span class="sd">        width : float</span>
<span class="sd">            The length of the horizontal axis.</span>

<span class="sd">        height : float</span>
<span class="sd">            The length of the vertical axis.</span>

<span class="sd">        angle : float</span>
<span class="sd">            Rotation of the ellipse in degrees (counterclockwise).</span>

<span class="sd">        theta1, theta2 : float, default: 0, 360</span>
<span class="sd">            Starting and ending angles of the arc in degrees. These values</span>
<span class="sd">            are relative to *angle*, e.g. if *angle* = 45 and *theta1* = 90</span>
<span class="sd">            the absolute starting angle is 135.</span>
<span class="sd">            Default *theta1* = 0, *theta2* = 360, i.e. a complete ellipse.</span>
<span class="sd">            The arc is drawn in the counterclockwise direction.</span>
<span class="sd">            Angles greater than or equal to 360, or smaller than 0, are</span>
<span class="sd">            represented by an equivalent angle in the range [0, 360), by</span>
<span class="sd">            taking the input value mod 360.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        **kwargs : `~matplotlib.patches.Patch` properties</span>
<span class="sd">            Most `.Patch` properties are supported as keyword arguments,</span>
<span class="sd">            except *fill* and *facecolor* because filling is not supported.</span>

<span class="sd">        %(Patch:kwdoc)s</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fill</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;fill&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fill</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Arc objects cannot be filled&quot;</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="n">angle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">theta1</span> <span class="o">=</span> <span class="n">theta1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">theta2</span> <span class="o">=</span> <span class="n">theta2</span>
        <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_theta1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_theta2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stretched_width</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_stretched_height</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_theta_stretch</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_path</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">arc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_theta1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_theta2</span><span class="p">)</span>

    <span class="nd">@artist</span><span class="o">.</span><span class="n">allow_rasterization</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Draw the arc to the given *renderer*.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Ellipses are normally drawn using an approximation that uses</span>
<span class="sd">        eight cubic Bezier splines.  The error of this approximation</span>
<span class="sd">        is 1.89818e-6, according to this unverified source:</span>

<span class="sd">          Lancaster, Don.  *Approximating a Circle or an Ellipse Using</span>
<span class="sd">          Four Bezier Cubic Splines.*</span>

<span class="sd">          https://www.tinaja.com/glib/ellipse4.pdf</span>

<span class="sd">        There is a use case where very large ellipses must be drawn</span>
<span class="sd">        with very high accuracy, and it is too expensive to render the</span>
<span class="sd">        entire ellipse with enough segments (either splines or line</span>
<span class="sd">        segments).  Therefore, in the case where either radius of the</span>
<span class="sd">        ellipse is large enough that the error of the spline</span>
<span class="sd">        approximation will be visible (greater than one pixel offset</span>
<span class="sd">        from the ideal), a different technique is used.</span>

<span class="sd">        In that case, only the visible parts of the ellipse are drawn,</span>
<span class="sd">        with each visible arc using a fixed number of spline segments</span>
<span class="sd">        (8).  The algorithm proceeds as follows:</span>

<span class="sd">        1. The points where the ellipse intersects the axes (or figure)</span>
<span class="sd">           bounding box are located.  (This is done by performing an inverse</span>
<span class="sd">           transformation on the bbox such that it is relative to the unit</span>
<span class="sd">           circle -- this makes the intersection calculation much easier than</span>
<span class="sd">           doing rotated ellipse intersection directly.)</span>

<span class="sd">           This uses the &quot;line intersecting a circle&quot; algorithm from:</span>

<span class="sd">               Vince, John.  *Geometry for Computer Graphics: Formulae,</span>
<span class="sd">               Examples &amp; Proofs.*  London: Springer-Verlag, 2005.</span>

<span class="sd">        2. The angles of each of the intersection points are calculated.</span>

<span class="sd">        3. Proceeding counterclockwise starting in the positive</span>
<span class="sd">           x-direction, each of the visible arc-segments between the</span>
<span class="sd">           pairs of vertices are drawn using the Bezier arc</span>
<span class="sd">           approximation technique implemented in `.Path.arc`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_visible</span><span class="p">():</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_recompute_transform</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_update_path</span><span class="p">()</span>
        <span class="c1"># Get width and height in pixels we need to use</span>
        <span class="c1"># `self.get_data_transform` rather than `self.get_transform`</span>
        <span class="c1"># because we want the transform from dataspace to the</span>
        <span class="c1"># screen space to estimate how big the arc will be in physical</span>
        <span class="c1"># units when rendered (the transform that we get via</span>
        <span class="c1"># `self.get_transform()` goes from an idealized unit-radius</span>
        <span class="c1"># space to screen space).</span>
        <span class="n">data_to_screen_trans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data_transform</span><span class="p">()</span>
        <span class="n">pwidth</span><span class="p">,</span> <span class="n">pheight</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">data_to_screen_trans</span><span class="o">.</span><span class="n">transform</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">_stretched_width</span><span class="p">,</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">_stretched_height</span><span class="p">))</span> <span class="o">-</span>
            <span class="n">data_to_screen_trans</span><span class="o">.</span><span class="n">transform</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)))</span>
        <span class="n">inv_error</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mf">1.89818e-6</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span>

        <span class="k">if</span> <span class="n">pwidth</span> <span class="o">&lt;</span> <span class="n">inv_error</span> <span class="ow">and</span> <span class="n">pheight</span> <span class="o">&lt;</span> <span class="n">inv_error</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Patch</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">)</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">line_circle_intersect</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">):</span>
            <span class="n">dx</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span>
            <span class="n">dy</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span>
            <span class="n">dr2</span> <span class="o">=</span> <span class="n">dx</span> <span class="o">*</span> <span class="n">dx</span> <span class="o">+</span> <span class="n">dy</span> <span class="o">*</span> <span class="n">dy</span>
            <span class="n">D</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">*</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">x1</span> <span class="o">*</span> <span class="n">y0</span>
            <span class="n">D2</span> <span class="o">=</span> <span class="n">D</span> <span class="o">*</span> <span class="n">D</span>
            <span class="n">discrim</span> <span class="o">=</span> <span class="n">dr2</span> <span class="o">-</span> <span class="n">D2</span>
            <span class="k">if</span> <span class="n">discrim</span> <span class="o">&gt;=</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="n">sign_dy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copysign</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">dy</span><span class="p">)</span>  <span class="c1"># +/-1, never 0.</span>
                <span class="n">sqrt_discrim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">discrim</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                    <span class="p">[[(</span><span class="n">D</span> <span class="o">*</span> <span class="n">dy</span> <span class="o">+</span> <span class="n">sign_dy</span> <span class="o">*</span> <span class="n">dx</span> <span class="o">*</span> <span class="n">sqrt_discrim</span><span class="p">)</span> <span class="o">/</span> <span class="n">dr2</span><span class="p">,</span>
                      <span class="p">(</span><span class="o">-</span><span class="n">D</span> <span class="o">*</span> <span class="n">dx</span> <span class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dy</span><span class="p">)</span> <span class="o">*</span> <span class="n">sqrt_discrim</span><span class="p">)</span> <span class="o">/</span> <span class="n">dr2</span><span class="p">],</span>
                     <span class="p">[(</span><span class="n">D</span> <span class="o">*</span> <span class="n">dy</span> <span class="o">-</span> <span class="n">sign_dy</span> <span class="o">*</span> <span class="n">dx</span> <span class="o">*</span> <span class="n">sqrt_discrim</span><span class="p">)</span> <span class="o">/</span> <span class="n">dr2</span><span class="p">,</span>
                      <span class="p">(</span><span class="o">-</span><span class="n">D</span> <span class="o">*</span> <span class="n">dx</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dy</span><span class="p">)</span> <span class="o">*</span> <span class="n">sqrt_discrim</span><span class="p">)</span> <span class="o">/</span> <span class="n">dr2</span><span class="p">]])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">segment_circle_intersect</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">):</span>
            <span class="n">epsilon</span> <span class="o">=</span> <span class="mf">1e-9</span>
            <span class="k">if</span> <span class="n">x1</span> <span class="o">&lt;</span> <span class="n">x0</span><span class="p">:</span>
                <span class="n">x0e</span><span class="p">,</span> <span class="n">x1e</span> <span class="o">=</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">x0e</span><span class="p">,</span> <span class="n">x1e</span> <span class="o">=</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span>
            <span class="k">if</span> <span class="n">y1</span> <span class="o">&lt;</span> <span class="n">y0</span><span class="p">:</span>
                <span class="n">y0e</span><span class="p">,</span> <span class="n">y1e</span> <span class="o">=</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">y0e</span><span class="p">,</span> <span class="n">y1e</span> <span class="o">=</span> <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span>
            <span class="n">xys</span> <span class="o">=</span> <span class="n">line_circle_intersect</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span>
            <span class="n">xs</span><span class="p">,</span> <span class="n">ys</span> <span class="o">=</span> <span class="n">xys</span><span class="o">.</span><span class="n">T</span>
            <span class="k">return</span> <span class="n">xys</span><span class="p">[</span>
                <span class="p">(</span><span class="n">x0e</span> <span class="o">-</span> <span class="n">epsilon</span> <span class="o">&lt;</span> <span class="n">xs</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">xs</span> <span class="o">&lt;</span> <span class="n">x1e</span> <span class="o">+</span> <span class="n">epsilon</span><span class="p">)</span>
                <span class="o">&amp;</span> <span class="p">(</span><span class="n">y0e</span> <span class="o">-</span> <span class="n">epsilon</span> <span class="o">&lt;</span> <span class="n">ys</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">ys</span> <span class="o">&lt;</span> <span class="n">y1e</span> <span class="o">+</span> <span class="n">epsilon</span><span class="p">)</span>
            <span class="p">]</span>

        <span class="c1"># Transform the Axes (or figure) box_path so that it is relative to</span>
        <span class="c1"># the unit circle in the same way that it is relative to the desired</span>
        <span class="c1"># ellipse.</span>
        <span class="n">box_path_transform</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">transforms</span><span class="o">.</span><span class="n">BboxTransformTo</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_figure</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span><span class="o">.</span><span class="n">bbox</span><span class="p">)</span>
            <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_transform</span><span class="p">())</span>
        <span class="n">box_path</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">unit_rectangle</span><span class="p">()</span><span class="o">.</span><span class="n">transformed</span><span class="p">(</span><span class="n">box_path_transform</span><span class="p">)</span>

        <span class="n">thetas</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="c1"># For each of the point pairs, there is a line segment</span>
        <span class="k">for</span> <span class="n">p0</span><span class="p">,</span> <span class="n">p1</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">box_path</span><span class="o">.</span><span class="n">vertices</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">box_path</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
            <span class="n">xy</span> <span class="o">=</span> <span class="n">segment_circle_intersect</span><span class="p">(</span><span class="o">*</span><span class="n">p0</span><span class="p">,</span> <span class="o">*</span><span class="n">p1</span><span class="p">)</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">xy</span><span class="o">.</span><span class="n">T</span>
            <span class="c1"># arctan2 return [-pi, pi), the rest of our angles are in</span>
            <span class="c1"># [0, 360], adjust as needed.</span>
            <span class="n">theta</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span> <span class="o">+</span> <span class="mi">360</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span>
            <span class="n">thetas</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                <span class="n">theta</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">_theta1</span> <span class="o">&lt;</span> <span class="n">theta</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">theta</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_theta2</span><span class="p">)])</span>
        <span class="n">thetas</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">thetas</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_theta2</span><span class="p">]</span>
        <span class="n">last_theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_theta1</span>
        <span class="n">theta1_rad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_theta1</span><span class="p">)</span>
        <span class="n">inside</span> <span class="o">=</span> <span class="n">box_path</span><span class="o">.</span><span class="n">contains_point</span><span class="p">(</span>
            <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta1_rad</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta1_rad</span><span class="p">))</span>
        <span class="p">)</span>

        <span class="c1"># save original path</span>
        <span class="n">path_original</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path</span>
        <span class="k">for</span> <span class="n">theta</span> <span class="ow">in</span> <span class="n">thetas</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">inside</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_path</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">arc</span><span class="p">(</span><span class="n">last_theta</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
                <span class="n">Patch</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">)</span>
                <span class="n">inside</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">inside</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">last_theta</span> <span class="o">=</span> <span class="n">theta</span>

        <span class="c1"># restore original path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_path</span> <span class="o">=</span> <span class="n">path_original</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_update_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Compute new values and update and set new _path if any value changed</span>
        <span class="n">stretched</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_theta_stretch</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">a</span> <span class="o">!=</span> <span class="n">b</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
                <span class="n">stretched</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_theta1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_theta2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stretched_width</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_stretched_height</span><span class="p">))):</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_theta1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_theta2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stretched_width</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">_stretched_height</span><span class="p">)</span> <span class="o">=</span> <span class="n">stretched</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_path</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">arc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_theta1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_theta2</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_theta_stretch</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># If the width and height of ellipse are not equal, take into account</span>
        <span class="c1"># stretching when calculating angles to draw between</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">theta_stretch</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">scale</span><span class="p">):</span>
            <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
            <span class="n">stheta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">scale</span> <span class="o">*</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
            <span class="c1"># arctan2 has the range [-pi, pi], we expect [0, 2*pi]</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">stheta</span> <span class="o">+</span> <span class="mi">360</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span>

        <span class="n">width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_xunits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">)</span>
        <span class="n">height</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_yunits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="c1"># if we need to stretch the angles because we are distorted</span>
            <span class="n">width</span> <span class="o">!=</span> <span class="n">height</span>
            <span class="c1"># and we are not doing a full circle.</span>
            <span class="c1">#</span>
            <span class="c1"># 0 and 360 do not exactly round-trip through the angle</span>
            <span class="c1"># stretching (due to both float precision limitations and</span>
            <span class="c1"># the difference between the range of arctan2 [-pi, pi] and</span>
            <span class="c1"># this method [0, 360]) so avoid doing it if we don&#39;t have to.</span>
            <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">theta1</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta2</span> <span class="ow">and</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">theta1</span> <span class="o">%</span> <span class="mi">360</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta2</span> <span class="o">%</span> <span class="mi">360</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="n">theta1</span> <span class="o">=</span> <span class="n">theta_stretch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">theta1</span><span class="p">,</span> <span class="n">width</span> <span class="o">/</span> <span class="n">height</span><span class="p">)</span>
            <span class="n">theta2</span> <span class="o">=</span> <span class="n">theta_stretch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">theta2</span><span class="p">,</span> <span class="n">width</span> <span class="o">/</span> <span class="n">height</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">theta1</span><span class="p">,</span> <span class="n">theta2</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta2</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span>


<span class="k">def</span><span class="w"> </span><span class="nf">bbox_artist</span><span class="p">(</span><span class="n">artist</span><span class="p">,</span> <span class="n">renderer</span><span class="p">,</span> <span class="n">props</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A debug function to draw a rectangle around the bounding</span>
<span class="sd">    box returned by an artist&#39;s `.Artist.get_window_extent`</span>
<span class="sd">    to test whether the artist is returning the correct bbox.</span>

<span class="sd">    *props* is a dict of rectangle props with the additional property</span>
<span class="sd">    &#39;pad&#39; that sets the padding around the bbox in points.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">props</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">props</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">props</span> <span class="o">=</span> <span class="n">props</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>  <span class="c1"># don&#39;t want to alter the pad externally</span>
    <span class="n">pad</span> <span class="o">=</span> <span class="n">props</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;pad&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    <span class="n">pad</span> <span class="o">=</span> <span class="n">renderer</span><span class="o">.</span><span class="n">points_to_pixels</span><span class="p">(</span><span class="n">pad</span><span class="p">)</span>
    <span class="n">bbox</span> <span class="o">=</span> <span class="n">artist</span><span class="o">.</span><span class="n">get_window_extent</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">(</span>
        <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">x0</span> <span class="o">-</span> <span class="n">pad</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">bbox</span><span class="o">.</span><span class="n">y0</span> <span class="o">-</span> <span class="n">pad</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span>
        <span class="n">width</span><span class="o">=</span><span class="n">bbox</span><span class="o">.</span><span class="n">width</span> <span class="o">+</span> <span class="n">pad</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">bbox</span><span class="o">.</span><span class="n">height</span> <span class="o">+</span> <span class="n">pad</span><span class="p">,</span>
        <span class="n">fill</span><span class="o">=</span><span class="n">fill</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">transforms</span><span class="o">.</span><span class="n">IdentityTransform</span><span class="p">(),</span> <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">r</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">props</span><span class="p">)</span>
    <span class="n">r</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">draw_bbox</span><span class="p">(</span><span class="n">bbox</span><span class="p">,</span> <span class="n">renderer</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">trans</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A debug function to draw a rectangle around the bounding</span>
<span class="sd">    box returned by an artist&#39;s `.Artist.get_window_extent`</span>
<span class="sd">    to test whether the artist is returning the correct bbox.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">(</span><span class="n">xy</span><span class="o">=</span><span class="n">bbox</span><span class="o">.</span><span class="n">p0</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">bbox</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">bbox</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
                  <span class="n">edgecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">trans</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">r</span><span class="o">.</span><span class="n">set_transform</span><span class="p">(</span><span class="n">trans</span><span class="p">)</span>
    <span class="n">r</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>


<span class="k">class</span><span class="w"> </span><span class="nc">_Style</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A base class for the Styles. It is meant to be a container class,</span>
<span class="sd">    where actual styles are declared as subclass of it, and it</span>
<span class="sd">    provides some helper functions.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__init_subclass__</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="c1"># Automatically perform docstring interpolation on the subclasses:</span>
        <span class="c1"># This allows listing the supported styles via</span>
        <span class="c1"># - %(BoxStyle:table)s</span>
        <span class="c1"># - %(ConnectionStyle:table)s</span>
        <span class="c1"># - %(ArrowStyle:table)s</span>
        <span class="c1"># and additionally adding .. ACCEPTS: blocks via</span>
        <span class="c1"># - %(BoxStyle:table_and_accepts)s</span>
        <span class="c1"># - %(ConnectionStyle:table_and_accepts)s</span>
        <span class="c1"># - %(ArrowStyle:table_and_accepts)s</span>
        <span class="n">_docstring</span><span class="o">.</span><span class="n">interpd</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="o">**</span><span class="p">{</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:table&quot;</span><span class="p">:</span> <span class="bp">cls</span><span class="o">.</span><span class="n">pprint_styles</span><span class="p">(),</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">:table_and_accepts&quot;</span><span class="p">:</span> <span class="p">(</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">pprint_styles</span><span class="p">()</span>
                <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">    .. ACCEPTS: [&quot;</span>
                <span class="o">+</span> <span class="s2">&quot;|&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="s2">&quot; &#39;</span><span class="si">{}</span><span class="s2">&#39; &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_style_list</span><span class="p">))</span>
                <span class="o">+</span> <span class="s2">&quot;]&quot;</span><span class="p">)</span>
        <span class="p">})</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">stylename</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the instance of the subclass with the given style name.&quot;&quot;&quot;</span>
        <span class="c1"># The &quot;class&quot; should have the _style_list attribute, which is a mapping</span>
        <span class="c1"># of style names to style classes.</span>
        <span class="n">_list</span> <span class="o">=</span> <span class="n">stylename</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
        <span class="n">_name</span> <span class="o">=</span> <span class="n">_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">_cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_style_list</span><span class="p">[</span><span class="n">_name</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown style: </span><span class="si">{</span><span class="n">stylename</span><span class="si">!r}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">err</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">_args_pair</span> <span class="o">=</span> <span class="p">[</span><span class="n">cs</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">cs</span> <span class="ow">in</span> <span class="n">_list</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span>
            <span class="n">_args</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">_args_pair</span><span class="p">}</span>
        <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Incorrect style argument: </span><span class="si">{</span><span class="n">stylename</span><span class="si">!r}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">err</span>
        <span class="k">return</span> <span class="n">_cls</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="o">**</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">})</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_styles</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a dictionary of available styles.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_style_list</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">pprint_styles</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the available styles as pretty-printed string.&quot;&quot;&quot;</span>
        <span class="n">table</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;Class&#39;</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Parameters&#39;</span><span class="p">),</span>
                 <span class="o">*</span><span class="p">[(</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
                    <span class="c1"># Add backquotes, as - and | have special meaning in reST.</span>
                    <span class="sa">f</span><span class="s1">&#39;``</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">``&#39;</span><span class="p">,</span>
                    <span class="c1"># [1:-1] drops the surrounding parentheses.</span>
                    <span class="nb">str</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="bp">cls</span><span class="p">))[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">or</span> <span class="s1">&#39;None&#39;</span><span class="p">)</span>
                   <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="bp">cls</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_style_list</span><span class="o">.</span><span class="n">items</span><span class="p">()]]</span>
        <span class="c1"># Convert to rst table.</span>
        <span class="n">col_len</span> <span class="o">=</span> <span class="p">[</span><span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span> <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">column</span><span class="p">)</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">table</span><span class="p">)]</span>
        <span class="n">table_formatstr</span> <span class="o">=</span> <span class="s1">&#39;  &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;=&#39;</span> <span class="o">*</span> <span class="n">cl</span> <span class="k">for</span> <span class="n">cl</span> <span class="ow">in</span> <span class="n">col_len</span><span class="p">)</span>
        <span class="n">rst_table</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span>
            <span class="s1">&#39;&#39;</span><span class="p">,</span>
            <span class="n">table_formatstr</span><span class="p">,</span>
            <span class="s1">&#39;  &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="n">cl</span><span class="p">)</span> <span class="k">for</span> <span class="n">cell</span><span class="p">,</span> <span class="n">cl</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">col_len</span><span class="p">)),</span>
            <span class="n">table_formatstr</span><span class="p">,</span>
            <span class="o">*</span><span class="p">[</span><span class="s1">&#39;  &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="n">cl</span><span class="p">)</span> <span class="k">for</span> <span class="n">cell</span><span class="p">,</span> <span class="n">cl</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col_len</span><span class="p">))</span>
              <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">table</span><span class="p">[</span><span class="mi">1</span><span class="p">:]],</span>
            <span class="n">table_formatstr</span><span class="p">,</span>
        <span class="p">])</span>
        <span class="k">return</span> <span class="n">textwrap</span><span class="o">.</span><span class="n">indent</span><span class="p">(</span><span class="n">rst_table</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="nd">@_api</span><span class="o">.</span><span class="n">deprecated</span><span class="p">(</span>
        <span class="s1">&#39;3.10.0&#39;</span><span class="p">,</span>
        <span class="n">message</span><span class="o">=</span><span class="s2">&quot;This method is never used internally.&quot;</span><span class="p">,</span>
        <span class="n">alternative</span><span class="o">=</span><span class="s2">&quot;No replacement.  Please open an issue if you use this.&quot;</span>
    <span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">register</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">style</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Register a new style.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">style</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_Base</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">style</span><span class="si">}</span><span class="s2"> must be a subclass of </span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="n">_Base</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">_style_list</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">style</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_register_style</span><span class="p">(</span><span class="n">style_list</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class decorator that stashes a class in a (style) dictionary.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">cls</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">_register_style</span><span class="p">,</span> <span class="n">style_list</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
    <span class="n">style_list</span><span class="p">[</span><span class="n">name</span> <span class="ow">or</span> <span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="o">=</span> <span class="bp">cls</span>
    <span class="k">return</span> <span class="bp">cls</span>


<span class="nd">@_docstring</span><span class="o">.</span><span class="n">interpd</span>
<span class="k">class</span><span class="w"> </span><span class="nc">BoxStyle</span><span class="p">(</span><span class="n">_Style</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    `BoxStyle` is a container class which defines several</span>
<span class="sd">    boxstyle classes, which are used for `FancyBboxPatch`.</span>

<span class="sd">    A style object can be created as::</span>

<span class="sd">           BoxStyle.Round(pad=0.2)</span>

<span class="sd">    or::</span>

<span class="sd">           BoxStyle(&quot;Round&quot;, pad=0.2)</span>

<span class="sd">    or::</span>

<span class="sd">           BoxStyle(&quot;Round, pad=0.2&quot;)</span>

<span class="sd">    The following boxstyle classes are defined.</span>

<span class="sd">    %(BoxStyle:table)s</span>

<span class="sd">    An instance of a boxstyle class is a callable object, with the signature ::</span>

<span class="sd">       __call__(self, x0, y0, width, height, mutation_size) -&gt; Path</span>

<span class="sd">    *x0*, *y0*, *width* and *height* specify the location and size of the box</span>
<span class="sd">    to be drawn; *mutation_size* scales the outline properties such as padding.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_style_list</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="nd">@_register_style</span><span class="p">(</span><span class="n">_style_list</span><span class="p">)</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">Square</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A square box.&quot;&quot;&quot;</span>

        <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.3</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            pad : float, default: 0.3</span>
<span class="sd">                The amount of padding around the original box.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pad</span> <span class="o">=</span> <span class="n">pad</span>

        <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">mutation_size</span><span class="p">):</span>
            <span class="n">pad</span> <span class="o">=</span> <span class="n">mutation_size</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">pad</span>
            <span class="c1"># width and height with padding added.</span>
            <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">width</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pad</span><span class="p">,</span> <span class="n">height</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pad</span>
            <span class="c1"># boundary of the padded box</span>
            <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">-</span> <span class="n">pad</span><span class="p">,</span> <span class="n">y0</span> <span class="o">-</span> <span class="n">pad</span>
            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">width</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">height</span>
            <span class="k">return</span> <span class="n">Path</span><span class="o">.</span><span class="n">_create_closed</span><span class="p">(</span>
                <span class="p">[(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y1</span><span class="p">)])</span>

    <span class="nd">@_register_style</span><span class="p">(</span><span class="n">_style_list</span><span class="p">)</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">Circle</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A circular box.&quot;&quot;&quot;</span>

        <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.3</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            pad : float, default: 0.3</span>
<span class="sd">                The amount of padding around the original box.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pad</span> <span class="o">=</span> <span class="n">pad</span>

        <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">mutation_size</span><span class="p">):</span>
            <span class="n">pad</span> <span class="o">=</span> <span class="n">mutation_size</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">pad</span>
            <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">width</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pad</span><span class="p">,</span> <span class="n">height</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pad</span>
            <span class="c1"># boundary of the padded box</span>
            <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">-</span> <span class="n">pad</span><span class="p">,</span> <span class="n">y0</span> <span class="o">-</span> <span class="n">pad</span>
            <span class="k">return</span> <span class="n">Path</span><span class="o">.</span><span class="n">circle</span><span class="p">((</span><span class="n">x0</span> <span class="o">+</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span>
                                <span class="nb">max</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>

    <span class="nd">@_register_style</span><span class="p">(</span><span class="n">_style_list</span><span class="p">)</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">Ellipse</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        An elliptical box.</span>

<span class="sd">        .. versionadded:: 3.7</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.3</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            pad : float, default: 0.3</span>
<span class="sd">                The amount of padding around the original box.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pad</span> <span class="o">=</span> <span class="n">pad</span>

        <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">mutation_size</span><span class="p">):</span>
            <span class="n">pad</span> <span class="o">=</span> <span class="n">mutation_size</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">pad</span>
            <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">width</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pad</span><span class="p">,</span> <span class="n">height</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pad</span>
            <span class="c1"># boundary of the padded box</span>
            <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">-</span> <span class="n">pad</span><span class="p">,</span> <span class="n">y0</span> <span class="o">-</span> <span class="n">pad</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">width</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">height</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">trans</span> <span class="o">=</span> <span class="n">Affine2D</span><span class="p">()</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">x0</span> <span class="o">+</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
                                                     <span class="n">y0</span> <span class="o">+</span> <span class="n">height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">trans</span><span class="o">.</span><span class="n">transform_path</span><span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">unit_circle</span><span class="p">())</span>

    <span class="nd">@_register_style</span><span class="p">(</span><span class="n">_style_list</span><span class="p">)</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">LArrow</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A box in the shape of a left-pointing arrow.&quot;&quot;&quot;</span>

        <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.3</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            pad : float, default: 0.3</span>
<span class="sd">                The amount of padding around the original box.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pad</span> <span class="o">=</span> <span class="n">pad</span>

        <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">mutation_size</span><span class="p">):</span>
            <span class="c1"># padding</span>
            <span class="n">pad</span> <span class="o">=</span> <span class="n">mutation_size</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">pad</span>
            <span class="c1"># width and height with padding added.</span>
            <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">width</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pad</span><span class="p">,</span> <span class="n">height</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pad</span>
            <span class="c1"># boundary of the padded box</span>
            <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">-</span> <span class="n">pad</span><span class="p">,</span> <span class="n">y0</span> <span class="o">-</span> <span class="n">pad</span><span class="p">,</span>
            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">width</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">height</span>

            <span class="n">dx</span> <span class="o">=</span> <span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
            <span class="n">dxx</span> <span class="o">=</span> <span class="n">dx</span> <span class="o">/</span> <span class="mi">2</span>
            <span class="n">x0</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">pad</span> <span class="o">/</span> <span class="mf">1.4</span>  <span class="c1"># adjust by ~sqrt(2)</span>

            <span class="k">return</span> <span class="n">Path</span><span class="o">.</span><span class="n">_create_closed</span><span class="p">(</span>
                <span class="p">[(</span><span class="n">x0</span> <span class="o">+</span> <span class="n">dxx</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="p">(</span><span class="n">x0</span> <span class="o">+</span> <span class="n">dxx</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span>
                 <span class="p">(</span><span class="n">x0</span> <span class="o">+</span> <span class="n">dxx</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">dxx</span><span class="p">),</span> <span class="p">(</span><span class="n">x0</span> <span class="o">-</span> <span class="n">dx</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">dx</span><span class="p">),</span>
                 <span class="p">(</span><span class="n">x0</span> <span class="o">+</span> <span class="n">dxx</span><span class="p">,</span> <span class="n">y0</span> <span class="o">-</span> <span class="n">dxx</span><span class="p">),</span>  <span class="c1"># arrow</span>
                 <span class="p">(</span><span class="n">x0</span> <span class="o">+</span> <span class="n">dxx</span><span class="p">,</span> <span class="n">y0</span><span class="p">)])</span>

    <span class="nd">@_register_style</span><span class="p">(</span><span class="n">_style_list</span><span class="p">)</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">RArrow</span><span class="p">(</span><span class="n">LArrow</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A box in the shape of a right-pointing arrow.&quot;&quot;&quot;</span>

        <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">mutation_size</span><span class="p">):</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">BoxStyle</span><span class="o">.</span><span class="n">LArrow</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">mutation_size</span><span class="p">)</span>
            <span class="n">p</span><span class="o">.</span><span class="n">vertices</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">width</span> <span class="o">-</span> <span class="n">p</span><span class="o">.</span><span class="n">vertices</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">p</span>

    <span class="nd">@_register_style</span><span class="p">(</span><span class="n">_style_list</span><span class="p">)</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">DArrow</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A box in the shape of a two-way arrow.&quot;&quot;&quot;</span>
        <span class="c1"># Modified from LArrow to add a right arrow to the bbox.</span>

        <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.3</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            pad : float, default: 0.3</span>
<span class="sd">                The amount of padding around the original box.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pad</span> <span class="o">=</span> <span class="n">pad</span>

        <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">mutation_size</span><span class="p">):</span>
            <span class="c1"># padding</span>
            <span class="n">pad</span> <span class="o">=</span> <span class="n">mutation_size</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">pad</span>
            <span class="c1"># width and height with padding added.</span>
            <span class="c1"># The width is padded by the arrows, so we don&#39;t need to pad it.</span>
            <span class="n">height</span> <span class="o">=</span> <span class="n">height</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pad</span>
            <span class="c1"># boundary of the padded box</span>
            <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">-</span> <span class="n">pad</span><span class="p">,</span> <span class="n">y0</span> <span class="o">-</span> <span class="n">pad</span>
            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">width</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">height</span>

            <span class="n">dx</span> <span class="o">=</span> <span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">y0</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
            <span class="n">dxx</span> <span class="o">=</span> <span class="n">dx</span> <span class="o">/</span> <span class="mi">2</span>
            <span class="n">x0</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">pad</span> <span class="o">/</span> <span class="mf">1.4</span>  <span class="c1"># adjust by ~sqrt(2)</span>

            <span class="k">return</span> <span class="n">Path</span><span class="o">.</span><span class="n">_create_closed</span><span class="p">([</span>
                <span class="p">(</span><span class="n">x0</span> <span class="o">+</span> <span class="n">dxx</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span>  <span class="c1"># bot-segment</span>
                <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y0</span> <span class="o">-</span> <span class="n">dxx</span><span class="p">),</span> <span class="p">(</span><span class="n">x1</span> <span class="o">+</span> <span class="n">dx</span> <span class="o">+</span> <span class="n">dxx</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">dx</span><span class="p">),</span>
                <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">dxx</span><span class="p">),</span>  <span class="c1"># right-arrow</span>
                <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="p">(</span><span class="n">x0</span> <span class="o">+</span> <span class="n">dxx</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span>  <span class="c1"># top-segment</span>
                <span class="p">(</span><span class="n">x0</span> <span class="o">+</span> <span class="n">dxx</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">dxx</span><span class="p">),</span> <span class="p">(</span><span class="n">x0</span> <span class="o">-</span> <span class="n">dx</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">dx</span><span class="p">),</span>
                <span class="p">(</span><span class="n">x0</span> <span class="o">+</span> <span class="n">dxx</span><span class="p">,</span> <span class="n">y0</span> <span class="o">-</span> <span class="n">dxx</span><span class="p">),</span>  <span class="c1"># left-arrow</span>
                <span class="p">(</span><span class="n">x0</span> <span class="o">+</span> <span class="n">dxx</span><span class="p">,</span> <span class="n">y0</span><span class="p">)])</span>

    <span class="nd">@_register_style</span><span class="p">(</span><span class="n">_style_list</span><span class="p">)</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">Round</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A box with round corners.&quot;&quot;&quot;</span>

        <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">rounding_size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            pad : float, default: 0.3</span>
<span class="sd">                The amount of padding around the original box.</span>
<span class="sd">            rounding_size : float, default: *pad*</span>
<span class="sd">                Radius of the corners.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pad</span> <span class="o">=</span> <span class="n">pad</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rounding_size</span> <span class="o">=</span> <span class="n">rounding_size</span>

        <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">mutation_size</span><span class="p">):</span>

            <span class="c1"># padding</span>
            <span class="n">pad</span> <span class="o">=</span> <span class="n">mutation_size</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">pad</span>

            <span class="c1"># size of the rounding corner</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rounding_size</span><span class="p">:</span>
                <span class="n">dr</span> <span class="o">=</span> <span class="n">mutation_size</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rounding_size</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dr</span> <span class="o">=</span> <span class="n">pad</span>

            <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">width</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pad</span><span class="p">,</span> <span class="n">height</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pad</span>

            <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">-</span> <span class="n">pad</span><span class="p">,</span> <span class="n">y0</span> <span class="o">-</span> <span class="n">pad</span><span class="p">,</span>
            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">width</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">height</span>

            <span class="c1"># Round corners are implemented as quadratic Bezier, e.g.,</span>
            <span class="c1"># [(x0, y0-dr), (x0, y0), (x0+dr, y0)] for lower left corner.</span>
            <span class="n">cp</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x0</span> <span class="o">+</span> <span class="n">dr</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span>
                  <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">dr</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span>
                  <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">dr</span><span class="p">),</span>
                  <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">dr</span><span class="p">),</span>
                  <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">dr</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span>
                  <span class="p">(</span><span class="n">x0</span> <span class="o">+</span> <span class="n">dr</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span>
                  <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">dr</span><span class="p">),</span>
                  <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">dr</span><span class="p">),</span>
                  <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span> <span class="p">(</span><span class="n">x0</span> <span class="o">+</span> <span class="n">dr</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span>
                  <span class="p">(</span><span class="n">x0</span> <span class="o">+</span> <span class="n">dr</span><span class="p">,</span> <span class="n">y0</span><span class="p">)]</span>

            <span class="n">com</span> <span class="o">=</span> <span class="p">[</span><span class="n">Path</span><span class="o">.</span><span class="n">MOVETO</span><span class="p">,</span>
                   <span class="n">Path</span><span class="o">.</span><span class="n">LINETO</span><span class="p">,</span>
                   <span class="n">Path</span><span class="o">.</span><span class="n">CURVE3</span><span class="p">,</span> <span class="n">Path</span><span class="o">.</span><span class="n">CURVE3</span><span class="p">,</span>
                   <span class="n">Path</span><span class="o">.</span><span class="n">LINETO</span><span class="p">,</span>
                   <span class="n">Path</span><span class="o">.</span><span class="n">CURVE3</span><span class="p">,</span> <span class="n">Path</span><span class="o">.</span><span class="n">CURVE3</span><span class="p">,</span>
                   <span class="n">Path</span><span class="o">.</span><span class="n">LINETO</span><span class="p">,</span>
                   <span class="n">Path</span><span class="o">.</span><span class="n">CURVE3</span><span class="p">,</span> <span class="n">Path</span><span class="o">.</span><span class="n">CURVE3</span><span class="p">,</span>
                   <span class="n">Path</span><span class="o">.</span><span class="n">LINETO</span><span class="p">,</span>
                   <span class="n">Path</span><span class="o">.</span><span class="n">CURVE3</span><span class="p">,</span> <span class="n">Path</span><span class="o">.</span><span class="n">CURVE3</span><span class="p">,</span>
                   <span class="n">Path</span><span class="o">.</span><span class="n">CLOSEPOLY</span><span class="p">]</span>

            <span class="k">return</span> <span class="n">Path</span><span class="p">(</span><span class="n">cp</span><span class="p">,</span> <span class="n">com</span><span class="p">)</span>

    <span class="nd">@_register_style</span><span class="p">(</span><span class="n">_style_list</span><span class="p">)</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">Round4</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A box with rounded edges.&quot;&quot;&quot;</span>

        <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">rounding_size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            pad : float, default: 0.3</span>
<span class="sd">                The amount of padding around the original box.</span>
<span class="sd">            rounding_size : float, default: *pad*/2</span>
<span class="sd">                Rounding of edges.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pad</span> <span class="o">=</span> <span class="n">pad</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rounding_size</span> <span class="o">=</span> <span class="n">rounding_size</span>

        <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">mutation_size</span><span class="p">):</span>

            <span class="c1"># padding</span>
            <span class="n">pad</span> <span class="o">=</span> <span class="n">mutation_size</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">pad</span>

            <span class="c1"># Rounding size; defaults to half of the padding.</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rounding_size</span><span class="p">:</span>
                <span class="n">dr</span> <span class="o">=</span> <span class="n">mutation_size</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">rounding_size</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dr</span> <span class="o">=</span> <span class="n">pad</span> <span class="o">/</span> <span class="mf">2.</span>

            <span class="n">width</span> <span class="o">=</span> <span class="n">width</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pad</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">dr</span>
            <span class="n">height</span> <span class="o">=</span> <span class="n">height</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pad</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">dr</span>

            <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">-</span> <span class="n">pad</span> <span class="o">+</span> <span class="n">dr</span><span class="p">,</span> <span class="n">y0</span> <span class="o">-</span> <span class="n">pad</span> <span class="o">+</span> <span class="n">dr</span><span class="p">,</span>
            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">width</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">height</span>

            <span class="n">cp</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span>
                  <span class="p">(</span><span class="n">x0</span> <span class="o">+</span> <span class="n">dr</span><span class="p">,</span> <span class="n">y0</span> <span class="o">-</span> <span class="n">dr</span><span class="p">),</span> <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">dr</span><span class="p">,</span> <span class="n">y0</span> <span class="o">-</span> <span class="n">dr</span><span class="p">),</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span>
                  <span class="p">(</span><span class="n">x1</span> <span class="o">+</span> <span class="n">dr</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">dr</span><span class="p">),</span> <span class="p">(</span><span class="n">x1</span> <span class="o">+</span> <span class="n">dr</span><span class="p">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">dr</span><span class="p">),</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span>
                  <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">dr</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">dr</span><span class="p">),</span> <span class="p">(</span><span class="n">x0</span> <span class="o">+</span> <span class="n">dr</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">dr</span><span class="p">),</span> <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span>
                  <span class="p">(</span><span class="n">x0</span> <span class="o">-</span> <span class="n">dr</span><span class="p">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">dr</span><span class="p">),</span> <span class="p">(</span><span class="n">x0</span> <span class="o">-</span> <span class="n">dr</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">dr</span><span class="p">),</span> <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span>
                  <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">)]</span>

            <span class="n">com</span> <span class="o">=</span> <span class="p">[</span><span class="n">Path</span><span class="o">.</span><span class="n">MOVETO</span><span class="p">,</span>
                   <span class="n">Path</span><span class="o">.</span><span class="n">CURVE4</span><span class="p">,</span> <span class="n">Path</span><span class="o">.</span><span class="n">CURVE4</span><span class="p">,</span> <span class="n">Path</span><span class="o">.</span><span class="n">CURVE4</span><span class="p">,</span>
                   <span class="n">Path</span><span class="o">.</span><span class="n">CURVE4</span><span class="p">,</span> <span class="n">Path</span><span class="o">.</span><span class="n">CURVE4</span><span class="p">,</span> <span class="n">Path</span><span class="o">.</span><span class="n">CURVE4</span><span class="p">,</span>
                   <span class="n">Path</span><span class="o">.</span><span class="n">CURVE4</span><span class="p">,</span> <span class="n">Path</span><span class="o">.</span><span class="n">CURVE4</span><span class="p">,</span> <span class="n">Path</span><span class="o">.</span><span class="n">CURVE4</span><span class="p">,</span>
                   <span class="n">Path</span><span class="o">.</span><span class="n">CURVE4</span><span class="p">,</span> <span class="n">Path</span><span class="o">.</span><span class="n">CURVE4</span><span class="p">,</span> <span class="n">Path</span><span class="o">.</span><span class="n">CURVE4</span><span class="p">,</span>
                   <span class="n">Path</span><span class="o">.</span><span class="n">CLOSEPOLY</span><span class="p">]</span>

            <span class="k">return</span> <span class="n">Path</span><span class="p">(</span><span class="n">cp</span><span class="p">,</span> <span class="n">com</span><span class="p">)</span>

    <span class="nd">@_register_style</span><span class="p">(</span><span class="n">_style_list</span><span class="p">)</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">Sawtooth</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A box with a sawtooth outline.&quot;&quot;&quot;</span>

        <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">tooth_size</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            pad : float, default: 0.3</span>
<span class="sd">                The amount of padding around the original box.</span>
<span class="sd">            tooth_size : float, default: *pad*/2</span>
<span class="sd">                Size of the sawtooth.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pad</span> <span class="o">=</span> <span class="n">pad</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tooth_size</span> <span class="o">=</span> <span class="n">tooth_size</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">_get_sawtooth_vertices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">mutation_size</span><span class="p">):</span>

            <span class="c1"># padding</span>
            <span class="n">pad</span> <span class="o">=</span> <span class="n">mutation_size</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">pad</span>

            <span class="c1"># size of sawtooth</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tooth_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">tooth_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pad</span> <span class="o">*</span> <span class="mf">.5</span> <span class="o">*</span> <span class="n">mutation_size</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">tooth_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tooth_size</span> <span class="o">*</span> <span class="n">mutation_size</span>

            <span class="n">hsz</span> <span class="o">=</span> <span class="n">tooth_size</span> <span class="o">/</span> <span class="mi">2</span>
            <span class="n">width</span> <span class="o">=</span> <span class="n">width</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pad</span> <span class="o">-</span> <span class="n">tooth_size</span>
            <span class="n">height</span> <span class="o">=</span> <span class="n">height</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pad</span> <span class="o">-</span> <span class="n">tooth_size</span>

            <span class="c1"># the sizes of the vertical and horizontal sawtooth are</span>
            <span class="c1"># separately adjusted to fit the given box size.</span>
            <span class="n">dsx_n</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">width</span> <span class="o">-</span> <span class="n">tooth_size</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">tooth_size</span> <span class="o">*</span> <span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="mi">2</span>
            <span class="n">dsy_n</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">height</span> <span class="o">-</span> <span class="n">tooth_size</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">tooth_size</span> <span class="o">*</span> <span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="mi">2</span>

            <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">-</span> <span class="n">pad</span> <span class="o">+</span> <span class="n">hsz</span><span class="p">,</span> <span class="n">y0</span> <span class="o">-</span> <span class="n">pad</span> <span class="o">+</span> <span class="n">hsz</span>
            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">width</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">height</span>

            <span class="n">xs</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">x0</span><span class="p">,</span> <span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x0</span> <span class="o">+</span> <span class="n">hsz</span><span class="p">,</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">hsz</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">dsx_n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>  <span class="c1"># bottom</span>
                <span class="o">*</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">hsz</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">hsz</span><span class="p">]</span> <span class="o">*</span> <span class="n">dsy_n</span><span class="p">)[:</span><span class="mi">2</span><span class="o">*</span><span class="n">dsy_n</span><span class="o">+</span><span class="mi">2</span><span class="p">],</span>  <span class="c1"># right</span>
                <span class="n">x1</span><span class="p">,</span> <span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">hsz</span><span class="p">,</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">hsz</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">dsx_n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>  <span class="c1"># top</span>
                <span class="o">*</span><span class="p">([</span><span class="n">x0</span><span class="p">,</span> <span class="n">x0</span> <span class="o">-</span> <span class="n">hsz</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">hsz</span><span class="p">]</span> <span class="o">*</span> <span class="n">dsy_n</span><span class="p">)[:</span><span class="mi">2</span><span class="o">*</span><span class="n">dsy_n</span><span class="o">+</span><span class="mi">2</span><span class="p">],</span>  <span class="c1"># left</span>
            <span class="p">]</span>
            <span class="n">ys</span> <span class="o">=</span> <span class="p">[</span>
                <span class="o">*</span><span class="p">([</span><span class="n">y0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">-</span> <span class="n">hsz</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">hsz</span><span class="p">]</span> <span class="o">*</span> <span class="n">dsx_n</span><span class="p">)[:</span><span class="mi">2</span><span class="o">*</span><span class="n">dsx_n</span><span class="o">+</span><span class="mi">2</span><span class="p">],</span>  <span class="c1"># bottom</span>
                <span class="n">y0</span><span class="p">,</span> <span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">y0</span> <span class="o">+</span> <span class="n">hsz</span><span class="p">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">hsz</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">dsy_n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>  <span class="c1"># right</span>
                <span class="o">*</span><span class="p">([</span><span class="n">y1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">hsz</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">hsz</span><span class="p">]</span> <span class="o">*</span> <span class="n">dsx_n</span><span class="p">)[:</span><span class="mi">2</span><span class="o">*</span><span class="n">dsx_n</span><span class="o">+</span><span class="mi">2</span><span class="p">],</span>  <span class="c1"># top</span>
                <span class="n">y1</span><span class="p">,</span> <span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">y1</span> <span class="o">-</span> <span class="n">hsz</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">hsz</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">dsy_n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>  <span class="c1"># left</span>
            <span class="p">]</span>

            <span class="k">return</span> <span class="p">[</span><span class="o">*</span><span class="nb">zip</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">),</span> <span class="p">(</span><span class="n">xs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ys</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>

        <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">mutation_size</span><span class="p">):</span>
            <span class="n">saw_vertices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_sawtooth_vertices</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span>
                                                       <span class="n">height</span><span class="p">,</span> <span class="n">mutation_size</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">Path</span><span class="p">(</span><span class="n">saw_vertices</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="nd">@_register_style</span><span class="p">(</span><span class="n">_style_list</span><span class="p">)</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">Roundtooth</span><span class="p">(</span><span class="n">Sawtooth</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A box with a rounded sawtooth outline.&quot;&quot;&quot;</span>

        <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">mutation_size</span><span class="p">):</span>
            <span class="n">saw_vertices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_sawtooth_vertices</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span>
                                                       <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span>
                                                       <span class="n">mutation_size</span><span class="p">)</span>
            <span class="c1"># Add a trailing vertex to allow us to close the polygon correctly</span>
            <span class="n">saw_vertices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">saw_vertices</span><span class="p">,</span> <span class="p">[</span><span class="n">saw_vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">]]])</span>
            <span class="n">codes</span> <span class="o">=</span> <span class="p">([</span><span class="n">Path</span><span class="o">.</span><span class="n">MOVETO</span><span class="p">]</span> <span class="o">+</span>
                     <span class="p">[</span><span class="n">Path</span><span class="o">.</span><span class="n">CURVE3</span><span class="p">,</span> <span class="n">Path</span><span class="o">.</span><span class="n">CURVE3</span><span class="p">]</span> <span class="o">*</span> <span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">saw_vertices</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span>
                     <span class="p">[</span><span class="n">Path</span><span class="o">.</span><span class="n">CLOSEPOLY</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">Path</span><span class="p">(</span><span class="n">saw_vertices</span><span class="p">,</span> <span class="n">codes</span><span class="p">)</span>


<span class="nd">@_docstring</span><span class="o">.</span><span class="n">interpd</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ConnectionStyle</span><span class="p">(</span><span class="n">_Style</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    `ConnectionStyle` is a container class which defines</span>
<span class="sd">    several connectionstyle classes, which is used to create a path</span>
<span class="sd">    between two points.  These are mainly used with `FancyArrowPatch`.</span>

<span class="sd">    A connectionstyle object can be either created as::</span>

<span class="sd">           ConnectionStyle.Arc3(rad=0.2)</span>

<span class="sd">    or::</span>

<span class="sd">           ConnectionStyle(&quot;Arc3&quot;, rad=0.2)</span>

<span class="sd">    or::</span>

<span class="sd">           ConnectionStyle(&quot;Arc3, rad=0.2&quot;)</span>

<span class="sd">    The following classes are defined</span>

<span class="sd">    %(ConnectionStyle:table)s</span>

<span class="sd">    An instance of any connection style class is a callable object,</span>
<span class="sd">    whose call signature is::</span>

<span class="sd">        __call__(self, posA, posB,</span>
<span class="sd">                 patchA=None, patchB=None,</span>
<span class="sd">                 shrinkA=2., shrinkB=2.)</span>

<span class="sd">    and it returns a `.Path` instance. *posA* and *posB* are</span>
<span class="sd">    tuples of (x, y) coordinates of the two points to be</span>
<span class="sd">    connected. *patchA* (or *patchB*) is given, the returned path is</span>
<span class="sd">    clipped so that it start (or end) from the boundary of the</span>
<span class="sd">    patch. The path is further shrunk by *shrinkA* (or *shrinkB*)</span>
<span class="sd">    which is given in points.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_style_list</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">class</span><span class="w"> </span><span class="nc">_Base</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A base class for connectionstyle classes. The subclass needs</span>
<span class="sd">        to implement a *connect* method whose call signature is::</span>

<span class="sd">          connect(posA, posB)</span>

<span class="sd">        where posA and posB are tuples of x, y coordinates to be</span>
<span class="sd">        connected.  The method needs to return a path connecting two</span>
<span class="sd">        points. This base class defines a __call__ method, and a few</span>
<span class="sd">        helper methods.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">_in_patch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">patch</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Return a predicate function testing whether a point *xy* is</span>
<span class="sd">            contained in *patch*.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="k">lambda</span> <span class="n">xy</span><span class="p">:</span> <span class="n">patch</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span>
                <span class="n">SimpleNamespace</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">_clip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">in_start</span><span class="p">,</span> <span class="n">in_stop</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Clip *path* at its start by the region where *in_start* returns</span>
<span class="sd">            True, and at its stop by the region where *in_stop* returns True.</span>

<span class="sd">            The original path is assumed to start in the *in_start* region and</span>
<span class="sd">            to stop in the *in_stop* region.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="n">in_start</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">_</span><span class="p">,</span> <span class="n">path</span> <span class="o">=</span> <span class="n">split_path_inout</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">in_start</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                    <span class="k">pass</span>
            <span class="k">if</span> <span class="n">in_stop</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">path</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">split_path_inout</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">in_stop</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                    <span class="k">pass</span>
            <span class="k">return</span> <span class="n">path</span>

        <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">posA</span><span class="p">,</span> <span class="n">posB</span><span class="p">,</span>
                     <span class="n">shrinkA</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">shrinkB</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">patchA</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">patchB</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Call the *connect* method to create a path between *posA* and</span>
<span class="sd">            *posB*; then clip and shrink the path.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">posA</span><span class="p">,</span> <span class="n">posB</span><span class="p">)</span>
            <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_clip</span><span class="p">(</span>
                <span class="n">path</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_in_patch</span><span class="p">(</span><span class="n">patchA</span><span class="p">)</span> <span class="k">if</span> <span class="n">patchA</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_in_patch</span><span class="p">(</span><span class="n">patchB</span><span class="p">)</span> <span class="k">if</span> <span class="n">patchB</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_clip</span><span class="p">(</span>
                <span class="n">path</span><span class="p">,</span>
                <span class="n">inside_circle</span><span class="p">(</span><span class="o">*</span><span class="n">path</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">shrinkA</span><span class="p">)</span> <span class="k">if</span> <span class="n">shrinkA</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">inside_circle</span><span class="p">(</span><span class="o">*</span><span class="n">path</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">shrinkB</span><span class="p">)</span> <span class="k">if</span> <span class="n">shrinkB</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="n">path</span>

    <span class="nd">@_register_style</span><span class="p">(</span><span class="n">_style_list</span><span class="p">)</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">Arc3</span><span class="p">(</span><span class="n">_Base</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a simple quadratic Bézier curve between two</span>
<span class="sd">        points. The curve is created so that the middle control point</span>
<span class="sd">        (C1) is located at the same distance from the start (C0) and</span>
<span class="sd">        end points(C2) and the distance of the C1 to the line</span>
<span class="sd">        connecting C0-C2 is *rad* times the distance of C0-C2.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rad</span><span class="o">=</span><span class="mf">0.</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            rad : float</span>
<span class="sd">              Curvature of the curve.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rad</span> <span class="o">=</span> <span class="n">rad</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">posA</span><span class="p">,</span> <span class="n">posB</span><span class="p">):</span>
            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">posA</span>
            <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">posB</span>
            <span class="n">x12</span><span class="p">,</span> <span class="n">y12</span> <span class="o">=</span> <span class="p">(</span><span class="n">x1</span> <span class="o">+</span> <span class="n">x2</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">,</span> <span class="p">(</span><span class="n">y1</span> <span class="o">+</span> <span class="n">y2</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.</span>
            <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span>

            <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rad</span>

            <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span> <span class="o">=</span> <span class="n">x12</span> <span class="o">+</span> <span class="n">f</span> <span class="o">*</span> <span class="n">dy</span><span class="p">,</span> <span class="n">y12</span> <span class="o">-</span> <span class="n">f</span> <span class="o">*</span> <span class="n">dx</span>

            <span class="n">vertices</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span>
                        <span class="p">(</span><span class="n">cx</span><span class="p">,</span> <span class="n">cy</span><span class="p">),</span>
                        <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)]</span>
            <span class="n">codes</span> <span class="o">=</span> <span class="p">[</span><span class="n">Path</span><span class="o">.</span><span class="n">MOVETO</span><span class="p">,</span>
                     <span class="n">Path</span><span class="o">.</span><span class="n">CURVE3</span><span class="p">,</span>
                     <span class="n">Path</span><span class="o">.</span><span class="n">CURVE3</span><span class="p">]</span>

            <span class="k">return</span> <span class="n">Path</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span> <span class="n">codes</span><span class="p">)</span>

    <span class="nd">@_register_style</span><span class="p">(</span><span class="n">_style_list</span><span class="p">)</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">Angle3</span><span class="p">(</span><span class="n">_Base</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a simple quadratic Bézier curve between two points. The middle</span>
<span class="sd">        control point is placed at the intersecting point of two lines which</span>
<span class="sd">        cross the start and end point, and have a slope of *angleA* and</span>
<span class="sd">        *angleB*, respectively.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angleA</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">angleB</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            angleA : float</span>
<span class="sd">              Starting angle of the path.</span>

<span class="sd">            angleB : float</span>
<span class="sd">              Ending angle of the path.</span>
<span class="sd">            &quot;&quot;&quot;</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">angleA</span> <span class="o">=</span> <span class="n">angleA</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">angleB</span> <span class="o">=</span> <span class="n">angleB</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">posA</span><span class="p">,</span> <span class="n">posB</span><span class="p">):</span>
            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">posA</span>
            <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">posB</span>

            <span class="n">cosA</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angleA</span><span class="p">))</span>
            <span class="n">sinA</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angleA</span><span class="p">))</span>
            <span class="n">cosB</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angleB</span><span class="p">))</span>
            <span class="n">sinB</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angleB</span><span class="p">))</span>

            <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span> <span class="o">=</span> <span class="n">get_intersection</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">cosA</span><span class="p">,</span> <span class="n">sinA</span><span class="p">,</span>
                                      <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">cosB</span><span class="p">,</span> <span class="n">sinB</span><span class="p">)</span>

            <span class="n">vertices</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="p">(</span><span class="n">cx</span><span class="p">,</span> <span class="n">cy</span><span class="p">),</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)]</span>
            <span class="n">codes</span> <span class="o">=</span> <span class="p">[</span><span class="n">Path</span><span class="o">.</span><span class="n">MOVETO</span><span class="p">,</span> <span class="n">Path</span><span class="o">.</span><span class="n">CURVE3</span><span class="p">,</span> <span class="n">Path</span><span class="o">.</span><span class="n">CURVE3</span><span class="p">]</span>

            <span class="k">return</span> <span class="n">Path</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span> <span class="n">codes</span><span class="p">)</span>

    <span class="nd">@_register_style</span><span class="p">(</span><span class="n">_style_list</span><span class="p">)</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">Angle</span><span class="p">(</span><span class="n">_Base</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a piecewise continuous quadratic Bézier path between two</span>
<span class="sd">        points. The path has a one passing-through point placed at the</span>
<span class="sd">        intersecting point of two lines which cross the start and end point,</span>
<span class="sd">        and have a slope of *angleA* and *angleB*, respectively.</span>
<span class="sd">        The connecting edges are rounded with *rad*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angleA</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">angleB</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">rad</span><span class="o">=</span><span class="mf">0.</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            angleA : float</span>
<span class="sd">              Starting angle of the path.</span>

<span class="sd">            angleB : float</span>
<span class="sd">              Ending angle of the path.</span>

<span class="sd">            rad : float</span>
<span class="sd">              Rounding radius of the edge.</span>
<span class="sd">            &quot;&quot;&quot;</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">angleA</span> <span class="o">=</span> <span class="n">angleA</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">angleB</span> <span class="o">=</span> <span class="n">angleB</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">rad</span> <span class="o">=</span> <span class="n">rad</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">posA</span><span class="p">,</span> <span class="n">posB</span><span class="p">):</span>
            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">posA</span>
            <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">posB</span>

            <span class="n">cosA</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angleA</span><span class="p">))</span>
            <span class="n">sinA</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angleA</span><span class="p">))</span>
            <span class="n">cosB</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angleB</span><span class="p">))</span>
            <span class="n">sinB</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angleB</span><span class="p">))</span>

            <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span> <span class="o">=</span> <span class="n">get_intersection</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">cosA</span><span class="p">,</span> <span class="n">sinA</span><span class="p">,</span>
                                      <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">cosB</span><span class="p">,</span> <span class="n">sinB</span><span class="p">)</span>

            <span class="n">vertices</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)]</span>
            <span class="n">codes</span> <span class="o">=</span> <span class="p">[</span><span class="n">Path</span><span class="o">.</span><span class="n">MOVETO</span><span class="p">]</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rad</span> <span class="o">==</span> <span class="mf">0.</span><span class="p">:</span>
                <span class="n">vertices</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">cx</span><span class="p">,</span> <span class="n">cy</span><span class="p">))</span>
                <span class="n">codes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">LINETO</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dx1</span><span class="p">,</span> <span class="n">dy1</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">cx</span><span class="p">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">cy</span>
                <span class="n">d1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hypot</span><span class="p">(</span><span class="n">dx1</span><span class="p">,</span> <span class="n">dy1</span><span class="p">)</span>
                <span class="n">f1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rad</span> <span class="o">/</span> <span class="n">d1</span>
                <span class="n">dx2</span><span class="p">,</span> <span class="n">dy2</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">cx</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">cy</span>
                <span class="n">d2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hypot</span><span class="p">(</span><span class="n">dx2</span><span class="p">,</span> <span class="n">dy2</span><span class="p">)</span>
                <span class="n">f2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rad</span> <span class="o">/</span> <span class="n">d2</span>
                <span class="n">vertices</span><span class="o">.</span><span class="n">extend</span><span class="p">([(</span><span class="n">cx</span> <span class="o">+</span> <span class="n">dx1</span> <span class="o">*</span> <span class="n">f1</span><span class="p">,</span> <span class="n">cy</span> <span class="o">+</span> <span class="n">dy1</span> <span class="o">*</span> <span class="n">f1</span><span class="p">),</span>
                                 <span class="p">(</span><span class="n">cx</span><span class="p">,</span> <span class="n">cy</span><span class="p">),</span>
                                 <span class="p">(</span><span class="n">cx</span> <span class="o">+</span> <span class="n">dx2</span> <span class="o">*</span> <span class="n">f2</span><span class="p">,</span> <span class="n">cy</span> <span class="o">+</span> <span class="n">dy2</span> <span class="o">*</span> <span class="n">f2</span><span class="p">)])</span>
                <span class="n">codes</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">Path</span><span class="o">.</span><span class="n">LINETO</span><span class="p">,</span> <span class="n">Path</span><span class="o">.</span><span class="n">CURVE3</span><span class="p">,</span> <span class="n">Path</span><span class="o">.</span><span class="n">CURVE3</span><span class="p">])</span>

            <span class="n">vertices</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">))</span>
            <span class="n">codes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">LINETO</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">Path</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span> <span class="n">codes</span><span class="p">)</span>

    <span class="nd">@_register_style</span><span class="p">(</span><span class="n">_style_list</span><span class="p">)</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">Arc</span><span class="p">(</span><span class="n">_Base</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a piecewise continuous quadratic Bézier path between two</span>
<span class="sd">        points. The path can have two passing-through points, a</span>
<span class="sd">        point placed at the distance of *armA* and angle of *angleA* from</span>
<span class="sd">        point A, another point with respect to point B. The edges are</span>
<span class="sd">        rounded with *rad*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angleA</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">angleB</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">armA</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">armB</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rad</span><span class="o">=</span><span class="mf">0.</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            angleA : float</span>
<span class="sd">              Starting angle of the path.</span>

<span class="sd">            angleB : float</span>
<span class="sd">              Ending angle of the path.</span>

<span class="sd">            armA : float or None</span>
<span class="sd">              Length of the starting arm.</span>

<span class="sd">            armB : float or None</span>
<span class="sd">              Length of the ending arm.</span>

<span class="sd">            rad : float</span>
<span class="sd">              Rounding radius of the edges.</span>
<span class="sd">            &quot;&quot;&quot;</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">angleA</span> <span class="o">=</span> <span class="n">angleA</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">angleB</span> <span class="o">=</span> <span class="n">angleB</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">armA</span> <span class="o">=</span> <span class="n">armA</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">armB</span> <span class="o">=</span> <span class="n">armB</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">rad</span> <span class="o">=</span> <span class="n">rad</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">posA</span><span class="p">,</span> <span class="n">posB</span><span class="p">):</span>
            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">posA</span>
            <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">posB</span>

            <span class="n">vertices</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)]</span>
            <span class="n">rounded</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">codes</span> <span class="o">=</span> <span class="p">[</span><span class="n">Path</span><span class="o">.</span><span class="n">MOVETO</span><span class="p">]</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">armA</span><span class="p">:</span>
                <span class="n">cosA</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angleA</span><span class="p">))</span>
                <span class="n">sinA</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angleA</span><span class="p">))</span>
                <span class="c1"># x_armA, y_armB</span>
                <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">armA</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">rad</span>
                <span class="n">rounded</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">x1</span> <span class="o">+</span> <span class="n">d</span> <span class="o">*</span> <span class="n">cosA</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">d</span> <span class="o">*</span> <span class="n">sinA</span><span class="p">))</span>
                <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">armA</span>
                <span class="n">rounded</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">x1</span> <span class="o">+</span> <span class="n">d</span> <span class="o">*</span> <span class="n">cosA</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">d</span> <span class="o">*</span> <span class="n">sinA</span><span class="p">))</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">armB</span><span class="p">:</span>
                <span class="n">cosB</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angleB</span><span class="p">))</span>
                <span class="n">sinB</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angleB</span><span class="p">))</span>
                <span class="n">x_armB</span><span class="p">,</span> <span class="n">y_armB</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">armB</span> <span class="o">*</span> <span class="n">cosB</span><span class="p">,</span> <span class="n">y2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">armB</span> <span class="o">*</span> <span class="n">sinB</span>

                <span class="k">if</span> <span class="n">rounded</span><span class="p">:</span>
                    <span class="n">xp</span><span class="p">,</span> <span class="n">yp</span> <span class="o">=</span> <span class="n">rounded</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">x_armB</span> <span class="o">-</span> <span class="n">xp</span><span class="p">,</span> <span class="n">y_armB</span> <span class="o">-</span> <span class="n">yp</span>
                    <span class="n">dd</span> <span class="o">=</span> <span class="p">(</span><span class="n">dx</span> <span class="o">*</span> <span class="n">dx</span> <span class="o">+</span> <span class="n">dy</span> <span class="o">*</span> <span class="n">dy</span><span class="p">)</span> <span class="o">**</span> <span class="mf">.5</span>

                    <span class="n">rounded</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">xp</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">rad</span> <span class="o">*</span> <span class="n">dx</span> <span class="o">/</span> <span class="n">dd</span><span class="p">,</span>
                                    <span class="n">yp</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">rad</span> <span class="o">*</span> <span class="n">dy</span> <span class="o">/</span> <span class="n">dd</span><span class="p">))</span>
                    <span class="n">vertices</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">rounded</span><span class="p">)</span>
                    <span class="n">codes</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">Path</span><span class="o">.</span><span class="n">LINETO</span><span class="p">,</span>
                                  <span class="n">Path</span><span class="o">.</span><span class="n">CURVE3</span><span class="p">,</span>
                                  <span class="n">Path</span><span class="o">.</span><span class="n">CURVE3</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">xp</span><span class="p">,</span> <span class="n">yp</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">x_armB</span> <span class="o">-</span> <span class="n">xp</span><span class="p">,</span> <span class="n">y_armB</span> <span class="o">-</span> <span class="n">yp</span>
                    <span class="n">dd</span> <span class="o">=</span> <span class="p">(</span><span class="n">dx</span> <span class="o">*</span> <span class="n">dx</span> <span class="o">+</span> <span class="n">dy</span> <span class="o">*</span> <span class="n">dy</span><span class="p">)</span> <span class="o">**</span> <span class="mf">.5</span>

                <span class="n">d</span> <span class="o">=</span> <span class="n">dd</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">rad</span>
                <span class="n">rounded</span> <span class="o">=</span> <span class="p">[(</span><span class="n">xp</span> <span class="o">+</span> <span class="n">d</span> <span class="o">*</span> <span class="n">dx</span> <span class="o">/</span> <span class="n">dd</span><span class="p">,</span> <span class="n">yp</span> <span class="o">+</span> <span class="n">d</span> <span class="o">*</span> <span class="n">dy</span> <span class="o">/</span> <span class="n">dd</span><span class="p">),</span>
                           <span class="p">(</span><span class="n">x_armB</span><span class="p">,</span> <span class="n">y_armB</span><span class="p">)]</span>

            <span class="k">if</span> <span class="n">rounded</span><span class="p">:</span>
                <span class="n">xp</span><span class="p">,</span> <span class="n">yp</span> <span class="o">=</span> <span class="n">rounded</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">xp</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">yp</span>
                <span class="n">dd</span> <span class="o">=</span> <span class="p">(</span><span class="n">dx</span> <span class="o">*</span> <span class="n">dx</span> <span class="o">+</span> <span class="n">dy</span> <span class="o">*</span> <span class="n">dy</span><span class="p">)</span> <span class="o">**</span> <span class="mf">.5</span>

                <span class="n">rounded</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">xp</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">rad</span> <span class="o">*</span> <span class="n">dx</span> <span class="o">/</span> <span class="n">dd</span><span class="p">,</span>
                                <span class="n">yp</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">rad</span> <span class="o">*</span> <span class="n">dy</span> <span class="o">/</span> <span class="n">dd</span><span class="p">))</span>
                <span class="n">vertices</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">rounded</span><span class="p">)</span>
                <span class="n">codes</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">Path</span><span class="o">.</span><span class="n">LINETO</span><span class="p">,</span>
                              <span class="n">Path</span><span class="o">.</span><span class="n">CURVE3</span><span class="p">,</span>
                              <span class="n">Path</span><span class="o">.</span><span class="n">CURVE3</span><span class="p">])</span>

            <span class="n">vertices</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">))</span>
            <span class="n">codes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">LINETO</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">Path</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span> <span class="n">codes</span><span class="p">)</span>

    <span class="nd">@_register_style</span><span class="p">(</span><span class="n">_style_list</span><span class="p">)</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">Bar</span><span class="p">(</span><span class="n">_Base</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A line with *angle* between A and B with *armA* and *armB*. One of the</span>
<span class="sd">        arms is extended so that they are connected in a right angle. The</span>
<span class="sd">        length of *armA* is determined by (*armA* + *fraction* x AB distance).</span>
<span class="sd">        Same for *armB*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">armA</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">armB</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            armA : float</span>
<span class="sd">                Minimum length of armA.</span>

<span class="sd">            armB : float</span>
<span class="sd">                Minimum length of armB.</span>

<span class="sd">            fraction : float</span>
<span class="sd">                A fraction of the distance between two points that will be</span>
<span class="sd">                added to armA and armB.</span>

<span class="sd">            angle : float or None</span>
<span class="sd">                Angle of the connecting line (if None, parallel to A and B).</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">armA</span> <span class="o">=</span> <span class="n">armA</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">armB</span> <span class="o">=</span> <span class="n">armB</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fraction</span> <span class="o">=</span> <span class="n">fraction</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">angle</span> <span class="o">=</span> <span class="n">angle</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">posA</span><span class="p">,</span> <span class="n">posB</span><span class="p">):</span>
            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">posA</span>
            <span class="n">x20</span><span class="p">,</span> <span class="n">y20</span> <span class="o">=</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">posB</span>

            <span class="n">theta1</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span><span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span>
            <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span>
            <span class="n">dd</span> <span class="o">=</span> <span class="p">(</span><span class="n">dx</span> <span class="o">*</span> <span class="n">dx</span> <span class="o">+</span> <span class="n">dy</span> <span class="o">*</span> <span class="n">dy</span><span class="p">)</span> <span class="o">**</span> <span class="mf">.5</span>
            <span class="n">ddx</span><span class="p">,</span> <span class="n">ddy</span> <span class="o">=</span> <span class="n">dx</span> <span class="o">/</span> <span class="n">dd</span><span class="p">,</span> <span class="n">dy</span> <span class="o">/</span> <span class="n">dd</span>

            <span class="n">armA</span><span class="p">,</span> <span class="n">armB</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">armA</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">armB</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">theta0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angle</span><span class="p">)</span>
                <span class="n">dtheta</span> <span class="o">=</span> <span class="n">theta1</span> <span class="o">-</span> <span class="n">theta0</span>
                <span class="n">dl</span> <span class="o">=</span> <span class="n">dd</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">dtheta</span><span class="p">)</span>
                <span class="n">dL</span> <span class="o">=</span> <span class="n">dd</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">dtheta</span><span class="p">)</span>
                <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">dL</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta0</span><span class="p">),</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">dL</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta0</span><span class="p">)</span>
                <span class="n">armB</span> <span class="o">=</span> <span class="n">armB</span> <span class="o">-</span> <span class="n">dl</span>

                <span class="c1"># update</span>
                <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span>
                <span class="n">dd2</span> <span class="o">=</span> <span class="p">(</span><span class="n">dx</span> <span class="o">*</span> <span class="n">dx</span> <span class="o">+</span> <span class="n">dy</span> <span class="o">*</span> <span class="n">dy</span><span class="p">)</span> <span class="o">**</span> <span class="mf">.5</span>
                <span class="n">ddx</span><span class="p">,</span> <span class="n">ddy</span> <span class="o">=</span> <span class="n">dx</span> <span class="o">/</span> <span class="n">dd2</span><span class="p">,</span> <span class="n">dy</span> <span class="o">/</span> <span class="n">dd2</span>

            <span class="n">arm</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">armA</span><span class="p">,</span> <span class="n">armB</span><span class="p">)</span>
            <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fraction</span> <span class="o">*</span> <span class="n">dd</span> <span class="o">+</span> <span class="n">arm</span>

            <span class="n">cx1</span><span class="p">,</span> <span class="n">cy1</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">f</span> <span class="o">*</span> <span class="n">ddy</span><span class="p">,</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">f</span> <span class="o">*</span> <span class="n">ddx</span>
            <span class="n">cx2</span><span class="p">,</span> <span class="n">cy2</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">+</span> <span class="n">f</span> <span class="o">*</span> <span class="n">ddy</span><span class="p">,</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">f</span> <span class="o">*</span> <span class="n">ddx</span>

            <span class="n">vertices</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span>
                        <span class="p">(</span><span class="n">cx1</span><span class="p">,</span> <span class="n">cy1</span><span class="p">),</span>
                        <span class="p">(</span><span class="n">cx2</span><span class="p">,</span> <span class="n">cy2</span><span class="p">),</span>
                        <span class="p">(</span><span class="n">x20</span><span class="p">,</span> <span class="n">y20</span><span class="p">)]</span>
            <span class="n">codes</span> <span class="o">=</span> <span class="p">[</span><span class="n">Path</span><span class="o">.</span><span class="n">MOVETO</span><span class="p">,</span>
                     <span class="n">Path</span><span class="o">.</span><span class="n">LINETO</span><span class="p">,</span>
                     <span class="n">Path</span><span class="o">.</span><span class="n">LINETO</span><span class="p">,</span>
                     <span class="n">Path</span><span class="o">.</span><span class="n">LINETO</span><span class="p">]</span>

            <span class="k">return</span> <span class="n">Path</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span> <span class="n">codes</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_point_along_a_line</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the point on the line connecting (*x0*, *y0*) -- (*x1*, *y1*) whose</span>
<span class="sd">    distance from (*x0*, *y0*) is *d*.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">-</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y0</span> <span class="o">-</span> <span class="n">y1</span>
    <span class="n">ff</span> <span class="o">=</span> <span class="n">d</span> <span class="o">/</span> <span class="p">(</span><span class="n">dx</span> <span class="o">*</span> <span class="n">dx</span> <span class="o">+</span> <span class="n">dy</span> <span class="o">*</span> <span class="n">dy</span><span class="p">)</span> <span class="o">**</span> <span class="mf">.5</span>
    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">-</span> <span class="n">ff</span> <span class="o">*</span> <span class="n">dx</span><span class="p">,</span> <span class="n">y0</span> <span class="o">-</span> <span class="n">ff</span> <span class="o">*</span> <span class="n">dy</span>

    <span class="k">return</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span>


<span class="nd">@_docstring</span><span class="o">.</span><span class="n">interpd</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ArrowStyle</span><span class="p">(</span><span class="n">_Style</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    `ArrowStyle` is a container class which defines several</span>
<span class="sd">    arrowstyle classes, which is used to create an arrow path along a</span>
<span class="sd">    given path.  These are mainly used with `FancyArrowPatch`.</span>

<span class="sd">    An arrowstyle object can be either created as::</span>

<span class="sd">           ArrowStyle.Fancy(head_length=.4, head_width=.4, tail_width=.4)</span>

<span class="sd">    or::</span>

<span class="sd">           ArrowStyle(&quot;Fancy&quot;, head_length=.4, head_width=.4, tail_width=.4)</span>

<span class="sd">    or::</span>

<span class="sd">           ArrowStyle(&quot;Fancy, head_length=.4, head_width=.4, tail_width=.4&quot;)</span>

<span class="sd">    The following classes are defined</span>

<span class="sd">    %(ArrowStyle:table)s</span>

<span class="sd">    For an overview of the visual appearance, see</span>
<span class="sd">    :doc:`/gallery/text_labels_and_annotations/fancyarrow_demo`.</span>

<span class="sd">    An instance of any arrow style class is a callable object,</span>
<span class="sd">    whose call signature is::</span>

<span class="sd">        __call__(self, path, mutation_size, linewidth, aspect_ratio=1.)</span>

<span class="sd">    and it returns a tuple of a `.Path` instance and a boolean</span>
<span class="sd">    value. *path* is a `.Path` instance along which the arrow</span>
<span class="sd">    will be drawn. *mutation_size* and *aspect_ratio* have the same</span>
<span class="sd">    meaning as in `BoxStyle`. *linewidth* is a line width to be</span>
<span class="sd">    stroked. This is meant to be used to correct the location of the</span>
<span class="sd">    head so that it does not overshoot the destination point, but not all</span>
<span class="sd">    classes support it.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    *angleA* and *angleB* specify the orientation of the bracket, as either a</span>
<span class="sd">    clockwise or counterclockwise angle depending on the arrow type. 0 degrees</span>
<span class="sd">    means perpendicular to the line connecting the arrow&#39;s head and tail.</span>

<span class="sd">    .. plot:: gallery/text_labels_and_annotations/angles_on_bracket_arrows.py</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_style_list</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">class</span><span class="w"> </span><span class="nc">_Base</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Arrow Transmuter Base class</span>

<span class="sd">        ArrowTransmuterBase and its derivatives are used to make a fancy</span>
<span class="sd">        arrow around a given path. The __call__ method returns a path</span>
<span class="sd">        (which will be used to create a PathPatch instance) and a boolean</span>
<span class="sd">        value indicating the path is open therefore is not fillable.  This</span>
<span class="sd">        class is not an artist and actual drawing of the fancy arrow is</span>
<span class="sd">        done by the FancyArrowPatch class.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># The derived classes are required to be able to be initialized</span>
        <span class="c1"># w/o arguments, i.e., all its argument (except self) must have</span>
        <span class="c1"># the default values.</span>

        <span class="nd">@staticmethod</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">ensure_quadratic_bezier</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Some ArrowStyle classes only works with a simple quadratic</span>
<span class="sd">            Bézier curve (created with `.ConnectionStyle.Arc3` or</span>
<span class="sd">            `.ConnectionStyle.Angle3`). This static method checks if the</span>
<span class="sd">            provided path is a simple quadratic Bézier curve and returns its</span>
<span class="sd">            control points if true.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">segments</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">iter_segments</span><span class="p">())</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">segments</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">segments</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">Path</span><span class="o">.</span><span class="n">MOVETO</span> <span class="ow">or</span>
                    <span class="n">segments</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">Path</span><span class="o">.</span><span class="n">CURVE3</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;&#39;path&#39; is not a valid quadratic Bezier curve&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[</span><span class="o">*</span><span class="n">segments</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="o">*</span><span class="n">segments</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">transmute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">mutation_size</span><span class="p">,</span> <span class="n">linewidth</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            The transmute method is the very core of the ArrowStyle class and</span>
<span class="sd">            must be overridden in the subclasses. It receives the *path*</span>
<span class="sd">            object along which the arrow will be drawn, and the</span>
<span class="sd">            *mutation_size*, with which the arrow head etc. will be scaled.</span>
<span class="sd">            The *linewidth* may be used to adjust the path so that it does not</span>
<span class="sd">            pass beyond the given points. It returns a tuple of a `.Path`</span>
<span class="sd">            instance and a boolean. The boolean value indicate whether the</span>
<span class="sd">            path can be filled or not. The return value can also be a list of</span>
<span class="sd">            paths and list of booleans of the same length.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;Derived must override&#39;</span><span class="p">)</span>

        <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">mutation_size</span><span class="p">,</span> <span class="n">linewidth</span><span class="p">,</span>
                     <span class="n">aspect_ratio</span><span class="o">=</span><span class="mf">1.</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            The __call__ method is a thin wrapper around the transmute method</span>
<span class="sd">            and takes care of the aspect ratio.</span>
<span class="sd">            &quot;&quot;&quot;</span>

            <span class="k">if</span> <span class="n">aspect_ratio</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># Squeeze the given height by the aspect_ratio</span>
                <span class="n">vertices</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">vertices</span> <span class="o">/</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">aspect_ratio</span><span class="p">]</span>
                <span class="n">path_shrunk</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span> <span class="n">path</span><span class="o">.</span><span class="n">codes</span><span class="p">)</span>
                <span class="c1"># call transmute method with squeezed height.</span>
                <span class="n">path_mutated</span><span class="p">,</span> <span class="n">fillable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transmute</span><span class="p">(</span><span class="n">path_shrunk</span><span class="p">,</span>
                                                        <span class="n">mutation_size</span><span class="p">,</span>
                                                        <span class="n">linewidth</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">iterable</span><span class="p">(</span><span class="n">fillable</span><span class="p">):</span>
                    <span class="c1"># Restore the height</span>
                    <span class="n">path_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">Path</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">vertices</span> <span class="o">*</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">aspect_ratio</span><span class="p">],</span> <span class="n">p</span><span class="o">.</span><span class="n">codes</span><span class="p">)</span>
                                 <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">path_mutated</span><span class="p">]</span>
                    <span class="k">return</span> <span class="n">path_list</span><span class="p">,</span> <span class="n">fillable</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">path_mutated</span><span class="p">,</span> <span class="n">fillable</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transmute</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">mutation_size</span><span class="p">,</span> <span class="n">linewidth</span><span class="p">)</span>

    <span class="k">class</span><span class="w"> </span><span class="nc">_Curve</span><span class="p">(</span><span class="n">_Base</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A simple arrow which will work with any path instance. The</span>
<span class="sd">        returned path is the concatenation of the original path, and at</span>
<span class="sd">        most two paths representing the arrow head or bracket at the start</span>
<span class="sd">        point and at the end point. The arrow heads can be either open</span>
<span class="sd">        or closed.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">arrow</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span>
        <span class="n">fillbegin</span> <span class="o">=</span> <span class="n">fillend</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Whether arrows are filled.</span>

        <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=</span><span class="mf">.4</span><span class="p">,</span> <span class="n">head_width</span><span class="o">=</span><span class="mf">.2</span><span class="p">,</span> <span class="n">widthA</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">widthB</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span>
                     <span class="n">lengthA</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">lengthB</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">angleA</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">angleB</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scaleA</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">scaleB</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            head_length : float, default: 0.4</span>
<span class="sd">                Length of the arrow head, relative to *mutation_size*.</span>
<span class="sd">            head_width : float, default: 0.2</span>
<span class="sd">                Width of the arrow head, relative to *mutation_size*.</span>
<span class="sd">            widthA, widthB : float, default: 1.0</span>
<span class="sd">                Width of the bracket.</span>
<span class="sd">            lengthA, lengthB : float, default: 0.2</span>
<span class="sd">                Length of the bracket.</span>
<span class="sd">            angleA, angleB : float, default: 0</span>
<span class="sd">                Orientation of the bracket, as a counterclockwise angle.</span>
<span class="sd">                0 degrees means perpendicular to the line.</span>
<span class="sd">            scaleA, scaleB : float, default: *mutation_size*</span>
<span class="sd">                The scale of the brackets.</span>
<span class="sd">            &quot;&quot;&quot;</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">head_length</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">head_width</span> <span class="o">=</span> <span class="n">head_length</span><span class="p">,</span> <span class="n">head_width</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widthA</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">widthB</span> <span class="o">=</span> <span class="n">widthA</span><span class="p">,</span> <span class="n">widthB</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lengthA</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lengthB</span> <span class="o">=</span> <span class="n">lengthA</span><span class="p">,</span> <span class="n">lengthB</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">angleA</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">angleB</span> <span class="o">=</span> <span class="n">angleA</span><span class="p">,</span> <span class="n">angleB</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scaleA</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaleB</span> <span class="o">=</span> <span class="n">scaleA</span><span class="p">,</span> <span class="n">scaleB</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_beginarrow_head</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_beginarrow_bracket</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_endarrow_head</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_endarrow_bracket</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="k">if</span> <span class="s2">&quot;-&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">arrow</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;arrow must have the &#39;-&#39; between &quot;</span>
                                 <span class="s2">&quot;the two heads&quot;</span><span class="p">)</span>

            <span class="n">beginarrow</span><span class="p">,</span> <span class="n">endarrow</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">arrow</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">beginarrow</span> <span class="o">==</span> <span class="s2">&quot;&lt;&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_beginarrow_head</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_beginarrow_bracket</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">elif</span> <span class="n">beginarrow</span> <span class="o">==</span> <span class="s2">&quot;&lt;|&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_beginarrow_head</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_beginarrow_bracket</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fillbegin</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="n">beginarrow</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;]&quot;</span><span class="p">,</span> <span class="s2">&quot;|&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_beginarrow_head</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_beginarrow_bracket</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="k">if</span> <span class="n">endarrow</span> <span class="o">==</span> <span class="s2">&quot;&gt;&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_endarrow_head</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_endarrow_bracket</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">elif</span> <span class="n">endarrow</span> <span class="o">==</span> <span class="s2">&quot;|&gt;&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_endarrow_head</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_endarrow_bracket</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fillend</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="n">endarrow</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;[&quot;</span><span class="p">,</span> <span class="s2">&quot;|&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_endarrow_head</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_endarrow_bracket</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">_get_arrow_wedge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
                             <span class="n">head_dist</span><span class="p">,</span> <span class="n">cos_t</span><span class="p">,</span> <span class="n">sin_t</span><span class="p">,</span> <span class="n">linewidth</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Return the paths for arrow heads. Since arrow lines are</span>
<span class="sd">            drawn with capstyle=projected, The arrow goes beyond the</span>
<span class="sd">            desired point. This method also returns the amount of the path</span>
<span class="sd">            to be shrunken so that it does not overshoot.</span>
<span class="sd">            &quot;&quot;&quot;</span>

            <span class="c1"># arrow from x0, y0 to x1, y1</span>
            <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">-</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y0</span> <span class="o">-</span> <span class="n">y1</span>

            <span class="n">cp_distance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hypot</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">)</span>

            <span class="c1"># pad_projected : amount of pad to account the</span>
            <span class="c1"># overshooting of the projection of the wedge</span>
            <span class="n">pad_projected</span> <span class="o">=</span> <span class="p">(</span><span class="mf">.5</span> <span class="o">*</span> <span class="n">linewidth</span> <span class="o">/</span> <span class="n">sin_t</span><span class="p">)</span>

            <span class="c1"># Account for division by zero</span>
            <span class="k">if</span> <span class="n">cp_distance</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">cp_distance</span> <span class="o">=</span> <span class="mi">1</span>

            <span class="c1"># apply pad for projected edge</span>
            <span class="n">ddx</span> <span class="o">=</span> <span class="n">pad_projected</span> <span class="o">*</span> <span class="n">dx</span> <span class="o">/</span> <span class="n">cp_distance</span>
            <span class="n">ddy</span> <span class="o">=</span> <span class="n">pad_projected</span> <span class="o">*</span> <span class="n">dy</span> <span class="o">/</span> <span class="n">cp_distance</span>

            <span class="c1"># offset for arrow wedge</span>
            <span class="n">dx</span> <span class="o">=</span> <span class="n">dx</span> <span class="o">/</span> <span class="n">cp_distance</span> <span class="o">*</span> <span class="n">head_dist</span>
            <span class="n">dy</span> <span class="o">=</span> <span class="n">dy</span> <span class="o">/</span> <span class="n">cp_distance</span> <span class="o">*</span> <span class="n">head_dist</span>

            <span class="n">dx1</span><span class="p">,</span> <span class="n">dy1</span> <span class="o">=</span> <span class="n">cos_t</span> <span class="o">*</span> <span class="n">dx</span> <span class="o">+</span> <span class="n">sin_t</span> <span class="o">*</span> <span class="n">dy</span><span class="p">,</span> <span class="o">-</span><span class="n">sin_t</span> <span class="o">*</span> <span class="n">dx</span> <span class="o">+</span> <span class="n">cos_t</span> <span class="o">*</span> <span class="n">dy</span>
            <span class="n">dx2</span><span class="p">,</span> <span class="n">dy2</span> <span class="o">=</span> <span class="n">cos_t</span> <span class="o">*</span> <span class="n">dx</span> <span class="o">-</span> <span class="n">sin_t</span> <span class="o">*</span> <span class="n">dy</span><span class="p">,</span> <span class="n">sin_t</span> <span class="o">*</span> <span class="n">dx</span> <span class="o">+</span> <span class="n">cos_t</span> <span class="o">*</span> <span class="n">dy</span>

            <span class="n">vertices_arrow</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x1</span> <span class="o">+</span> <span class="n">ddx</span> <span class="o">+</span> <span class="n">dx1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">ddy</span> <span class="o">+</span> <span class="n">dy1</span><span class="p">),</span>
                              <span class="p">(</span><span class="n">x1</span> <span class="o">+</span> <span class="n">ddx</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">ddy</span><span class="p">),</span>
                              <span class="p">(</span><span class="n">x1</span> <span class="o">+</span> <span class="n">ddx</span> <span class="o">+</span> <span class="n">dx2</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">ddy</span> <span class="o">+</span> <span class="n">dy2</span><span class="p">)]</span>
            <span class="n">codes_arrow</span> <span class="o">=</span> <span class="p">[</span><span class="n">Path</span><span class="o">.</span><span class="n">MOVETO</span><span class="p">,</span>
                           <span class="n">Path</span><span class="o">.</span><span class="n">LINETO</span><span class="p">,</span>
                           <span class="n">Path</span><span class="o">.</span><span class="n">LINETO</span><span class="p">]</span>

            <span class="k">return</span> <span class="n">vertices_arrow</span><span class="p">,</span> <span class="n">codes_arrow</span><span class="p">,</span> <span class="n">ddx</span><span class="p">,</span> <span class="n">ddy</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">_get_bracket</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span>
                         <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">angle</span><span class="p">):</span>

            <span class="n">cos_t</span><span class="p">,</span> <span class="n">sin_t</span> <span class="o">=</span> <span class="n">get_cos_sin</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">)</span>

            <span class="c1"># arrow from x0, y0 to x1, y1</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.bezier</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_normal_points</span>
            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">get_normal_points</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">cos_t</span><span class="p">,</span> <span class="n">sin_t</span><span class="p">,</span> <span class="n">width</span><span class="p">)</span>

            <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="n">length</span> <span class="o">*</span> <span class="n">cos_t</span><span class="p">,</span> <span class="n">length</span> <span class="o">*</span> <span class="n">sin_t</span>

            <span class="n">vertices_arrow</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x1</span> <span class="o">+</span> <span class="n">dx</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">dy</span><span class="p">),</span>
                              <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span>
                              <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">),</span>
                              <span class="p">(</span><span class="n">x2</span> <span class="o">+</span> <span class="n">dx</span><span class="p">,</span> <span class="n">y2</span> <span class="o">+</span> <span class="n">dy</span><span class="p">)]</span>
            <span class="n">codes_arrow</span> <span class="o">=</span> <span class="p">[</span><span class="n">Path</span><span class="o">.</span><span class="n">MOVETO</span><span class="p">,</span>
                           <span class="n">Path</span><span class="o">.</span><span class="n">LINETO</span><span class="p">,</span>
                           <span class="n">Path</span><span class="o">.</span><span class="n">LINETO</span><span class="p">,</span>
                           <span class="n">Path</span><span class="o">.</span><span class="n">LINETO</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">angle</span><span class="p">:</span>
                <span class="n">trans</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Affine2D</span><span class="p">()</span><span class="o">.</span><span class="n">rotate_deg_around</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">angle</span><span class="p">)</span>
                <span class="n">vertices_arrow</span> <span class="o">=</span> <span class="n">trans</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">vertices_arrow</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">vertices_arrow</span><span class="p">,</span> <span class="n">codes_arrow</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">transmute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">mutation_size</span><span class="p">,</span> <span class="n">linewidth</span><span class="p">):</span>
            <span class="c1"># docstring inherited</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_beginarrow_head</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_endarrow_head</span><span class="p">:</span>
                <span class="n">head_length</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">head_length</span> <span class="o">*</span> <span class="n">mutation_size</span>
                <span class="n">head_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">head_width</span> <span class="o">*</span> <span class="n">mutation_size</span>
                <span class="n">head_dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hypot</span><span class="p">(</span><span class="n">head_length</span><span class="p">,</span> <span class="n">head_width</span><span class="p">)</span>
                <span class="n">cos_t</span><span class="p">,</span> <span class="n">sin_t</span> <span class="o">=</span> <span class="n">head_length</span> <span class="o">/</span> <span class="n">head_dist</span><span class="p">,</span> <span class="n">head_width</span> <span class="o">/</span> <span class="n">head_dist</span>

            <span class="n">scaleA</span> <span class="o">=</span> <span class="n">mutation_size</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaleA</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaleA</span>
            <span class="n">scaleB</span> <span class="o">=</span> <span class="n">mutation_size</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaleB</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">scaleB</span>

            <span class="c1"># begin arrow</span>
            <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

            <span class="c1"># If there is no room for an arrow and a line, then skip the arrow</span>
            <span class="n">has_begin_arrow</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_beginarrow_head</span> <span class="ow">and</span> <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">)</span> <span class="o">!=</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span>
            <span class="n">verticesA</span><span class="p">,</span> <span class="n">codesA</span><span class="p">,</span> <span class="n">ddxA</span><span class="p">,</span> <span class="n">ddyA</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_get_arrow_wedge</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span>
                                      <span class="n">head_dist</span><span class="p">,</span> <span class="n">cos_t</span><span class="p">,</span> <span class="n">sin_t</span><span class="p">,</span> <span class="n">linewidth</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">has_begin_arrow</span>
                <span class="k">else</span> <span class="p">([],</span> <span class="p">[],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="p">)</span>

            <span class="c1"># end arrow</span>
            <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">x3</span><span class="p">,</span> <span class="n">y3</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

            <span class="c1"># If there is no room for an arrow and a line, then skip the arrow</span>
            <span class="n">has_end_arrow</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_endarrow_head</span> <span class="ow">and</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span> <span class="o">!=</span> <span class="p">(</span><span class="n">x3</span><span class="p">,</span> <span class="n">y3</span><span class="p">)</span>
            <span class="n">verticesB</span><span class="p">,</span> <span class="n">codesB</span><span class="p">,</span> <span class="n">ddxB</span><span class="p">,</span> <span class="n">ddyB</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_get_arrow_wedge</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">y3</span><span class="p">,</span>
                                      <span class="n">head_dist</span><span class="p">,</span> <span class="n">cos_t</span><span class="p">,</span> <span class="n">sin_t</span><span class="p">,</span> <span class="n">linewidth</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">has_end_arrow</span>
                <span class="k">else</span> <span class="p">([],</span> <span class="p">[],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="p">)</span>

            <span class="c1"># This simple code will not work if ddx, ddy is greater than the</span>
            <span class="c1"># separation between vertices.</span>
            <span class="n">paths</span> <span class="o">=</span> <span class="p">[</span><span class="n">Path</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([[(</span><span class="n">x0</span> <span class="o">+</span> <span class="n">ddxA</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">ddyA</span><span class="p">)],</span>
                                          <span class="n">path</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                          <span class="p">[(</span><span class="n">x3</span> <span class="o">+</span> <span class="n">ddxB</span><span class="p">,</span> <span class="n">y3</span> <span class="o">+</span> <span class="n">ddyB</span><span class="p">)]]),</span>
                          <span class="n">path</span><span class="o">.</span><span class="n">codes</span><span class="p">)]</span>
            <span class="n">fills</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">has_begin_arrow</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fillbegin</span><span class="p">:</span>
                    <span class="n">paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="n">Path</span><span class="p">([</span><span class="o">*</span><span class="n">verticesA</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span> <span class="p">[</span><span class="o">*</span><span class="n">codesA</span><span class="p">,</span> <span class="n">Path</span><span class="o">.</span><span class="n">CLOSEPOLY</span><span class="p">]))</span>
                    <span class="n">fills</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">verticesA</span><span class="p">,</span> <span class="n">codesA</span><span class="p">))</span>
                    <span class="n">fills</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_beginarrow_bracket</span><span class="p">:</span>
                <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">verticesA</span><span class="p">,</span> <span class="n">codesA</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_bracket</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
                                                      <span class="bp">self</span><span class="o">.</span><span class="n">widthA</span> <span class="o">*</span> <span class="n">scaleA</span><span class="p">,</span>
                                                      <span class="bp">self</span><span class="o">.</span><span class="n">lengthA</span> <span class="o">*</span> <span class="n">scaleA</span><span class="p">,</span>
                                                      <span class="bp">self</span><span class="o">.</span><span class="n">angleA</span><span class="p">)</span>

                <span class="n">paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">verticesA</span><span class="p">,</span> <span class="n">codesA</span><span class="p">))</span>
                <span class="n">fills</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">has_end_arrow</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fillend</span><span class="p">:</span>
                    <span class="n">fills</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                    <span class="n">paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="n">Path</span><span class="p">([</span><span class="o">*</span><span class="n">verticesB</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span> <span class="p">[</span><span class="o">*</span><span class="n">codesB</span><span class="p">,</span> <span class="n">Path</span><span class="o">.</span><span class="n">CLOSEPOLY</span><span class="p">]))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">fills</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                    <span class="n">paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">verticesB</span><span class="p">,</span> <span class="n">codesB</span><span class="p">))</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_endarrow_bracket</span><span class="p">:</span>
                <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
                <span class="n">verticesB</span><span class="p">,</span> <span class="n">codesB</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_bracket</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span>
                                                      <span class="bp">self</span><span class="o">.</span><span class="n">widthB</span> <span class="o">*</span> <span class="n">scaleB</span><span class="p">,</span>
                                                      <span class="bp">self</span><span class="o">.</span><span class="n">lengthB</span> <span class="o">*</span> <span class="n">scaleB</span><span class="p">,</span>
                                                      <span class="bp">self</span><span class="o">.</span><span class="n">angleB</span><span class="p">)</span>

                <span class="n">paths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">verticesB</span><span class="p">,</span> <span class="n">codesB</span><span class="p">))</span>
                <span class="n">fills</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">paths</span><span class="p">,</span> <span class="n">fills</span>

    <span class="nd">@_register_style</span><span class="p">(</span><span class="n">_style_list</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">)</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">Curve</span><span class="p">(</span><span class="n">_Curve</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A simple curve without any arrow head.&quot;&quot;&quot;</span>

        <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># hide head_length, head_width</span>
            <span class="c1"># These attributes (whose values come from backcompat) only matter</span>
            <span class="c1"># if someone modifies beginarrow/etc. on an ArrowStyle instance.</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">head_length</span><span class="o">=</span><span class="mf">.2</span><span class="p">,</span> <span class="n">head_width</span><span class="o">=</span><span class="mf">.1</span><span class="p">)</span>

    <span class="nd">@_register_style</span><span class="p">(</span><span class="n">_style_list</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;&lt;-&quot;</span><span class="p">)</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">CurveA</span><span class="p">(</span><span class="n">_Curve</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;An arrow with a head at its start point.&quot;&quot;&quot;</span>
        <span class="n">arrow</span> <span class="o">=</span> <span class="s2">&quot;&lt;-&quot;</span>

    <span class="nd">@_register_style</span><span class="p">(</span><span class="n">_style_list</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;-&gt;&quot;</span><span class="p">)</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">CurveB</span><span class="p">(</span><span class="n">_Curve</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;An arrow with a head at its end point.&quot;&quot;&quot;</span>
        <span class="n">arrow</span> <span class="o">=</span> <span class="s2">&quot;-&gt;&quot;</span>

    <span class="nd">@_register_style</span><span class="p">(</span><span class="n">_style_list</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;&lt;-&gt;&quot;</span><span class="p">)</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">CurveAB</span><span class="p">(</span><span class="n">_Curve</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;An arrow with heads both at the start and the end point.&quot;&quot;&quot;</span>
        <span class="n">arrow</span> <span class="o">=</span> <span class="s2">&quot;&lt;-&gt;&quot;</span>

    <span class="nd">@_register_style</span><span class="p">(</span><span class="n">_style_list</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;&lt;|-&quot;</span><span class="p">)</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">CurveFilledA</span><span class="p">(</span><span class="n">_Curve</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;An arrow with filled triangle head at the start.&quot;&quot;&quot;</span>
        <span class="n">arrow</span> <span class="o">=</span> <span class="s2">&quot;&lt;|-&quot;</span>

    <span class="nd">@_register_style</span><span class="p">(</span><span class="n">_style_list</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;-|&gt;&quot;</span><span class="p">)</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">CurveFilledB</span><span class="p">(</span><span class="n">_Curve</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;An arrow with filled triangle head at the end.&quot;&quot;&quot;</span>
        <span class="n">arrow</span> <span class="o">=</span> <span class="s2">&quot;-|&gt;&quot;</span>

    <span class="nd">@_register_style</span><span class="p">(</span><span class="n">_style_list</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;&lt;|-|&gt;&quot;</span><span class="p">)</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">CurveFilledAB</span><span class="p">(</span><span class="n">_Curve</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;An arrow with filled triangle heads at both ends.&quot;&quot;&quot;</span>
        <span class="n">arrow</span> <span class="o">=</span> <span class="s2">&quot;&lt;|-|&gt;&quot;</span>

    <span class="nd">@_register_style</span><span class="p">(</span><span class="n">_style_list</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;]-&quot;</span><span class="p">)</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">BracketA</span><span class="p">(</span><span class="n">_Curve</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;An arrow with an outward square bracket at its start.&quot;&quot;&quot;</span>
        <span class="n">arrow</span> <span class="o">=</span> <span class="s2">&quot;]-&quot;</span>

        <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widthA</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">lengthA</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">angleA</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            widthA : float, default: 1.0</span>
<span class="sd">                Width of the bracket.</span>
<span class="sd">            lengthA : float, default: 0.2</span>
<span class="sd">                Length of the bracket.</span>
<span class="sd">            angleA : float, default: 0 degrees</span>
<span class="sd">                Orientation of the bracket, as a counterclockwise angle.</span>
<span class="sd">                0 degrees means perpendicular to the line.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">widthA</span><span class="o">=</span><span class="n">widthA</span><span class="p">,</span> <span class="n">lengthA</span><span class="o">=</span><span class="n">lengthA</span><span class="p">,</span> <span class="n">angleA</span><span class="o">=</span><span class="n">angleA</span><span class="p">)</span>

    <span class="nd">@_register_style</span><span class="p">(</span><span class="n">_style_list</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;-[&quot;</span><span class="p">)</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">BracketB</span><span class="p">(</span><span class="n">_Curve</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;An arrow with an outward square bracket at its end.&quot;&quot;&quot;</span>
        <span class="n">arrow</span> <span class="o">=</span> <span class="s2">&quot;-[&quot;</span>

        <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widthB</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">lengthB</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">angleB</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            widthB : float, default: 1.0</span>
<span class="sd">                Width of the bracket.</span>
<span class="sd">            lengthB : float, default: 0.2</span>
<span class="sd">                Length of the bracket.</span>
<span class="sd">            angleB : float, default: 0 degrees</span>
<span class="sd">                Orientation of the bracket, as a counterclockwise angle.</span>
<span class="sd">                0 degrees means perpendicular to the line.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">widthB</span><span class="o">=</span><span class="n">widthB</span><span class="p">,</span> <span class="n">lengthB</span><span class="o">=</span><span class="n">lengthB</span><span class="p">,</span> <span class="n">angleB</span><span class="o">=</span><span class="n">angleB</span><span class="p">)</span>

    <span class="nd">@_register_style</span><span class="p">(</span><span class="n">_style_list</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;]-[&quot;</span><span class="p">)</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">BracketAB</span><span class="p">(</span><span class="n">_Curve</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;An arrow with outward square brackets at both ends.&quot;&quot;&quot;</span>
        <span class="n">arrow</span> <span class="o">=</span> <span class="s2">&quot;]-[&quot;</span>

        <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                     <span class="n">widthA</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">lengthA</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">angleA</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                     <span class="n">widthB</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">lengthB</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">angleB</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            widthA, widthB : float, default: 1.0</span>
<span class="sd">                Width of the bracket.</span>
<span class="sd">            lengthA, lengthB : float, default: 0.2</span>
<span class="sd">                Length of the bracket.</span>
<span class="sd">            angleA, angleB : float, default: 0 degrees</span>
<span class="sd">                Orientation of the bracket, as a counterclockwise angle.</span>
<span class="sd">                0 degrees means perpendicular to the line.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">widthA</span><span class="o">=</span><span class="n">widthA</span><span class="p">,</span> <span class="n">lengthA</span><span class="o">=</span><span class="n">lengthA</span><span class="p">,</span> <span class="n">angleA</span><span class="o">=</span><span class="n">angleA</span><span class="p">,</span>
                             <span class="n">widthB</span><span class="o">=</span><span class="n">widthB</span><span class="p">,</span> <span class="n">lengthB</span><span class="o">=</span><span class="n">lengthB</span><span class="p">,</span> <span class="n">angleB</span><span class="o">=</span><span class="n">angleB</span><span class="p">)</span>

    <span class="nd">@_register_style</span><span class="p">(</span><span class="n">_style_list</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;|-|&quot;</span><span class="p">)</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">BarAB</span><span class="p">(</span><span class="n">_Curve</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;An arrow with vertical bars ``|`` at both ends.&quot;&quot;&quot;</span>
        <span class="n">arrow</span> <span class="o">=</span> <span class="s2">&quot;|-|&quot;</span>

        <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widthA</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">angleA</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">widthB</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">angleB</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            widthA, widthB : float, default: 1.0</span>
<span class="sd">                Width of the bracket.</span>
<span class="sd">            angleA, angleB : float, default: 0 degrees</span>
<span class="sd">                Orientation of the bracket, as a counterclockwise angle.</span>
<span class="sd">                0 degrees means perpendicular to the line.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">widthA</span><span class="o">=</span><span class="n">widthA</span><span class="p">,</span> <span class="n">lengthA</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">angleA</span><span class="o">=</span><span class="n">angleA</span><span class="p">,</span>
                             <span class="n">widthB</span><span class="o">=</span><span class="n">widthB</span><span class="p">,</span> <span class="n">lengthB</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">angleB</span><span class="o">=</span><span class="n">angleB</span><span class="p">)</span>

    <span class="nd">@_register_style</span><span class="p">(</span><span class="n">_style_list</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;]-&gt;&#39;</span><span class="p">)</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">BracketCurve</span><span class="p">(</span><span class="n">_Curve</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        An arrow with an outward square bracket at its start and a head at</span>
<span class="sd">        the end.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">arrow</span> <span class="o">=</span> <span class="s2">&quot;]-&gt;&quot;</span>

        <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widthA</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">lengthA</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">angleA</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            widthA : float, default: 1.0</span>
<span class="sd">                Width of the bracket.</span>
<span class="sd">            lengthA : float, default: 0.2</span>
<span class="sd">                Length of the bracket.</span>
<span class="sd">            angleA : float, default: 0 degrees</span>
<span class="sd">                Orientation of the bracket, as a counterclockwise angle.</span>
<span class="sd">                0 degrees means perpendicular to the line.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">widthA</span><span class="o">=</span><span class="n">widthA</span><span class="p">,</span> <span class="n">lengthA</span><span class="o">=</span><span class="n">lengthA</span><span class="p">,</span> <span class="n">angleA</span><span class="o">=</span><span class="n">angleA</span><span class="p">)</span>

    <span class="nd">@_register_style</span><span class="p">(</span><span class="n">_style_list</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;&lt;-[&#39;</span><span class="p">)</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">CurveBracket</span><span class="p">(</span><span class="n">_Curve</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        An arrow with an outward square bracket at its end and a head at</span>
<span class="sd">        the start.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">arrow</span> <span class="o">=</span> <span class="s2">&quot;&lt;-[&quot;</span>

        <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widthB</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">lengthB</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">angleB</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            widthB : float, default: 1.0</span>
<span class="sd">                Width of the bracket.</span>
<span class="sd">            lengthB : float, default: 0.2</span>
<span class="sd">                Length of the bracket.</span>
<span class="sd">            angleB : float, default: 0 degrees</span>
<span class="sd">                Orientation of the bracket, as a counterclockwise angle.</span>
<span class="sd">                0 degrees means perpendicular to the line.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">widthB</span><span class="o">=</span><span class="n">widthB</span><span class="p">,</span> <span class="n">lengthB</span><span class="o">=</span><span class="n">lengthB</span><span class="p">,</span> <span class="n">angleB</span><span class="o">=</span><span class="n">angleB</span><span class="p">)</span>

    <span class="nd">@_register_style</span><span class="p">(</span><span class="n">_style_list</span><span class="p">)</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">Simple</span><span class="p">(</span><span class="n">_Base</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A simple arrow. Only works with a quadratic Bézier curve.&quot;&quot;&quot;</span>

        <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span> <span class="n">head_width</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span> <span class="n">tail_width</span><span class="o">=</span><span class="mf">.2</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            head_length : float, default: 0.5</span>
<span class="sd">                Length of the arrow head.</span>

<span class="sd">            head_width : float, default: 0.5</span>
<span class="sd">                Width of the arrow head.</span>

<span class="sd">            tail_width : float, default: 0.2</span>
<span class="sd">                Width of the arrow tail.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">head_length</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">head_width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tail_width</span> <span class="o">=</span> \
                <span class="n">head_length</span><span class="p">,</span> <span class="n">head_width</span><span class="p">,</span> <span class="n">tail_width</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">transmute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">mutation_size</span><span class="p">,</span> <span class="n">linewidth</span><span class="p">):</span>
            <span class="c1"># docstring inherited</span>
            <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ensure_quadratic_bezier</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

            <span class="c1"># divide the path into a head and a tail</span>
            <span class="n">head_length</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">head_length</span> <span class="o">*</span> <span class="n">mutation_size</span>
            <span class="n">in_f</span> <span class="o">=</span> <span class="n">inside_circle</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">head_length</span><span class="p">)</span>
            <span class="n">arrow_path</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)]</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">arrow_out</span><span class="p">,</span> <span class="n">arrow_in</span> <span class="o">=</span> \
                    <span class="n">split_bezier_intersecting_with_closedpath</span><span class="p">(</span><span class="n">arrow_path</span><span class="p">,</span> <span class="n">in_f</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">NonIntersectingPathException</span><span class="p">:</span>
                <span class="c1"># if this happens, make a straight line of the head_length</span>
                <span class="c1"># long.</span>
                <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">_point_along_a_line</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">head_length</span><span class="p">)</span>
                <span class="n">x1n</span><span class="p">,</span> <span class="n">y1n</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">x0</span> <span class="o">+</span> <span class="n">x2</span><span class="p">),</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">y0</span> <span class="o">+</span> <span class="n">y2</span><span class="p">)</span>
                <span class="n">arrow_in</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span> <span class="p">(</span><span class="n">x1n</span><span class="p">,</span> <span class="n">y1n</span><span class="p">),</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)]</span>
                <span class="n">arrow_out</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="c1"># head</span>
            <span class="n">head_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">head_width</span> <span class="o">*</span> <span class="n">mutation_size</span>
            <span class="n">head_left</span><span class="p">,</span> <span class="n">head_right</span> <span class="o">=</span> <span class="n">make_wedged_bezier2</span><span class="p">(</span><span class="n">arrow_in</span><span class="p">,</span>
                                                        <span class="n">head_width</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">,</span> <span class="n">wm</span><span class="o">=</span><span class="mf">.5</span><span class="p">)</span>

            <span class="c1"># tail</span>
            <span class="k">if</span> <span class="n">arrow_out</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">tail_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tail_width</span> <span class="o">*</span> <span class="n">mutation_size</span>
                <span class="n">tail_left</span><span class="p">,</span> <span class="n">tail_right</span> <span class="o">=</span> <span class="n">get_parallels</span><span class="p">(</span><span class="n">arrow_out</span><span class="p">,</span>
                                                      <span class="n">tail_width</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">)</span>

                <span class="n">patch_path</span> <span class="o">=</span> <span class="p">[(</span><span class="n">Path</span><span class="o">.</span><span class="n">MOVETO</span><span class="p">,</span> <span class="n">tail_right</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                              <span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">CURVE3</span><span class="p">,</span> <span class="n">tail_right</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
                              <span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">CURVE3</span><span class="p">,</span> <span class="n">tail_right</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
                              <span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">LINETO</span><span class="p">,</span> <span class="n">head_right</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                              <span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">CURVE3</span><span class="p">,</span> <span class="n">head_right</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
                              <span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">CURVE3</span><span class="p">,</span> <span class="n">head_right</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
                              <span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">CURVE3</span><span class="p">,</span> <span class="n">head_left</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
                              <span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">CURVE3</span><span class="p">,</span> <span class="n">head_left</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                              <span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">LINETO</span><span class="p">,</span> <span class="n">tail_left</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
                              <span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">CURVE3</span><span class="p">,</span> <span class="n">tail_left</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
                              <span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">CURVE3</span><span class="p">,</span> <span class="n">tail_left</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                              <span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">LINETO</span><span class="p">,</span> <span class="n">tail_right</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                              <span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">CLOSEPOLY</span><span class="p">,</span> <span class="n">tail_right</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                              <span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">patch_path</span> <span class="o">=</span> <span class="p">[(</span><span class="n">Path</span><span class="o">.</span><span class="n">MOVETO</span><span class="p">,</span> <span class="n">head_right</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                              <span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">CURVE3</span><span class="p">,</span> <span class="n">head_right</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
                              <span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">CURVE3</span><span class="p">,</span> <span class="n">head_right</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
                              <span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">CURVE3</span><span class="p">,</span> <span class="n">head_left</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
                              <span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">CURVE3</span><span class="p">,</span> <span class="n">head_left</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                              <span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">CLOSEPOLY</span><span class="p">,</span> <span class="n">head_left</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                              <span class="p">]</span>

            <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">([</span><span class="n">p</span> <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">patch_path</span><span class="p">],</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">patch_path</span><span class="p">])</span>

            <span class="k">return</span> <span class="n">path</span><span class="p">,</span> <span class="kc">True</span>

    <span class="nd">@_register_style</span><span class="p">(</span><span class="n">_style_list</span><span class="p">)</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">Fancy</span><span class="p">(</span><span class="n">_Base</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A fancy arrow. Only works with a quadratic Bézier curve.&quot;&quot;&quot;</span>

        <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=</span><span class="mf">.4</span><span class="p">,</span> <span class="n">head_width</span><span class="o">=</span><span class="mf">.4</span><span class="p">,</span> <span class="n">tail_width</span><span class="o">=</span><span class="mf">.4</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            head_length : float, default: 0.4</span>
<span class="sd">                Length of the arrow head.</span>

<span class="sd">            head_width : float, default: 0.4</span>
<span class="sd">                Width of the arrow head.</span>

<span class="sd">            tail_width : float, default: 0.4</span>
<span class="sd">                Width of the arrow tail.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">head_length</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">head_width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tail_width</span> <span class="o">=</span> \
                <span class="n">head_length</span><span class="p">,</span> <span class="n">head_width</span><span class="p">,</span> <span class="n">tail_width</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">transmute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">mutation_size</span><span class="p">,</span> <span class="n">linewidth</span><span class="p">):</span>
            <span class="c1"># docstring inherited</span>
            <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ensure_quadratic_bezier</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

            <span class="c1"># divide the path into a head and a tail</span>
            <span class="n">head_length</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">head_length</span> <span class="o">*</span> <span class="n">mutation_size</span>
            <span class="n">arrow_path</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)]</span>

            <span class="c1"># path for head</span>
            <span class="n">in_f</span> <span class="o">=</span> <span class="n">inside_circle</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">head_length</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">path_out</span><span class="p">,</span> <span class="n">path_in</span> <span class="o">=</span> <span class="n">split_bezier_intersecting_with_closedpath</span><span class="p">(</span>
                    <span class="n">arrow_path</span><span class="p">,</span> <span class="n">in_f</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">NonIntersectingPathException</span><span class="p">:</span>
                <span class="c1"># if this happens, make a straight line of the head_length</span>
                <span class="c1"># long.</span>
                <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">_point_along_a_line</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">head_length</span><span class="p">)</span>
                <span class="n">x1n</span><span class="p">,</span> <span class="n">y1n</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">x0</span> <span class="o">+</span> <span class="n">x2</span><span class="p">),</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">y0</span> <span class="o">+</span> <span class="n">y2</span><span class="p">)</span>
                <span class="n">arrow_path</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span> <span class="p">(</span><span class="n">x1n</span><span class="p">,</span> <span class="n">y1n</span><span class="p">),</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)]</span>
                <span class="n">path_head</span> <span class="o">=</span> <span class="n">arrow_path</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">path_head</span> <span class="o">=</span> <span class="n">path_in</span>

            <span class="c1"># path for head</span>
            <span class="n">in_f</span> <span class="o">=</span> <span class="n">inside_circle</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">head_length</span> <span class="o">*</span> <span class="mf">.8</span><span class="p">)</span>
            <span class="n">path_out</span><span class="p">,</span> <span class="n">path_in</span> <span class="o">=</span> <span class="n">split_bezier_intersecting_with_closedpath</span><span class="p">(</span>
                <span class="n">arrow_path</span><span class="p">,</span> <span class="n">in_f</span><span class="p">)</span>
            <span class="n">path_tail</span> <span class="o">=</span> <span class="n">path_out</span>

            <span class="c1"># head</span>
            <span class="n">head_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">head_width</span> <span class="o">*</span> <span class="n">mutation_size</span>
            <span class="n">head_l</span><span class="p">,</span> <span class="n">head_r</span> <span class="o">=</span> <span class="n">make_wedged_bezier2</span><span class="p">(</span><span class="n">path_head</span><span class="p">,</span>
                                                 <span class="n">head_width</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">,</span>
                                                 <span class="n">wm</span><span class="o">=</span><span class="mf">.6</span><span class="p">)</span>

            <span class="c1"># tail</span>
            <span class="n">tail_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tail_width</span> <span class="o">*</span> <span class="n">mutation_size</span>
            <span class="n">tail_left</span><span class="p">,</span> <span class="n">tail_right</span> <span class="o">=</span> <span class="n">make_wedged_bezier2</span><span class="p">(</span><span class="n">path_tail</span><span class="p">,</span>
                                                        <span class="n">tail_width</span> <span class="o">*</span> <span class="mf">.5</span><span class="p">,</span>
                                                        <span class="n">w1</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">wm</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">w2</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

            <span class="c1"># path for head</span>
            <span class="n">in_f</span> <span class="o">=</span> <span class="n">inside_circle</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">tail_width</span> <span class="o">*</span> <span class="mf">.3</span><span class="p">)</span>
            <span class="n">path_in</span><span class="p">,</span> <span class="n">path_out</span> <span class="o">=</span> <span class="n">split_bezier_intersecting_with_closedpath</span><span class="p">(</span>
                <span class="n">arrow_path</span><span class="p">,</span> <span class="n">in_f</span><span class="p">)</span>
            <span class="n">tail_start</span> <span class="o">=</span> <span class="n">path_in</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

            <span class="n">head_right</span><span class="p">,</span> <span class="n">head_left</span> <span class="o">=</span> <span class="n">head_r</span><span class="p">,</span> <span class="n">head_l</span>
            <span class="n">patch_path</span> <span class="o">=</span> <span class="p">[(</span><span class="n">Path</span><span class="o">.</span><span class="n">MOVETO</span><span class="p">,</span> <span class="n">tail_start</span><span class="p">),</span>
                          <span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">LINETO</span><span class="p">,</span> <span class="n">tail_right</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                          <span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">CURVE3</span><span class="p">,</span> <span class="n">tail_right</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
                          <span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">CURVE3</span><span class="p">,</span> <span class="n">tail_right</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
                          <span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">LINETO</span><span class="p">,</span> <span class="n">head_right</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                          <span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">CURVE3</span><span class="p">,</span> <span class="n">head_right</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
                          <span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">CURVE3</span><span class="p">,</span> <span class="n">head_right</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
                          <span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">CURVE3</span><span class="p">,</span> <span class="n">head_left</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
                          <span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">CURVE3</span><span class="p">,</span> <span class="n">head_left</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                          <span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">LINETO</span><span class="p">,</span> <span class="n">tail_left</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
                          <span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">CURVE3</span><span class="p">,</span> <span class="n">tail_left</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
                          <span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">CURVE3</span><span class="p">,</span> <span class="n">tail_left</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                          <span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">LINETO</span><span class="p">,</span> <span class="n">tail_start</span><span class="p">),</span>
                          <span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">CLOSEPOLY</span><span class="p">,</span> <span class="n">tail_start</span><span class="p">),</span>
                          <span class="p">]</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">([</span><span class="n">p</span> <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">patch_path</span><span class="p">],</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">patch_path</span><span class="p">])</span>

            <span class="k">return</span> <span class="n">path</span><span class="p">,</span> <span class="kc">True</span>

    <span class="nd">@_register_style</span><span class="p">(</span><span class="n">_style_list</span><span class="p">)</span>
    <span class="k">class</span><span class="w"> </span><span class="nc">Wedge</span><span class="p">(</span><span class="n">_Base</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Wedge(?) shape. Only works with a quadratic Bézier curve.  The</span>
<span class="sd">        start point has a width of the *tail_width* and the end point has a</span>
<span class="sd">        width of 0. At the middle, the width is *shrink_factor*x*tail_width*.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tail_width</span><span class="o">=</span><span class="mf">.3</span><span class="p">,</span> <span class="n">shrink_factor</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            tail_width : float, default: 0.3</span>
<span class="sd">                Width of the tail.</span>

<span class="sd">            shrink_factor : float, default: 0.5</span>
<span class="sd">                Fraction of the arrow width at the middle point.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tail_width</span> <span class="o">=</span> <span class="n">tail_width</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">shrink_factor</span> <span class="o">=</span> <span class="n">shrink_factor</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">transmute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">mutation_size</span><span class="p">,</span> <span class="n">linewidth</span><span class="p">):</span>
            <span class="c1"># docstring inherited</span>
            <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ensure_quadratic_bezier</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

            <span class="n">arrow_path</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)]</span>
            <span class="n">b_plus</span><span class="p">,</span> <span class="n">b_minus</span> <span class="o">=</span> <span class="n">make_wedged_bezier2</span><span class="p">(</span>
                                    <span class="n">arrow_path</span><span class="p">,</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">tail_width</span> <span class="o">*</span> <span class="n">mutation_size</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">,</span>
                                    <span class="n">wm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">shrink_factor</span><span class="p">)</span>

            <span class="n">patch_path</span> <span class="o">=</span> <span class="p">[(</span><span class="n">Path</span><span class="o">.</span><span class="n">MOVETO</span><span class="p">,</span> <span class="n">b_plus</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                          <span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">CURVE3</span><span class="p">,</span> <span class="n">b_plus</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
                          <span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">CURVE3</span><span class="p">,</span> <span class="n">b_plus</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
                          <span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">LINETO</span><span class="p">,</span> <span class="n">b_minus</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
                          <span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">CURVE3</span><span class="p">,</span> <span class="n">b_minus</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
                          <span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">CURVE3</span><span class="p">,</span> <span class="n">b_minus</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                          <span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">CLOSEPOLY</span><span class="p">,</span> <span class="n">b_minus</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                          <span class="p">]</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">([</span><span class="n">p</span> <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">patch_path</span><span class="p">],</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">patch_path</span><span class="p">])</span>

            <span class="k">return</span> <span class="n">path</span><span class="p">,</span> <span class="kc">True</span>


<span class="k">class</span><span class="w"> </span><span class="nc">FancyBboxPatch</span><span class="p">(</span><span class="n">Patch</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A fancy box around a rectangle with lower left at *xy* = (*x*, *y*)</span>
<span class="sd">    with specified width and height.</span>

<span class="sd">    `.FancyBboxPatch` is similar to `.Rectangle`, but it draws a fancy box</span>
<span class="sd">    around the rectangle. The transformation of the rectangle box to the</span>
<span class="sd">    fancy box is delegated to the style classes defined in `.BoxStyle`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_edge_default</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s2">&quot;((</span><span class="si">%g</span><span class="s2">, </span><span class="si">%g</span><span class="s2">), width=</span><span class="si">%g</span><span class="s2">, height=</span><span class="si">%g</span><span class="s2">)&quot;</span>
        <span class="k">return</span> <span class="n">s</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_height</span><span class="p">)</span>

    <span class="nd">@_docstring</span><span class="o">.</span><span class="n">interpd</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xy</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round&quot;</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                 <span class="n">mutation_scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">mutation_aspect</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        xy : (float, float)</span>
<span class="sd">          The lower left corner of the box.</span>

<span class="sd">        width : float</span>
<span class="sd">            The width of the box.</span>

<span class="sd">        height : float</span>
<span class="sd">            The height of the box.</span>

<span class="sd">        boxstyle : str or `~matplotlib.patches.BoxStyle`</span>
<span class="sd">            The style of the fancy box. This can either be a `.BoxStyle`</span>
<span class="sd">            instance or a string of the style name and optionally comma</span>
<span class="sd">            separated attributes (e.g. &quot;Round, pad=0.2&quot;). This string is</span>
<span class="sd">            passed to `.BoxStyle` to construct a `.BoxStyle` object. See</span>
<span class="sd">            there for a full documentation.</span>

<span class="sd">            The following box styles are available:</span>

<span class="sd">            %(BoxStyle:table)s</span>

<span class="sd">        mutation_scale : float, default: 1</span>
<span class="sd">            Scaling factor applied to the attributes of the box style</span>
<span class="sd">            (e.g. pad or rounding_size).</span>

<span class="sd">        mutation_aspect : float, default: 1</span>
<span class="sd">            The height of the rectangle will be squeezed by this value before</span>
<span class="sd">            the mutation and the mutated box will be stretched by the inverse</span>
<span class="sd">            of it. For example, this allows different horizontal and vertical</span>
<span class="sd">            padding.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        **kwargs : `~matplotlib.patches.Patch` properties</span>

<span class="sd">        %(Patch:kwdoc)s</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">=</span> <span class="n">xy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_width</span> <span class="o">=</span> <span class="n">width</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_height</span> <span class="o">=</span> <span class="n">height</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_boxstyle</span><span class="p">(</span><span class="n">boxstyle</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mutation_scale</span> <span class="o">=</span> <span class="n">mutation_scale</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mutation_aspect</span> <span class="o">=</span> <span class="n">mutation_aspect</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="nd">@_docstring</span><span class="o">.</span><span class="n">interpd</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_boxstyle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">boxstyle</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the box style, possibly with further attributes.</span>

<span class="sd">        Attributes from the previous box style are not reused.</span>

<span class="sd">        Without argument (or with ``boxstyle=None``), the available box styles</span>
<span class="sd">        are returned as a human-readable string.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        boxstyle : str or `~matplotlib.patches.BoxStyle`</span>
<span class="sd">            The style of the box: either a `.BoxStyle` instance, or a string,</span>
<span class="sd">            which is the style name and optionally comma separated attributes</span>
<span class="sd">            (e.g. &quot;Round,pad=0.2&quot;). Such a string is used to construct a</span>
<span class="sd">            `.BoxStyle` object, as documented in that class.</span>

<span class="sd">            The following box styles are available:</span>

<span class="sd">            %(BoxStyle:table_and_accepts)s</span>

<span class="sd">        **kwargs</span>
<span class="sd">            Additional attributes for the box style. See the table above for</span>
<span class="sd">            supported parameters.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        ::</span>

<span class="sd">            set_boxstyle(&quot;Round,pad=0.2&quot;)</span>
<span class="sd">            set_boxstyle(&quot;round&quot;, pad=0.2)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">boxstyle</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">BoxStyle</span><span class="o">.</span><span class="n">pprint_styles</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bbox_transmuter</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">BoxStyle</span><span class="p">(</span><span class="n">boxstyle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">boxstyle</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">boxstyle</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_boxstyle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the boxstyle object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bbox_transmuter</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_mutation_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scale</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the mutation scale.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        scale : float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mutation_scale</span> <span class="o">=</span> <span class="n">scale</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_mutation_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the mutation scale.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mutation_scale</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_mutation_aspect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aspect</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the aspect ratio of the bbox mutation.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        aspect : float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mutation_aspect</span> <span class="o">=</span> <span class="n">aspect</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_mutation_aspect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the aspect ratio of the bbox mutation.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_mutation_aspect</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mutation_aspect</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                <span class="k">else</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># backcompat.</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the mutated path of the rectangle.&quot;&quot;&quot;</span>
        <span class="n">boxstyle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_boxstyle</span><span class="p">()</span>
        <span class="n">m_aspect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_mutation_aspect</span><span class="p">()</span>
        <span class="c1"># Call boxstyle with y, height squeezed by aspect_ratio.</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">boxstyle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">/</span> <span class="n">m_aspect</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_height</span> <span class="o">/</span> <span class="n">m_aspect</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">get_mutation_scale</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">vertices</span> <span class="o">*</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">m_aspect</span><span class="p">],</span> <span class="n">path</span><span class="o">.</span><span class="n">codes</span><span class="p">)</span>  <span class="c1"># Unsqueeze y.</span>

    <span class="c1"># Following methods are borrowed from the Rectangle class.</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the left coord of the rectangle.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_y</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the bottom coord of the rectangle.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_width</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the width of the rectangle.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_width</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_height</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the height of the rectangle.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_height</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the left coord of the rectangle.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">=</span> <span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the bottom coord of the rectangle.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        y : float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">=</span> <span class="n">y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_width</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">w</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the rectangle width.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        w : float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_width</span> <span class="o">=</span> <span class="n">w</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_height</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the rectangle height.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        h : float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_height</span> <span class="o">=</span> <span class="n">h</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the bounds of the rectangle.</span>

<span class="sd">        Call signatures::</span>

<span class="sd">            set_bounds(left, bottom, width, height)</span>
<span class="sd">            set_bounds((left, bottom, width, height))</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        left, bottom : float</span>
<span class="sd">            The coordinates of the bottom left corner of the rectangle.</span>
<span class="sd">        width, height : float</span>
<span class="sd">            The width/height of the rectangle.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">l</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">l</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">args</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_x</span> <span class="o">=</span> <span class="n">l</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_y</span> <span class="o">=</span> <span class="n">b</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_width</span> <span class="o">=</span> <span class="n">w</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_height</span> <span class="o">=</span> <span class="n">h</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_bbox</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the `.Bbox`.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Bbox</span><span class="o">.</span><span class="n">from_bounds</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_y</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">_width</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_height</span><span class="p">)</span>


<span class="k">class</span><span class="w"> </span><span class="nc">FancyArrowPatch</span><span class="p">(</span><span class="n">Patch</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A fancy arrow patch.</span>

<span class="sd">    It draws an arrow using the `ArrowStyle`. It is primarily used by the</span>
<span class="sd">    `~.axes.Axes.annotate` method.  For most purposes, use the annotate method for</span>
<span class="sd">    drawing arrows.</span>

<span class="sd">    The head and tail positions are fixed at the specified start and end points</span>
<span class="sd">    of the arrow, but the size and shape (in display coordinates) of the arrow</span>
<span class="sd">    does not change when the axis is moved or zoomed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_edge_default</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_posA_posB</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">),</span> <span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_posA_posB</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">((</span><span class="si">{</span><span class="n">x1</span><span class="si">:</span><span class="s2">g</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">y1</span><span class="si">:</span><span class="s2">g</span><span class="si">}</span><span class="s2">)-&gt;(</span><span class="si">{</span><span class="n">x2</span><span class="si">:</span><span class="s2">g</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">y2</span><span class="si">:</span><span class="s2">g</span><span class="si">}</span><span class="s2">))&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_path_original</span><span class="si">}</span><span class="s2">)&quot;</span>

    <span class="nd">@_docstring</span><span class="o">.</span><span class="n">interpd</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">posA</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">posB</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                 <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;simple&quot;</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3&quot;</span><span class="p">,</span>
                 <span class="n">patchA</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">patchB</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">shrinkA</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">shrinkB</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                 <span class="n">mutation_scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">mutation_aspect</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Defining the arrow position and path**</span>

<span class="sd">        There are two ways to define the arrow position and path:</span>

<span class="sd">        - **Start, end and connection**:</span>
<span class="sd">          The typical approach is to define the start and end points of the</span>
<span class="sd">          arrow using *posA* and *posB*. The curve between these two can</span>
<span class="sd">          further be configured using *connectionstyle*.</span>

<span class="sd">          If given, the arrow curve is clipped by *patchA* and *patchB*,</span>
<span class="sd">          allowing it to start/end at the border of these patches.</span>
<span class="sd">          Additionally, the arrow curve can be shortened by *shrinkA* and *shrinkB*</span>
<span class="sd">          to create a margin between start/end (after possible clipping) and the</span>
<span class="sd">          drawn arrow.</span>

<span class="sd">        - **path**: Alternatively if *path* is provided, an arrow is drawn along</span>
<span class="sd">          this Path. In this case, *connectionstyle*, *patchA*, *patchB*,</span>
<span class="sd">          *shrinkA*, and *shrinkB* are ignored.</span>

<span class="sd">        **Styling**</span>

<span class="sd">        The *arrowstyle* defines the styling of the arrow head, tail and shaft.</span>
<span class="sd">        The resulting arrows can be styled further by setting the `.Patch`</span>
<span class="sd">        properties such as *linewidth*, *color*, *facecolor*, *edgecolor*</span>
<span class="sd">        etc. via keyword arguments.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        posA, posB : (float, float), optional</span>
<span class="sd">            (x, y) coordinates of start and end point of the arrow.</span>
<span class="sd">            The actually drawn start and end positions may be modified</span>
<span class="sd">            through *patchA*, *patchB*, *shrinkA*, and *shrinkB*.</span>

<span class="sd">            *posA*, *posB* are exclusive of *path*.</span>

<span class="sd">        path : `~matplotlib.path.Path`, optional</span>
<span class="sd">            If provided, an arrow is drawn along this path and *patchA*,</span>
<span class="sd">            *patchB*, *shrinkA*, and *shrinkB* are ignored.</span>

<span class="sd">            *path* is exclusive of *posA*, *posB*.</span>

<span class="sd">        arrowstyle : str or `.ArrowStyle`, default: &#39;simple&#39;</span>
<span class="sd">            The styling of arrow head, tail and shaft. This can be</span>

<span class="sd">            - `.ArrowStyle` or one of its subclasses</span>
<span class="sd">            - The shorthand string name (e.g. &quot;-&gt;&quot;) as given in the table below,</span>
<span class="sd">              optionally containing a comma-separated list of style parameters,</span>
<span class="sd">              e.g. &quot;-&gt;, head_length=10, head_width=5&quot;.</span>

<span class="sd">            The style parameters are scaled by *mutation_scale*.</span>

<span class="sd">            The following arrow styles are available. See also</span>
<span class="sd">            :doc:`/gallery/text_labels_and_annotations/fancyarrow_demo`.</span>

<span class="sd">            %(ArrowStyle:table)s</span>

<span class="sd">            Only the styles ``&lt;|-``, ``-|&gt;``, ``&lt;|-|&gt;`` ``simple``, ``fancy``</span>
<span class="sd">            and ``wedge`` contain closed paths and can be filled.</span>

<span class="sd">        connectionstyle : str or `.ConnectionStyle` or None, optional, \</span>
<span class="sd">default: &#39;arc3&#39;</span>
<span class="sd">            `.ConnectionStyle` with which *posA* and *posB* are connected.</span>
<span class="sd">            This can be</span>

<span class="sd">            - `.ConnectionStyle` or one of its subclasses</span>
<span class="sd">            - The shorthand string name as given in the table below, e.g. &quot;arc3&quot;.</span>

<span class="sd">            %(ConnectionStyle:table)s</span>

<span class="sd">            Ignored if *path* is provided.</span>

<span class="sd">        patchA, patchB : `~matplotlib.patches.Patch`, default: None</span>
<span class="sd">            Optional Patches at *posA* and *posB*, respectively. If given,</span>
<span class="sd">            the arrow path is clipped by these patches such that head and tail</span>
<span class="sd">            are at the border of the patches.</span>

<span class="sd">            Ignored if *path* is provided.</span>

<span class="sd">        shrinkA, shrinkB : float, default: 2</span>
<span class="sd">            Shorten the arrow path at *posA* and *posB* by this amount in points.</span>
<span class="sd">            This allows to add a margin between the intended start/end points and</span>
<span class="sd">            the arrow.</span>

<span class="sd">            Ignored if *path* is provided.</span>

<span class="sd">        mutation_scale : float, default: 1</span>
<span class="sd">            Value with which attributes of *arrowstyle* (e.g., *head_length*)</span>
<span class="sd">            will be scaled.</span>

<span class="sd">        mutation_aspect : None or float, default: None</span>
<span class="sd">            The height of the rectangle will be squeezed by this value before</span>
<span class="sd">            the mutation and the mutated box will be stretched by the inverse</span>
<span class="sd">            of it.</span>

<span class="sd">        Other Parameters</span>
<span class="sd">        ----------------</span>
<span class="sd">        **kwargs : `~matplotlib.patches.Patch` properties, optional</span>
<span class="sd">            Here is a list of available `.Patch` properties:</span>

<span class="sd">        %(Patch:kwdoc)s</span>

<span class="sd">            In contrast to other patches, the default ``capstyle`` and</span>
<span class="sd">            ``joinstyle`` for `FancyArrowPatch` are set to ``&quot;round&quot;``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Traditionally, the cap- and joinstyle for FancyArrowPatch are round</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;joinstyle&quot;</span><span class="p">,</span> <span class="n">JoinStyle</span><span class="o">.</span><span class="n">round</span><span class="p">)</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;capstyle&quot;</span><span class="p">,</span> <span class="n">CapStyle</span><span class="o">.</span><span class="n">round</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">posA</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">posB</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_posA_posB</span> <span class="o">=</span> <span class="p">[</span><span class="n">posA</span><span class="p">,</span> <span class="n">posB</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">connectionstyle</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">connectionstyle</span> <span class="o">=</span> <span class="s2">&quot;arc3&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_connectionstyle</span><span class="p">(</span><span class="n">connectionstyle</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">posA</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">posB</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_posA_posB</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Either posA and posB, or path need to provided&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">patchA</span> <span class="o">=</span> <span class="n">patchA</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">patchB</span> <span class="o">=</span> <span class="n">patchB</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shrinkA</span> <span class="o">=</span> <span class="n">shrinkA</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shrinkB</span> <span class="o">=</span> <span class="n">shrinkB</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_path_original</span> <span class="o">=</span> <span class="n">path</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_arrowstyle</span><span class="p">(</span><span class="n">arrowstyle</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_mutation_scale</span> <span class="o">=</span> <span class="n">mutation_scale</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mutation_aspect</span> <span class="o">=</span> <span class="n">mutation_aspect</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_dpi_cor</span> <span class="o">=</span> <span class="mf">1.0</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_positions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">posA</span><span class="p">,</span> <span class="n">posB</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the start and end positions of the connecting path.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        posA, posB : None, tuple</span>
<span class="sd">            (x, y) coordinates of arrow tail and arrow head respectively. If</span>
<span class="sd">            `None` use current value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">posA</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_posA_posB</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">posA</span>
        <span class="k">if</span> <span class="n">posB</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_posA_posB</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">posB</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_patchA</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">patchA</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the tail patch.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        patchA : `.patches.Patch`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">patchA</span> <span class="o">=</span> <span class="n">patchA</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_patchB</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">patchB</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the head patch.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        patchB : `.patches.Patch`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">patchB</span> <span class="o">=</span> <span class="n">patchB</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="nd">@_docstring</span><span class="o">.</span><span class="n">interpd</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_connectionstyle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the connection style, possibly with further attributes.</span>

<span class="sd">        Attributes from the previous connection style are not reused.</span>

<span class="sd">        Without argument (or with ``connectionstyle=None``), the available box</span>
<span class="sd">        styles are returned as a human-readable string.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        connectionstyle : str or `~matplotlib.patches.ConnectionStyle`</span>
<span class="sd">            The style of the connection: either a `.ConnectionStyle` instance,</span>
<span class="sd">            or a string, which is the style name and optionally comma separated</span>
<span class="sd">            attributes (e.g. &quot;Arc,armA=30,rad=10&quot;). Such a string is used to</span>
<span class="sd">            construct a `.ConnectionStyle` object, as documented in that class.</span>

<span class="sd">            The following connection styles are available:</span>

<span class="sd">            %(ConnectionStyle:table_and_accepts)s</span>

<span class="sd">        **kwargs</span>
<span class="sd">            Additional attributes for the connection style. See the table above</span>
<span class="sd">            for supported parameters.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        ::</span>

<span class="sd">            set_connectionstyle(&quot;Arc,armA=30,rad=10&quot;)</span>
<span class="sd">            set_connectionstyle(&quot;arc&quot;, armA=30, rad=10)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">connectionstyle</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ConnectionStyle</span><span class="o">.</span><span class="n">pprint_styles</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_connector</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">ConnectionStyle</span><span class="p">(</span><span class="n">connectionstyle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">connectionstyle</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">connectionstyle</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_connectionstyle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the `ConnectionStyle` used.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_connector</span>

    <span class="nd">@_docstring</span><span class="o">.</span><span class="n">interpd</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_arrowstyle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arrowstyle</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the arrow style, possibly with further attributes.</span>

<span class="sd">        Attributes from the previous arrow style are not reused.</span>

<span class="sd">        Without argument (or with ``arrowstyle=None``), the available box</span>
<span class="sd">        styles are returned as a human-readable string.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        arrowstyle : str or `~matplotlib.patches.ArrowStyle`</span>
<span class="sd">            The style of the arrow: either a `.ArrowStyle` instance, or a</span>
<span class="sd">            string, which is the style name and optionally comma separated</span>
<span class="sd">            attributes (e.g. &quot;Fancy,head_length=0.2&quot;). Such a string is used to</span>
<span class="sd">            construct a `.ArrowStyle` object, as documented in that class.</span>

<span class="sd">            The following arrow styles are available:</span>

<span class="sd">            %(ArrowStyle:table_and_accepts)s</span>

<span class="sd">        **kwargs</span>
<span class="sd">            Additional attributes for the arrow style. See the table above for</span>
<span class="sd">            supported parameters.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        ::</span>

<span class="sd">            set_arrowstyle(&quot;Fancy,head_length=0.2&quot;)</span>
<span class="sd">            set_arrowstyle(&quot;fancy&quot;, head_length=0.2)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">arrowstyle</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ArrowStyle</span><span class="o">.</span><span class="n">pprint_styles</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_arrow_transmuter</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">ArrowStyle</span><span class="p">(</span><span class="n">arrowstyle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arrowstyle</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">arrowstyle</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_arrowstyle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the arrowstyle object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arrow_transmuter</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_mutation_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scale</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the mutation scale.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        scale : float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mutation_scale</span> <span class="o">=</span> <span class="n">scale</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_mutation_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the mutation scale.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        scalar</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mutation_scale</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_mutation_aspect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aspect</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the aspect ratio of the bbox mutation.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        aspect : float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mutation_aspect</span> <span class="o">=</span> <span class="n">aspect</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_mutation_aspect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the aspect ratio of the bbox mutation.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_mutation_aspect</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mutation_aspect</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                <span class="k">else</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># backcompat.</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the path of the arrow in the data coordinates.&quot;&quot;&quot;</span>
        <span class="c1"># The path is generated in display coordinates, then converted back to</span>
        <span class="c1"># data coordinates.</span>
        <span class="n">_path</span><span class="p">,</span> <span class="n">fillable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_path_in_displaycoord</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">iterable</span><span class="p">(</span><span class="n">fillable</span><span class="p">):</span>
            <span class="n">_path</span> <span class="o">=</span> <span class="n">Path</span><span class="o">.</span><span class="n">make_compound_path</span><span class="p">(</span><span class="o">*</span><span class="n">_path</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_transform</span><span class="p">()</span><span class="o">.</span><span class="n">inverted</span><span class="p">()</span><span class="o">.</span><span class="n">transform_path</span><span class="p">(</span><span class="n">_path</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_path_in_displaycoord</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the mutated path of the arrow in display coordinates.&quot;&quot;&quot;</span>
        <span class="n">dpi_cor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dpi_cor</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_posA_posB</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">posA</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_xy_units</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_posA_posB</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">posB</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_xy_units</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_posA_posB</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="p">(</span><span class="n">posA</span><span class="p">,</span> <span class="n">posB</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_transform</span><span class="p">()</span><span class="o">.</span><span class="n">transform</span><span class="p">((</span><span class="n">posA</span><span class="p">,</span> <span class="n">posB</span><span class="p">))</span>
            <span class="n">_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_connectionstyle</span><span class="p">()(</span><span class="n">posA</span><span class="p">,</span> <span class="n">posB</span><span class="p">,</span>
                                               <span class="n">patchA</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">patchA</span><span class="p">,</span>
                                               <span class="n">patchB</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">patchB</span><span class="p">,</span>
                                               <span class="n">shrinkA</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">shrinkA</span> <span class="o">*</span> <span class="n">dpi_cor</span><span class="p">,</span>
                                               <span class="n">shrinkB</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">shrinkB</span> <span class="o">*</span> <span class="n">dpi_cor</span>
                                               <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_transform</span><span class="p">()</span><span class="o">.</span><span class="n">transform_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_path_original</span><span class="p">)</span>

        <span class="n">_path</span><span class="p">,</span> <span class="n">fillable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_arrowstyle</span><span class="p">()(</span>
            <span class="n">_path</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_mutation_scale</span><span class="p">()</span> <span class="o">*</span> <span class="n">dpi_cor</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_linewidth</span><span class="p">()</span> <span class="o">*</span> <span class="n">dpi_cor</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_mutation_aspect</span><span class="p">())</span>

        <span class="k">return</span> <span class="n">_path</span><span class="p">,</span> <span class="n">fillable</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_visible</span><span class="p">():</span>
            <span class="k">return</span>

        <span class="c1"># FIXME: dpi_cor is for the dpi-dependency of the linewidth.  There</span>
        <span class="c1"># could be room for improvement.  Maybe _get_path_in_displaycoord could</span>
        <span class="c1"># take a renderer argument, but get_path should be adapted too.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dpi_cor</span> <span class="o">=</span> <span class="n">renderer</span><span class="o">.</span><span class="n">points_to_pixels</span><span class="p">(</span><span class="mf">1.</span><span class="p">)</span>
        <span class="n">path</span><span class="p">,</span> <span class="n">fillable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_path_in_displaycoord</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">iterable</span><span class="p">(</span><span class="n">fillable</span><span class="p">):</span>
            <span class="n">path</span> <span class="o">=</span> <span class="p">[</span><span class="n">path</span><span class="p">]</span>
            <span class="n">fillable</span> <span class="o">=</span> <span class="p">[</span><span class="n">fillable</span><span class="p">]</span>

        <span class="n">affine</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">IdentityTransform</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_draw_paths_with_artist_properties</span><span class="p">(</span>
            <span class="n">renderer</span><span class="p">,</span>
            <span class="p">[(</span><span class="n">p</span><span class="p">,</span> <span class="n">affine</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_facecolor</span> <span class="k">if</span> <span class="n">f</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_facecolor</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
             <span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">fillable</span><span class="p">)])</span>


<span class="k">class</span><span class="w"> </span><span class="nc">ConnectionPatch</span><span class="p">(</span><span class="n">FancyArrowPatch</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A patch that connects two points (possibly in different Axes).&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;ConnectionPatch((</span><span class="si">%g</span><span class="s2">, </span><span class="si">%g</span><span class="s2">), (</span><span class="si">%g</span><span class="s2">, </span><span class="si">%g</span><span class="s2">))&quot;</span> <span class="o">%</span> \
               <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xy1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">xy1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">xy2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">xy2</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="nd">@_docstring</span><span class="o">.</span><span class="n">interpd</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xyA</span><span class="p">,</span> <span class="n">xyB</span><span class="p">,</span> <span class="n">coordsA</span><span class="p">,</span> <span class="n">coordsB</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                 <span class="n">axesA</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axesB</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span>
                 <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3&quot;</span><span class="p">,</span>
                 <span class="n">patchA</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">patchB</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">shrinkA</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span>
                 <span class="n">shrinkB</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span>
                 <span class="n">mutation_scale</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span>
                 <span class="n">mutation_aspect</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">clip_on</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Connect point *xyA* in *coordsA* with point *xyB* in *coordsB*.</span>

<span class="sd">        Valid keys are</span>

<span class="sd">        ===============  ======================================================</span>
<span class="sd">        Key              Description</span>
<span class="sd">        ===============  ======================================================</span>
<span class="sd">        arrowstyle       the arrow style</span>
<span class="sd">        connectionstyle  the connection style</span>
<span class="sd">        relpos           default is (0.5, 0.5)</span>
<span class="sd">        patchA           default is bounding box of the text</span>
<span class="sd">        patchB           default is None</span>
<span class="sd">        shrinkA          default is 2 points</span>
<span class="sd">        shrinkB          default is 2 points</span>
<span class="sd">        mutation_scale   default is text size (in points)</span>
<span class="sd">        mutation_aspect  default is 1.</span>
<span class="sd">        ?                any key for `matplotlib.patches.PathPatch`</span>
<span class="sd">        ===============  ======================================================</span>

<span class="sd">        *coordsA* and *coordsB* are strings that indicate the</span>
<span class="sd">        coordinates of *xyA* and *xyB*.</span>

<span class="sd">        ==================== ==================================================</span>
<span class="sd">        Property             Description</span>
<span class="sd">        ==================== ==================================================</span>
<span class="sd">        &#39;figure points&#39;      points from the lower left corner of the figure</span>
<span class="sd">        &#39;figure pixels&#39;      pixels from the lower left corner of the figure</span>
<span class="sd">        &#39;figure fraction&#39;    0, 0 is lower left of figure and 1, 1 is upper</span>
<span class="sd">                             right</span>
<span class="sd">        &#39;subfigure points&#39;   points from the lower left corner of the subfigure</span>
<span class="sd">        &#39;subfigure pixels&#39;   pixels from the lower left corner of the subfigure</span>
<span class="sd">        &#39;subfigure fraction&#39; fraction of the subfigure, 0, 0 is lower left.</span>
<span class="sd">        &#39;axes points&#39;        points from lower left corner of the Axes</span>
<span class="sd">        &#39;axes pixels&#39;        pixels from lower left corner of the Axes</span>
<span class="sd">        &#39;axes fraction&#39;      0, 0 is lower left of Axes and 1, 1 is upper right</span>
<span class="sd">        &#39;data&#39;               use the coordinate system of the object being</span>
<span class="sd">                             annotated (default)</span>
<span class="sd">        &#39;offset points&#39;      offset (in points) from the *xy* value</span>
<span class="sd">        &#39;polar&#39;              you can specify *theta*, *r* for the annotation,</span>
<span class="sd">                             even in cartesian plots.  Note that if you are</span>
<span class="sd">                             using a polar Axes, you do not need to specify</span>
<span class="sd">                             polar for the coordinate system since that is the</span>
<span class="sd">                             native &quot;data&quot; coordinate system.</span>
<span class="sd">        ==================== ==================================================</span>

<span class="sd">        Alternatively they can be set to any valid</span>
<span class="sd">        `~matplotlib.transforms.Transform`.</span>

<span class="sd">        Note that &#39;subfigure pixels&#39; and &#39;figure pixels&#39; are the same</span>
<span class="sd">        for the parent figure, so users who want code that is usable in</span>
<span class="sd">        a subfigure can use &#39;subfigure pixels&#39;.</span>

<span class="sd">        .. note::</span>

<span class="sd">           Using `ConnectionPatch` across two `~.axes.Axes` instances</span>
<span class="sd">           is not directly compatible with :ref:`constrained layout</span>
<span class="sd">           &lt;constrainedlayout_guide&gt;`. Add the artist</span>
<span class="sd">           directly to the `.Figure` instead of adding it to a specific Axes,</span>
<span class="sd">           or exclude it from the layout using ``con.set_in_layout(False)``.</span>

<span class="sd">           .. code-block:: default</span>

<span class="sd">              fig, ax = plt.subplots(1, 2, constrained_layout=True)</span>
<span class="sd">              con = ConnectionPatch(..., axesA=ax[0], axesB=ax[1])</span>
<span class="sd">              fig.add_artist(con)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">coordsB</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">coordsB</span> <span class="o">=</span> <span class="n">coordsA</span>
        <span class="c1"># we&#39;ll draw ourself after the artist we annotate by default</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xy1</span> <span class="o">=</span> <span class="n">xyA</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xy2</span> <span class="o">=</span> <span class="n">xyB</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coords1</span> <span class="o">=</span> <span class="n">coordsA</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coords2</span> <span class="o">=</span> <span class="n">coordsB</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">axesA</span> <span class="o">=</span> <span class="n">axesA</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axesB</span> <span class="o">=</span> <span class="n">axesB</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">posA</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">posB</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                         <span class="n">arrowstyle</span><span class="o">=</span><span class="n">arrowstyle</span><span class="p">,</span>
                         <span class="n">connectionstyle</span><span class="o">=</span><span class="n">connectionstyle</span><span class="p">,</span>
                         <span class="n">patchA</span><span class="o">=</span><span class="n">patchA</span><span class="p">,</span> <span class="n">patchB</span><span class="o">=</span><span class="n">patchB</span><span class="p">,</span>
                         <span class="n">shrinkA</span><span class="o">=</span><span class="n">shrinkA</span><span class="p">,</span> <span class="n">shrinkB</span><span class="o">=</span><span class="n">shrinkB</span><span class="p">,</span>
                         <span class="n">mutation_scale</span><span class="o">=</span><span class="n">mutation_scale</span><span class="p">,</span>
                         <span class="n">mutation_aspect</span><span class="o">=</span><span class="n">mutation_aspect</span><span class="p">,</span>
                         <span class="n">clip_on</span><span class="o">=</span><span class="n">clip_on</span><span class="p">,</span>
                         <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="c1"># if True, draw annotation only if self.xy is inside the Axes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_annotation_clip</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_xy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xy</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate the pixel position of given point.&quot;&quot;&quot;</span>
        <span class="n">s0</span> <span class="o">=</span> <span class="n">s</span>  <span class="c1"># For the error message, if needed.</span>
        <span class="k">if</span> <span class="n">axes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">axes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span>

        <span class="c1"># preserve mixed type input (such as str, int)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="n">fig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_figure</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">s</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;figure points&quot;</span><span class="p">,</span> <span class="s2">&quot;axes points&quot;</span><span class="p">]:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">fig</span><span class="o">.</span><span class="n">dpi</span> <span class="o">/</span> <span class="mi">72</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">*</span> <span class="n">fig</span><span class="o">.</span><span class="n">dpi</span> <span class="o">/</span> <span class="mi">72</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;points&quot;</span><span class="p">,</span> <span class="s2">&quot;pixels&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">s</span> <span class="o">==</span> <span class="s2">&quot;figure fraction&quot;</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">transFigure</span>
        <span class="k">elif</span> <span class="n">s</span> <span class="o">==</span> <span class="s2">&quot;subfigure fraction&quot;</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">transSubfigure</span>
        <span class="k">elif</span> <span class="n">s</span> <span class="o">==</span> <span class="s2">&quot;axes fraction&quot;</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">transAxes</span>

        <span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span>
            <span class="n">trans</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">transData</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">cbook</span><span class="o">.</span><span class="n">_to_unmasked_float_array</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">convert_units</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">cbook</span><span class="o">.</span><span class="n">_to_unmasked_float_array</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">convert_units</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">trans</span><span class="o">.</span><span class="n">transform</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">s</span> <span class="o">==</span> <span class="s1">&#39;offset points&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">xycoords</span> <span class="o">==</span> <span class="s1">&#39;offset points&#39;</span><span class="p">:</span>  <span class="c1"># prevent recursion</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_xy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xy</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_get_xy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xy</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xycoords</span><span class="p">)</span>  <span class="c1"># converted data point</span>
                <span class="o">+</span> <span class="n">xy</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_figure</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">dpi</span> <span class="o">/</span> <span class="mi">72</span><span class="p">)</span>  <span class="c1"># converted offset</span>
        <span class="k">elif</span> <span class="n">s</span> <span class="o">==</span> <span class="s1">&#39;polar&#39;</span><span class="p">:</span>
            <span class="n">theta</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
            <span class="n">trans</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">transData</span>
            <span class="k">return</span> <span class="n">trans</span><span class="o">.</span><span class="n">transform</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">s</span> <span class="o">==</span> <span class="s1">&#39;figure pixels&#39;</span><span class="p">:</span>
            <span class="c1"># pixels from the lower left corner of the figure</span>
            <span class="n">bb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_figure</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">figbbox</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">bb</span><span class="o">.</span><span class="n">x0</span> <span class="o">+</span> <span class="n">x</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">bb</span><span class="o">.</span><span class="n">x1</span> <span class="o">+</span> <span class="n">x</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">bb</span><span class="o">.</span><span class="n">y0</span> <span class="o">+</span> <span class="n">y</span> <span class="k">if</span> <span class="n">y</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">bb</span><span class="o">.</span><span class="n">y1</span> <span class="o">+</span> <span class="n">y</span>
            <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
        <span class="k">elif</span> <span class="n">s</span> <span class="o">==</span> <span class="s1">&#39;subfigure pixels&#39;</span><span class="p">:</span>
            <span class="c1"># pixels from the lower left corner of the figure</span>
            <span class="n">bb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_figure</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">bbox</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">bb</span><span class="o">.</span><span class="n">x0</span> <span class="o">+</span> <span class="n">x</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">bb</span><span class="o">.</span><span class="n">x1</span> <span class="o">+</span> <span class="n">x</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">bb</span><span class="o">.</span><span class="n">y0</span> <span class="o">+</span> <span class="n">y</span> <span class="k">if</span> <span class="n">y</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">bb</span><span class="o">.</span><span class="n">y1</span> <span class="o">+</span> <span class="n">y</span>
            <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
        <span class="k">elif</span> <span class="n">s</span> <span class="o">==</span> <span class="s1">&#39;axes pixels&#39;</span><span class="p">:</span>
            <span class="c1"># pixels from the lower left corner of the Axes</span>
            <span class="n">bb</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">bbox</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">bb</span><span class="o">.</span><span class="n">x0</span> <span class="o">+</span> <span class="n">x</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">bb</span><span class="o">.</span><span class="n">x1</span> <span class="o">+</span> <span class="n">x</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">bb</span><span class="o">.</span><span class="n">y0</span> <span class="o">+</span> <span class="n">y</span> <span class="k">if</span> <span class="n">y</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">bb</span><span class="o">.</span><span class="n">y1</span> <span class="o">+</span> <span class="n">y</span>
            <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Transform</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">s</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">xy</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">s0</span><span class="si">}</span><span class="s2"> is not a valid coordinate transformation&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_annotation_clip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the annotation&#39;s clipping behavior.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        b : bool or None</span>
<span class="sd">            - True: The annotation will be clipped when ``self.xy`` is</span>
<span class="sd">              outside the Axes.</span>
<span class="sd">            - False: The annotation will always be drawn.</span>
<span class="sd">            - None: The annotation will be clipped when ``self.xy`` is</span>
<span class="sd">              outside the Axes and ``self.xycoords == &quot;data&quot;``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_annotation_clip</span> <span class="o">=</span> <span class="n">b</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_annotation_clip</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the clipping behavior.</span>

<span class="sd">        See `.set_annotation_clip` for the meaning of the return value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_annotation_clip</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_path_in_displaycoord</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the mutated path of the arrow in display coordinates.&quot;&quot;&quot;</span>
        <span class="n">dpi_cor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dpi_cor</span>
        <span class="n">posA</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_xy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xy1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">axesA</span><span class="p">)</span>
        <span class="n">posB</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_xy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xy2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">axesB</span><span class="p">)</span>
        <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_connectionstyle</span><span class="p">()(</span>
            <span class="n">posA</span><span class="p">,</span> <span class="n">posB</span><span class="p">,</span>
            <span class="n">patchA</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">patchA</span><span class="p">,</span> <span class="n">patchB</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">patchB</span><span class="p">,</span>
            <span class="n">shrinkA</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">shrinkA</span> <span class="o">*</span> <span class="n">dpi_cor</span><span class="p">,</span> <span class="n">shrinkB</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">shrinkB</span> <span class="o">*</span> <span class="n">dpi_cor</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">path</span><span class="p">,</span> <span class="n">fillable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_arrowstyle</span><span class="p">()(</span>
            <span class="n">path</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_mutation_scale</span><span class="p">()</span> <span class="o">*</span> <span class="n">dpi_cor</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_linewidth</span><span class="p">()</span> <span class="o">*</span> <span class="n">dpi_cor</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_mutation_aspect</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">path</span><span class="p">,</span> <span class="n">fillable</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_check_xy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check whether the annotation needs to be drawn.&quot;&quot;&quot;</span>

        <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_annotation_clip</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">b</span> <span class="ow">or</span> <span class="p">(</span><span class="n">b</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords1</span> <span class="o">==</span> <span class="s2">&quot;data&quot;</span><span class="p">):</span>
            <span class="n">xy_pixel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_xy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xy1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">axesA</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axesA</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">axes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">axes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axesA</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">axes</span><span class="o">.</span><span class="n">contains_point</span><span class="p">(</span><span class="n">xy_pixel</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">b</span> <span class="ow">or</span> <span class="p">(</span><span class="n">b</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords2</span> <span class="o">==</span> <span class="s2">&quot;data&quot;</span><span class="p">):</span>
            <span class="n">xy_pixel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_xy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xy2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">axesB</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axesB</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">axes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">axes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axesB</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">axes</span><span class="o">.</span><span class="n">contains_point</span><span class="p">(</span><span class="n">xy_pixel</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_visible</span><span class="p">()</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_xy</span><span class="p">(</span><span class="n">renderer</span><span class="p">):</span>
            <span class="k">return</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
</pre></div>
        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2019-2025, Elias Fernández
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=a7611213"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=46bd48cc"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    </body>
</html>